var app=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}([function(t,e,n){"use strict";function r(t){return"[object Array]"===A.call(t)}function i(t){return"[object ArrayBuffer]"===A.call(t)}function o(t){return"undefined"!=typeof FormData&&t instanceof FormData}function a(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function s(t){return"string"==typeof t}function u(t){return"number"==typeof t}function c(t){return void 0===t}function h(t){return null!==t&&"object"===(void 0===t?"undefined":T(t))}function l(t){return"[object Date]"===A.call(t)}function f(t){return"[object File]"===A.call(t)}function d(t){return"[object Blob]"===A.call(t)}function p(t){return"[object Function]"===A.call(t)}function m(t){return h(t)&&p(t.pipe)}function y(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function g(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function b(t,e){if(null!==t&&void 0!==t)if("object"!==(void 0===t?"undefined":T(t))&&(t=[t]),r(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}function w(){function t(t,n){"object"===T(e[n])&&"object"===(void 0===t?"undefined":T(t))?e[n]=w(e[n],t):e[n]=t}for(var e={},n=0,r=arguments.length;n<r;n++)b(arguments[n],t);return e}function E(t,e,n){return b(e,function(e,r){t[r]=n&&"function"==typeof e?I(e,n):e}),t}var T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I=n(6),S=n(21),A=Object.prototype.toString;t.exports={isArray:r,isArrayBuffer:i,isBuffer:S,isFormData:o,isArrayBufferView:a,isString:s,isNumber:u,isObject:h,isUndefined:c,isDate:l,isFile:f,isBlob:d,isFunction:p,isStream:m,isURLSearchParams:y,isStandardBrowserEnv:v,forEach:b,merge:w,extend:E,trim:g}},function(t,e,n){"use strict";var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":i(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";(function(e){function r(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var i=n(0),o=n(23),a={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=n(7):void 0!==e&&(t=n(7)),t}(),transformRequest:[function(t,e){return o(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(r(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(r(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(t){s.headers[t]={}}),i.forEach(["post","put","patch"],function(t){s.headers[t]=i.merge(a)}),t.exports=s}).call(e,n(3))},function(t,e,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function a(t){if(f===clearTimeout)return clearTimeout(t);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function s(){y&&p&&(y=!1,p.length?m=p.concat(m):g=-1,m.length&&u())}function u(){if(!y){var t=o(s);y=!0;for(var e=m.length;e;){for(p=m,m=[];++g<e;)p&&p[g].run();g=-1,e=m.length}p=null,y=!1,a(t)}}function c(t,e){this.fun=t,this.array=e}function h(){}var l,f,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(t){f=i}}();var p,m=[],y=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new c(t,e)),1!==m.length||y||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.prependListener=h,d.prependOnceListener=h,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e,n){"use strict";function r(){function t(t){d(m[t],"delete"),delete m[t]}function e(t){return t=t||u,s(m,t)||i("no-app",{name:t}),m[t]}function n(t,e){if(void 0===e&&(e={}),"object"!==(void 0===e?"undefined":o(e))||null===e){e={name:e}}var n=e;void 0===n.name&&(n.name=u);var r=n.name;"string"==typeof r&&r||i("bad-app-name",{name:r+""}),s(m,r)&&i("duplicate-app",{name:r});var a=new h(t,n,v);return m[r]=a,d(a,"create"),a}function c(){return Object.keys(m).map(function(t){return m[t]})}function l(t,n,r,o,s){y[t]&&i("duplicate-service",{name:t}),y[t]=n,o&&(g[t]=o,c().forEach(function(t){o("create",t)}));var u=function(n){return void 0===n&&(n=e()),"function"!=typeof n[t]&&i("invalid-app-argument",{name:t}),n[t]()};return void 0!==r&&a.deepExtend(u,r),v[t]=u,h.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,s?e:[])},u}function f(t){a.deepExtend(v,t)}function d(t,e){Object.keys(y).forEach(function(n){var r=p(t,n);null!==r&&g[r]&&g[r](e,t)})}function p(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}var m={},y={},g={},v={__esModule:!0,initializeApp:n,app:e,apps:null,Promise:Promise,SDK_VERSION:"5.0.4",INTERNAL:{registerService:l,createFirebaseNamespace:r,extendNamespace:f,createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,removeApp:t,factories:y,useAsService:p,Promise:Promise,deepExtend:a.deepExtend}};return a.patchProperty(v,"default",v),Object.defineProperty(v,"apps",{get:c}),a.patchProperty(e,"App",h),v}function i(t,e){throw f.create(t,e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var a=n(44),s=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u="[DEFAULT]",c=[],h=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){c.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){c=c.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed_(),this._automaticDataCollectionEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=u),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==u?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;a.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(c.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),c=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&i("app-deleted",{name:this.name_})},t}();h.prototype.name&&h.prototype.options||h.prototype.delete||console.log("dc");var l={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},f=new a.ErrorFactory("app","Firebase",l),d=r();e.firebase=d,e.default=d},function(t,e,n){"use strict";t.exports=n(20)},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){"use strict";var r=n(0),i=n(24),o=n(26),a=n(27),s=n(28),u=n(8),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(29);t.exports=function(t){return new Promise(function(e,h){var l=t.data,f=t.headers;r.isFormData(l)&&delete f["Content-Type"];var d=new XMLHttpRequest,p="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||s(t.url)||(d=new window.XDomainRequest,p="onload",m=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var y=t.auth.username||"",g=t.auth.password||"";f.Authorization="Basic "+c(y+":"+g)}if(d.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[p]=function(){if(d&&(4===d.readyState||m)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?a(d.getAllResponseHeaders()):null,r=t.responseType&&"text"!==t.responseType?d.response:d.responseText,o={data:r,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:n,config:t,request:d};i(e,h,o),d=null}},d.onerror=function(){h(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){h(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var v=n(30),b=(t.withCredentials||s(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;b&&(f[t.xsrfHeaderName]=b)}if("setRequestHeader"in d&&r.forEach(f,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete f[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),h(t),d=null)}),void 0===l&&(l=null),d.send(l)})}},function(t,e,n){"use strict";var r=n(25);t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e,n){"use strict";function r(t,e){function n(){this.constructor=t}T(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]]);return n}function o(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":E(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function a(t,e){return function(n,r){e(n,r,t)}}function s(t,e){if("object"===("undefined"==typeof Reflect?"undefined":E(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function c(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}function h(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function f(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}function p(t){return this instanceof p?(this.v=t,this):new p(t)}function m(t,e,n){function r(t){h[t]&&(c[t]=function(e){return new Promise(function(n,r){l.push([t,e,n,r])>1||i(t,e)})})}function i(t,e){try{o(h[t](e))}catch(t){u(l[0][3],t)}}function o(t){t.value instanceof p?Promise.resolve(t.value.v).then(a,s):u(l[0][2],t)}function a(t){i("next",t)}function s(t){i("throw",t)}function u(t,e){t(e),l.shift(),l.length&&i(l[0][0],l[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,h=n.apply(t,e||[]),l=[];return c={},r("next"),r("throw"),r("return"),c[Symbol.asyncIterator]=function(){return this},c}function y(t){function e(e,i){t[e]&&(n[e]=function(n){return(r=!r)?{value:p(t[e](n)),done:"return"===e}:i?i(n):n})}var n,r;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n}function g(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"==typeof l?l(t):t[Symbol.iterator]()}function v(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function b(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.__extends=r,e.__rest=i,e.__decorate=o,e.__param=a,e.__metadata=s,e.__awaiter=u,e.__generator=c,e.__exportStar=h,e.__values=l,e.__read=f,e.__spread=d,e.__await=p,e.__asyncGenerator=m,e.__asyncDelegator=y,e.__asyncValues=g,e.__makeTemplateObject=v,e.__importStar=b,e.__importDefault=w;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};e.__assign=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.coupon=e.user=void 0;var i=n(13),o=r(i),a=n(14),s=n(16),u=r(s),c=n(17),h=r(c),l=n(18),f=n(38),d=r(f);n(52),n(53),n(54),n(55),n(56);var p={pages:null,params:{},q:[],player:null,getParams:function(){for(var t={},e=window.location.search.substring(1),n=e.split("&"),r=0;r<n.length;r++){var i=n[r].split("=");if(void 0===t[i[0]])t[i[0]]=i[1];else if("string"==typeof t[i[0]]){var o=[t[i[0]],i[1]];t[i[0]]=o}else t[i[0]].push(i[1])}return t},initResult:function(t,e){"win"==t?(document.getElementById("resultTitle").innerHTML="おめでとうございます！",document.getElementById("resultDescription").innerHTML="サラダスムージーが当たりました。",d.default.isWanderer?(document.getElementById("couponLink").style.display="none",document.getElementById("resultInstruction").style.display="none;"):document.getElementById("resultInstruction").innerHTML="クーポンを受け取って、ファミリーマートで引き換えてください",e&&(document.getElementById("couponLoader").style.display="none",document.getElementById("couponLink").href=e,document.getElementById("couponLink").setAttribute("target","_blank"),document.getElementById("getCoupon").innerText="クーポンを受け取る")):(document.getElementById("resultTitle").innerHTML="残念！<br>ハズレです",document.getElementById("resultImage").style.display="none",document.getElementById("couponLink").style.display="none")},processResult:function(){var t=this,e=l.winningLogic.process(this.q,!d.default.isWanderer);console.log(e);var n=e.trackingResult,r=e.actualResult,i=e.group;e.flag;d.default.isWanderer?this.initResult(n):"win"==r?d.default.win(d.default.info.id,i,d.default.source).then(function(e){if(console.log(e),e.data.couponLink){t.initResult("win",e.data.couponLink);var n="綾鷹クーポンが当たりました！ "+e.data.couponLink;if(d.default.messageTwitter(n),d.default.info.id.indexOf("@")>-1){var r='<head><meta charset="utf-8"></head><div style="text-align:center;font-weight:600;color:#FF4244;font-size:28px;">おめでとうございます</div><br><br><div style="text-align:center;font-weight:600;">クーポンが当たりました！</div><a href="'+e.data.couponLink+'" target="_blank" style="text-decoration:none;"><button style="display:block;margin:20px auto;margin-bottom:40px;border-radius:5px;background-color:#E54C3C;border:none;color:white;width:200px;height:50px;font-weight:600;">クーポンを受取る</button></a>';d.default.sendEmail(d.default.info.id,"DentSu Coupon Link",r)}}else t.initResult("lose")}).catch(function(e){console.log(e),t.initResult("win")}):(d.default.lose(d.default.info.id,d.default.source).then(function(t){console.log(t)}).catch(function(t){console.log(t)}),this.initResult("lose"))},continue:function(){var t="{}";localStorage.getItem("localAnswers")&&(t=localStorage.getItem("localAnswers"));var e=JSON.parse(t),n=[],r=0;e&&e.hasOwnProperty(d.default.info.id)&&(n=e[d.default.info.id],r=n.length-1),n||(n=JSON.parse(d.default.info.Answers),r=d.default.info.noQuestionAnswered);for(var i=1;i<this.q.length;i++)n[i]&&this.q[i].setAnswer(n[i]);"win"==d.default.info.state?(this.initResult("win",d.default.info.couponLink),this.pages.toPage("resultPage")):"lose"==d.default.info.state?(this.initResult("lose"),this.pages.toPage("resultPage")):r>0?r<this.q.length-1?this.pages.toPage("page"+(r+1).toString()):this.pages.toPage("page"+(this.q.length-1).toString()):this.pages.toPage("termsPage")},events:function(){var t=this;document.getElementById("agreeCheck").onchange=function(){this.checked?document.getElementById("startSurvey").disabled=!1:document.getElementById("startSurvey").disabled=!0};var e=document.getElementById("regForm");e.onsubmit=function(n){var r=document.getElementById("formWorking");document.getElementById("doneSec"),document.getElementById("regSec");e.style.display="none",r.style.display="block",n.preventDefault();var i=document.getElementById("emailInput").value;d.default.register(i).then(function(e){if(console.log(e),r.style.display="none",1==e.data.status){t.formSections.toPage("doneSec");var n='<head><meta charset="utf-8"></head>ご登録ありがとうございました。下記にあるリンクをクリックしてください。その後キャンペーンへの参加をお願いします<br><br><a href="https://rmarepo.richmediaads.com/o2o/dentsu/demo/index.html?userId='+i+'" target="_blank">https://rmarepo.richmediaads.com/o2o/dentsu/demo/index.html?userId='+i+"</a>";d.default.sendEmail(i,"DentSu Survey Link",n)}else"user exist."==e.data.message&&(d.default.info=e.data.user,t.enableSaveAnswer(),t.continue(),h.default.closeAll())}).catch(function(t){console.log(t),e.style.display="block",r.style.display="none"})},document.getElementById("regTwitter").onclick=function(){var e=document.getElementById("regWorking"),n=document.getElementById("regButtons");e.style.display="block",n.style.display="none",d.default.registerTwitter().then(function(e){d.default.twitter.token=e.credential.accessToken,d.default.twitter.secret=e.credential.secret;var n=e.additionalUserInfo.profile.id_str;t.initUser(n,!0,!0)}).catch(function(t){e.style.display="none",n.style.display="block";var r=(t.code,t.message);t.email,t.credential,alert(r)})};var n=document.getElementById("followBtn");n.onclick=function(){n.style.display="none",d.default.followTwitter().then(function(e){if(console.log(e),"followed!"==e.data){document.getElementById("successFollow").style.display="block",setTimeout(function(){t.continue()},2e3)}}).catch(function(t){console.log(t),n.style.display="block"})},document.getElementById("toVideo").addEventListener("click",function(){setTimeout(function(){t.player.playVideo()},300)})},checkTwitter:function(){var t=this;d.default.isFollowingTwitter().then(function(e){console.log(e),t.continue()}).catch(function(t){console.log(t),document.getElementById("regWorking").style.display="none",document.getElementById("regButtons").style.display="block"})},initUser:function(t,e,n){var r=this;d.default.get(t).then(function(i){console.log(i),0==i.data.status?e?d.default.register(t).then(function(e){console.log(e),d.default.isWanderer=!1,d.default.info.id=t,d.default.source=r.params.source,n?r.checkTwitter():r.continue(),r.enableSaveAnswer()}).catch(function(t){d.default.isWanderer=!0,console.log(t),r.pages.toPage("termsPage")}):(r.pages.toPage("regPage"),r.enableSaveAnswer()):(d.default.isWanderer=!1,d.default.info=i.data.user,d.default.source=r.params.source,n?r.checkTwitter():r.continue(),r.enableSaveAnswer())}).catch(function(t){d.default.isWanderer=!0,console.log(t),r.pages.toPage("termsPage")})},enableSaveAnswer:function(){var t=this,e=document.getElementsByClassName("saveQuestion");console.log("enableSaveAnswer");for(var n=0;n<e.length;n++)e[n].addEventListener("click",function(e){if("undefined"!=typeof Storage){var n="{}";localStorage.getItem("localAnswers")&&(n=localStorage.getItem("localAnswers"));var r=JSON.parse(n);r||(r={});for(var i=[],o=1;o<t.q.length;o++)t.q[o].selectedAnswer&&(i[o]=t.q[o].selectedAnswer);r[d.default.info.id]=i,localStorage.setItem("localAnswers",JSON.stringify(r))}parseInt(e.target.dataset.question)})},setQuestions:function(){this.q[1]=new a.singleAnswerQuestion({wrapper:document.getElementById("q1"),question:'<span class="red">QUESTION 1</span><br>あなたの性別を教えてください。',answers:[{value:"男性",text:"男性"},{value:"女性",text:"女性"}],nextBtn:document.getElementById("toQ2")}),this.q[2]=new a.singleAnswerQuestion({wrapper:document.getElementById("q2"),question:'<span class="red">QUESTION 2</span><br>あなたの年代を教えてください。',answers:[{value:"19歳未満",text:"19歳未満"},{value:"20歳〜24歳",text:"20歳〜24歳"},{value:"25歳〜29歳",text:"25歳〜29歳"},{value:"30歳〜34歳",text:"30歳〜34歳"},{value:"35歳〜39歳",text:"35歳〜39歳"},{value:"40歳〜44歳",text:"40歳〜44歳"},{value:"45歳〜49歳",text:"45歳〜49歳"},{value:"50歳〜54歳",text:"50歳〜54歳"},{value:"55歳〜59歳",text:"55歳〜59歳"},{value:"60歳以上",text:"60歳以上"}],nextBtn:document.getElementById("toQ3")}),this.q[3]=new a.dropdownQuestion({wrapper:document.getElementById("q3"),question:'<span class="red">QUESTION 3</span><br>あなたのお住まいの地域は?',answers:[{value:"北海道",text:"北海道"},{value:"青森県",text:"青森県"},{value:"岩手県",text:"岩手県"},{value:"宮城県",text:"宮城県"},{value:"秋田県",text:"秋田県"},{value:"山形県",text:"山形県"},{value:"福島県",text:"福島県"},{value:"茨城県",text:"茨城県"},{value:"栃木県",text:"栃木県"},{value:"群馬県",text:"群馬県"},{value:"埼玉県",text:"埼玉県"},{value:"千葉県",text:"千葉県"},{value:"東京都",text:"東京都"},{value:"神奈川県",text:"神奈川県"},{value:"新潟県",text:"新潟県"},{value:"富山県",text:"富山県"},{value:"石川県",text:"石川県"},{value:"福井県",text:"福井県"},{value:"山梨県",text:"山梨県"},{value:"長野県",text:"長野県"},{value:"岐阜県",text:"岐阜県"},{value:"静岡県",text:"静岡県"},{value:"愛知県",text:"愛知県"},{value:"三重県",text:"三重県"},{value:"滋賀県",text:"滋賀県"},{value:"京都府",text:"京都府"},{value:"大阪府",text:"大阪府"},{value:"兵庫県",text:"兵庫県"},{value:"奈良県",text:"奈良県"},{value:"和歌山県",text:"和歌山県"},{value:"鳥取県",text:"鳥取県"},{value:"島根県",text:"島根県"},{value:"岡山県",text:"岡山県"},{value:"広島県",text:"広島県"},{value:"山口県",text:"山口県"},{value:"徳島県",text:"徳島県"},{value:"香川県",text:"香川県"},{value:"愛媛県",text:"愛媛県"},{value:"高知県",text:"高知県"},{value:"福岡県",text:"福岡県"},{value:"佐賀県",text:"佐賀県"},{value:"長崎県",text:"長崎県"},{value:"熊本県",text:"熊本県"},{value:"大分県",text:"大分県"},{value:"宮崎県",text:"宮崎県"},{value:"鹿児島県",text:"鹿児島県"},{value:"沖縄県",text:"沖縄県"}],nextBtn:document.getElementById("toQ4")}),this.q[4]=new a.singleAnswerQuestion({wrapper:document.getElementById("q4"),question:'<span class="red">QUESTION 4</span><br>普段どんなシャンプーを利用していますか？',answers:[{value:"ボタニカルシャンプー",text:"ボタニカルシャンプー"},{value:"パンテーン",text:"パンテーン"},{value:"LUX",text:"LUX"},{value:"メリット",text:"メリット"},{value:"いち髪",text:"いち髪"},{text:"その他",type:"text"}],nextBtn:document.getElementById("toQ5")}),this.q[5]=new a.singleAnswerQuestion({wrapper:document.getElementById("q5"),question:'<span class="red">QUESTION 5</span><br>普段シャンプーはどこで買いますか？。',answers:[{value:"コンビニエンスストア",text:"コンビニエンスストア"},{value:"スーパー",text:"スーパー"},{value:"ドラックストア",text:"ドラックストア"},{text:"その他",type:"text"}],nextBtn:document.getElementById("toApply")})},init:function(){var t=this,e=document.getElementById("vid").clientWidth,n=document.getElementById("vid").clientHeight;this.params=this.getParams(),this.params.source="source1",this.pages=new o.default({pageWrapperClass:document.getElementById("page-wrapper"),pageClass:"page",initialPage:document.getElementById("loadingPage"),pageButtonClass:"pageBtn"}),this.formSections=new o.default({pageWrapperClass:document.getElementById("formSecWrapper"),pageClass:"sec",initialPage:document.getElementById("regSec")}),this.setQuestions(),this.events(),u.default.init("miniSelect"),this.params.userId&&this.params.source?this.initUser(this.params.userId,!1):(d.default.isWanderer=!0,setTimeout(function(){t.pages.toPage("regPage")},1e3)),l.coupon.get(this.params.source);var r=!1,i=document.createElement("script");i.src="https://www.youtube.com/iframe_api";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(i,a),window.onYouTubeIframeAPIReady=function(){t.player=new YT.Player("vid",{height:n.toString(),width:e.toString(),playerVars:{rel:0,showinfo:0,controls:0,playsinline:1},videoId:"wfxBX7Gwngg",events:{onStateChange:function(e){e.data==YT.PlayerState.ENDED&&(r||(r=!0,t.processResult(),t.pages.toPage("resultPage")))}}})}}};document.addEventListener("DOMContentLoaded",function(){p.init(),h.default.init(),window.q=p.q,window.params=p.params}),e.user=d.default,e.coupon=l.coupon},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){var n=this;r(this,t),this.currentPage=e.initialPage,this.switching=!1,this.pages=[];for(var i=document.getElementsByClassName(e.pageClass),o=document.getElementsByClassName(e.pageButtonClass),a=e.pageWrapperClass,s=0;s<a.length;s++)a[s].style.position="relative";for(var u=0;u<i.length;u++)i[u].style.position="absolute",i[u].style.width="100%",i[u].style.height="100%",i[u].style.display="none",this.pages.push(i[u].id);for(var c=0;c<o.length;c++)o[c].addEventListener("click",function(t){n.switching||n.toPage(t.target.dataset.target)});this.currentPage.style.display="block"}return i(t,[{key:"toPage",value:function(t){var e=this,n=document.getElementById(t);if(n){var r=this.pages.indexOf(t),i=this.pages.indexOf(this.currentPage.id);if(r>-1){var o=r>i?1:-1;n.style.left=1==o?"100%":"-100%",n.style.display="block",n.style.transition="all 0.3s",this.currentPage.style.transition="all 0.3s",this.switching=!0,setTimeout(function(){n.style.left="0px",e.currentPage.style.left=1==o?"-100%":"100%",setTimeout(function(){n.style.transition="none",e.currentPage.style.transition="none",e.currentPage.style.display="none",e.currentPage=n,e.switching=!1},350)},100)}}}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.dropdownQuestion=e.multipleAnswerQuestion=e.singleAnswerQuestion=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(15);var o=function(){function t(e){var n=this;r(this,t),this.wrapper=e.wrapper,this.selectedAnswer="",this.answers=[],e.nextBtn&&(this.nextBtn=e.nextBtn,this.nextBtn.disabled=!0),this.questionWrapper=document.createElement("div"),this.questionWrapper.classList.add("question-wrapper"),this.questionWrapper.innerHTML=e.question,this.wrapper.appendChild(this.questionWrapper),this.answerWrapper=document.createElement("div"),this.answerWrapper.classList.add("answer-wrapper"),this.wrapper.appendChild(this.answerWrapper);for(var i=0;i<e.answers.length;i++){var o=document.createElement("div");o.innerHTML=e.answers[i].text,o.classList.add("answer");var a=document.createElement("div");a.classList.add("rad"),o.appendChild(a),e.answers[i].type?(this.input=document.createElement("input"),this.input.setAttribute("type","text"),this.input.setAttribute("maxlength","50"),this.input.disabled=!0,o.appendChild(this.input),o.classList.add("input"),this.input.oninput=function(){n.input.parentNode.classList.contains("selected")&&(n.input.value?(n.selectedAnswer="その他: "+n.input.value,n.nextBtn.disabled=!1):n.nextBtn.disabled=!0)}):o.dataset.value=e.answers[i].value,this.answerWrapper.appendChild(o),o.addEventListener("click",function(t){n.selectAnswer(t.target)}),this.answers.push(o)}}return i(t,[{key:"selectAnswer",value:function(t){var e=!1;if(!t.classList.contains("selected")){for(var n=0;n<this.answers.length;n++)this.answers[n].classList.remove("selected");t.classList.add("selected"),t.classList.contains("input")?(this.input.disabled=!1,this.input.focus(),e=!0):(this.selectedAnswer=t.dataset.value,this.input&&(this.input.disabled=!0)),this.nextBtn&&(e?this.input.value?this.nextBtn.disabled=!1:this.nextBtn.disabled=!0:this.nextBtn.disabled=!1)}}},{key:"setAnswer",value:function(t){if(t.indexOf("その他:")<0)for(var e=0;e<this.answers.length;e++)this.answers[e].dataset.value==t&&this.selectAnswer(this.answers[e]);else this.selectAnswer(this.input.parentNode),this.input.value=t.split(": ")[1],this.nextBtn&&(this.nextBtn.disabled=!1)}}]),t}(),a=function(){function t(e){var n=this;r(this,t),this.wrapper=e.wrapper,this.selectedAnswer="",this.answers=[],e.nextBtn&&(this.nextBtn=e.nextBtn,this.nextBtn.disabled=!0),this.questionWrapper=document.createElement("div"),this.questionWrapper.classList.add("question-wrapper"),this.questionWrapper.innerHTML=e.question,this.wrapper.appendChild(this.questionWrapper),this.answerWrapper=document.createElement("div"),this.answerWrapper.classList.add("answer-wrapper"),this.wrapper.appendChild(this.answerWrapper);for(var i=0;i<e.answers.length;i++){var o=document.createElement("div");o.innerHTML=e.answers[i].text,o.classList.add("m-answer");var a=document.createElement("div");a.classList.add("checkmark"),o.appendChild(a),e.answers[i].type?(this.input=document.createElement("input"),this.input.setAttribute("type","text"),this.input.setAttribute("maxlength","50"),this.input.disabled=!0,o.appendChild(this.input),o.classList.add("input"),this.input.oninput=function(){n.compileAnswer()}):o.dataset.value=e.answers[i].value,this.answerWrapper.appendChild(o),o.addEventListener("click",function(t){n.selectAnswer(t.target)}),this.answers.push(o)}}return i(t,[{key:"selectAnswer",value:function(t){t.dataset.value;t.classList.contains("selected")?t.classList.remove("selected"):(t.classList.add("selected"),t.classList.contains("input")&&(this.input.disabled=!1,this.input.focus())),this.compileAnswer()}},{key:"compileAnswer",value:function(){for(var t=[],e=0;e<this.answers.length;e++)this.answers[e].classList.contains("selected")&&(this.answers[e].classList.contains("input")?this.input.value&&t.push("その他: "+this.input.value):t.push(this.answers[e].dataset.value));this.selectedAnswer=JSON.stringify(t),this.nextBtn&&(t.length>0?this.nextBtn.disabled=!1:this.nextBtn.disabled=!0)}},{key:"setAnswer",value:function(t){for(var e=JSON.parse(t),n=0;n<e.length;n++)if(e[n].indexOf("その他:")<0)for(var r=0;r<this.answers.length;r++)this.answers[r].dataset.value==e[n]&&this.selectAnswer(this.answers[r]);else this.selectAnswer(this.input.parentNode),this.input.value=e[n].split(": ")[1],this.nextBtn&&(this.nextBtn.disabled=!1)}}]),t}(),s=function(){function t(e){var n=this;r(this,t),this.wrapper=e.wrapper,this.selectedAnswer="",this.answers=[],e.nextBtn&&(this.nextBtn=e.nextBtn,this.nextBtn.disabled=!0),this.questionWrapper=document.createElement("div"),this.questionWrapper.classList.add("question-wrapper"),this.questionWrapper.innerHTML=e.question,this.wrapper.appendChild(this.questionWrapper),this.answerWrapper=document.createElement("div"),this.answerWrapper.classList.add("answer-wrapper"),this.wrapper.appendChild(this.answerWrapper);var i=document.createElement("div");i.classList.add("miniSelect"),this.answerWrapper.appendChild(i),this.select=document.createElement("select"),i.appendChild(this.select);var o=document.createElement("option");o.setAttribute("value","0"),o.innerHTML="選択してください",o.selected=!0,this.select.appendChild(o);for(var a=0;a<e.answers.length;a++){var s=document.createElement("option");s.setAttribute("value",e.answers[a].value),s.innerHTML=e.answers[a].text,this.select.appendChild(s)}this.select.onchange=function(t){n.selectedAnswer=n.select.value,n.nextBtn&&(n.nextBtn.disabled=!1)}}return i(t,[{key:"setAnswer",value:function(t){this.select.nextElementSibling.classList.contains("miniSelect-selected")&&(this.select.nextElementSibling.textContent=t),this.select.value=t,this.select.onchange()}}]),t}();e.singleAnswerQuestion=o,e.multipleAnswerQuestion=a,e.dropdownQuestion=s},function(t,e){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={classes:"",init:function(t){var e=this;this.classes=t;for(var n=t.split(" "),r=0;r<n.length;r++)for(var i,o,a,s,u=document.getElementsByClassName(n[r]),c=0;c<u.length;c++){i=u[c].getElementsByTagName("select")[0],o=document.createElement("div"),o.dataset.showing=0,o.setAttribute("class",n[r]+"-selected"),o.innerHTML=i.options[i.selectedIndex].innerHTML,u[c].appendChild(o),a=document.createElement("div"),a.setAttribute("class",n[r]+"-items");for(var h=1;h<i.length;h++)s=document.createElement("div"),s.innerHTML=i.options[h].innerHTML,s.dataset.index=h,s.addEventListener("click",function(t){var e=this.parentNode.parentNode.getElementsByTagName("select")[0],n=this.parentNode.previousSibling;e.selectedIndex=this.dataset.index,n.innerHTML=this.innerHTML,n.click(),i.onchange()}),a.appendChild(s);a.style.display="none",u[c].appendChild(a),o.addEventListener("click",function(t){t.stopPropagation(),0==this.dataset.showing&&(this.classList.contains("active")?(this.classList.remove("active"),e.close(this,this.nextSibling)):(this.classList.add("active"),e.show(this,this.nextSibling)))})}document.addEventListener("click",function(){e.closeAllSelect()})},closeAllSelect:function(){for(var t=this.classes.split(" "),e=0;e<t.length;e++)for(var n=(document.getElementsByClassName(t[e]+"-items"),document.getElementsByClassName(t[e]+"-selected")),r=0;r<n.length;r++)0==n[r].dataset.showing&&n[r].classList.contains("active")&&(n[r].classList.remove("active"),this.close(n[r],n[r].nextSibling))},show:function(t,e){t.dataset.showing=1,e.style.transition="none",e.style.display="block",e.style.opacity="0",e.style.transform="translateY(-50px)",setTimeout(function(){e.style.transition="all 0.3s",e.style.opacity="1",e.style.transform="translateY(0)",setTimeout(function(){t.dataset.showing=0},350)},100)},close:function(t,e){t.dataset.showing=1,e.style.transition="all 0.3s",e.style.opacity="0",e.style.transform="translateY(-50px)",setTimeout(function(){e.style.display="none",t.dataset.showing=0},350)}};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={init:function(){for(var t=document.getElementsByClassName("modalOpener"),e=document.getElementsByClassName("modalCloser"),n=0;n<t.length;n++)t[n].addEventListener("click",function(){var t=this.dataset.target;document.getElementById(t).style.display="block"});for(var r=0;r<e.length;r++)e[r].addEventListener("click",function(){var t=this.dataset.target;document.getElementById(t).style.display="none"})},closeAll:function(){for(var t=document.getElementsByClassName("modal"),e=0;e<t.length;e++)t[e].style.display="none"}};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.coupon=e.winningLogic=void 0;var r=n(19),i=function(t){return t&&t.__esModule?t:{default:t}}(r),o={winLogic:{5:{value:["コンビニエンスストア","スーパー"],priority:[2,3]}},loseLogic:{},eligibility:[],process:function(t,e){var n=20,r=10;for(var o in this.winLogic){var a=parseInt(o);if("string"==typeof this.winLogic[o].value)t[a].selectedAnswer.indexOf(this.winLogic[o].value)>-1&&(n=n>this.winLogic[o].priority?this.winLogic[o].priority:n,this.eligibility.push(this.winLogic[o].priority));else for(var s=0;s<this.winLogic[o].value.length;s++)t[a].selectedAnswer.indexOf(this.winLogic[o].value[s])>-1&&(n=n>this.winLogic[o].priority[s]?this.winLogic[o].priority[s]:n,this.eligibility.push(this.winLogic[o].priority[s]))}for(var u in this.loseLogic){var c=parseInt(u);if("string"==typeof this.loseLogic[u].value)t[c].selectedAnswer.indexOf(this.loseLogic[u].value)>-1&&(r=r>this.loseLogic[u].priority?this.loseLogic[u].priority:r);else for(var h=0;h<this.loseLogic[u].value.length;h++)t[c].selectedAnswer.indexOf(this.loseLogic[u].value[h])>-1&&(r=r>this.loseLogic[u].priority[h]?this.loseLogic[u].priority[h]:r)}var l="lose",f=["","","A","B"],d="NA",p="0",m="lose";if(n<r&&(l="win",m="win",p="1",e))if(i.default.count){d=f[n];for(var y=[],g=0;g<this.eligibility.length;g++){var v=f[this.eligibility[g]];i.default.count[v]>0&&y.push(this.eligibility[g])}y.length>0?(y.sort(function(t,e){return t-e}),d=f[y[0]]):(m="lose",p="0")}else m="lose",p="0";return{trackingResult:l,actualResult:m,flag:p,group:d}}};e.winningLogic=o,e.coupon=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),i=(function(t){t&&t.__esModule}(r),{count:{A:0,B:0,C:0,D:0},get:function(t){this.count.A=10,this.count.B=10,this.count.C=0,this.count.D=0}});e.default=i},function(t,e,n){"use strict";function r(t){var e=new a(t),n=o(a.prototype.request,e);return i.extend(n,a.prototype,e),i.extend(n,e),n}var i=n(0),o=n(6),a=n(22),s=n(2),u=r(s);u.Axios=a,u.create=function(t){return r(i.merge(s,t))},u.Cancel=n(10),u.CancelToken=n(36),u.isCancel=n(9),u.all=function(t){return Promise.all(t)},u.spread=n(37),t.exports=u,t.exports.default=u},function(t,e,n){"use strict";function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function i(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(r(t)||i(t)||!!t._isBuffer)}},function(t,e,n){"use strict";function r(t){this.defaults=t,this.interceptors={request:new a,response:new a}}var i=n(2),o=n(0),a=n(31),s=n(32);r.prototype.request=function(t){"string"==typeof t&&(t=o.merge({url:arguments[0]},arguments[1])),t=o.merge(i,{method:"get"},this.defaults,t),t.method=t.method.toLowerCase();var e=[s,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},o.forEach(["delete","get","head","options"],function(t){r.prototype[t]=function(e,n){return this.request(o.merge(n||{},{method:t,url:e}))}}),o.forEach(["post","put","patch"],function(t){r.prototype[t]=function(e,n,r){return this.request(o.merge(r||{},{method:t,url:e,data:n}))}}),t.exports=r},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e){r.forEach(t,function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])})}},function(t,e,n){"use strict";var r=n(8);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t}},function(t,e,n){"use strict";function r(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var i=n(0);t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(i.isURLSearchParams(e))o=e.toString();else{var a=[];i.forEach(e,function(t,e){null!==t&&void 0!==t&&(i.isArray(t)?e+="[]":t=[t],i.forEach(t,function(t){i.isDate(t)?t=t.toISOString():i.isObject(t)&&(t=JSON.stringify(t)),a.push(r(e)+"="+r(t))}))}),o=a.join("&")}return o&&(t+=(-1===t.indexOf("?")?"?":"&")+o),t}},function(t,e,n){"use strict";var r=n(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}}),a):a}},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?function(){function t(t){var e=t;return n&&(i.setAttribute("href",e),e=i.href),i.setAttribute("href",e),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}var e,n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");return e=t(window.location.href),function(n){var i=r.isString(n)?t(n):n;return i.protocol===e.protocol&&i.host===e.host}}():function(){return function(){return!0}}()},function(t,e,n){"use strict";function r(){this.message="String contains an invalid character"}function i(t){for(var e,n,i=String(t),a="",s=0,u=o;i.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&e>>8-s%1*8)){if((n=i.charCodeAt(s+=.75))>255)throw new r;e=e<<8|n}return a}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",t.exports=i},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?function(){return{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(t,e,n){"use strict";function r(){this.handlers=[]}var i=n(0);r.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){i.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=r},function(t,e,n){"use strict";function r(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var i=n(0),o=n(33),a=n(9),s=n(2),u=n(34),c=n(35);t.exports=function(t){return r(t),t.baseURL&&!u(t.url)&&(t.url=c(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=i.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||s.adapter)(t).then(function(e){return r(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return a(e)||(r(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e,n){return r.forEach(n,function(n){t=n(t,e)}),t}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new i(t),e(n.reason))})}var i=n(10);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r(function(e){t=e}),cancel:t}},t.exports=r},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=r(i),a=n(39),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a);n(45),n(47);var u=n(51),c=r(u);s.initializeApp(c.default);var h="https://www.mobileads.com",l="https://us-central1-dentsudemo-9ce77.cloudfunctions.net/twitter",f=s.firestore(),d={timestampsInSnapshots:!0};f.settings(d);var p="https://track.richmediaads.com/a/analytic.htm?rmaId={{rmaId}}&domainId=0&pageLoadId={{cb}}&userId={{adUserId}}&pubUserId=0&campaignId={{campaignId}}&callback=trackSuccess&type={{type}}&value={{value}}&uniqueId={{userId}}",m=p.replace("{{rmaId}}","1").replace("{{campaignId}}","ca8ca8c34a363fa07b2d38d007ca55c6").replace("{{adUserId}}","4441").replace("{{cb}}",Date.now().toString()),y={isWanderer:!1,source:"",twitter:{token:"",secret:""},info:{Answers:"",couponLink:"",id:"",noQuestionAnswered:0,state:"-"},get:function(t){return new Promise(function(e,n){var r=!1,i={};f.collection("users").get().then(function(n){n.forEach(function(e){e.data().id==t&&(r=!0,i=e.data())}),e(r?{data:{message:"retrieved.",user:i,status:!0}}:{data:{message:"not registered.",status:!1}})})})},register:function(t){return new Promise(function(e,n){var r=!1,i={};f.collection("users").get().then(function(o){o.forEach(function(e){e.data().id==t&&(r=!0,i=e.data())}),r?e({data:{message:"user exist.",user:i,status:!1}}):f.collection("users").add({id:t,couponLink:"",Answers:"{}",noQuestionAnswered:0,state:"-"}).then(function(t){e({data:{message:"registration success.",status:!0}})}).catch(function(t){n({data:{message:"error",status:!1}})})})})},trackRegister:function(t){if(window.location.hostname.indexOf("localhost")<0){var e=m.replace("{{type}}","page_view").replace("{{value}}","").replace("{{userId}}",t);return o.default.get(e)}},sendEmail:function(t,e,n){var r=new FormData;r.append("sender","contact@o2otracking.com"),r.append("subject",e),r.append("recipient",t),r.append("content",n),o.default.post(h+"/mail/send",r,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},registerTwitter:function(){console.log("registerTwitter");var t=new s.auth.TwitterAuthProvider;return s.auth().signInWithPopup(t)},isFollowingTwitter:function(){return o.default.post(l+"/getUser",{token:this.twitter.token,tokenSecret:this.twitter.secret,id:this.info.id})},followTwitter:function(){return o.default.post(l+"/followUs",{token:this.twitter.token,tokenSecret:this.twitter.secret})},messageTwitter:function(t){return o.default.post(l+"/sendMessage",{token:this.twitter.token,tokenSecret:this.twitter.secret,recipientId:this.info.id,text:t})},saveAnswer:function(t,e,n){var r=new FormData;return r.append("id",t),r.append("questionNo",e),r.append("answer",n),o.default.post(h+"/api/coupon/softbank/user_answer_save",r,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},trackAnswer:function(t,e,n){if(window.location.hostname.indexOf("localhost")<0){var r="q"+e.toString()+"_"+encodeURIComponent(n),i=m.replace("{{type}}","q_a").replace("{{value}}",r).replace("{{userId}}",t);return o.default.get(i)}},win:function(t,e,n){return new Promise(function(e,n){var r=!1,i={},o="";f.collection("users").get().then(function(a){a.forEach(function(e){e.data().id==t&&(r=!0,o=e.id,i=e.data())}),r?f.collection("users").doc(o).update({state:"win",couponLink:"https://rmarepo.richmediaads.com/o2o/dentsu/demo/coupon.html"}).then(function(){e({data:{couponLink:"https://rmarepo.richmediaads.com/o2o/dentsu/demo/coupon.html",message:"marked.",status:!0}})}).catch(function(t){n({data:{message:"error during mark",status:!0}})}):n({data:{message:"user not found",status:!1}})})})},trackWin:function(t){if(window.location.hostname.indexOf("localhost")<0){var e=m.replace("{{type}}","win").replace("{{value}}","").replace("{{userId}}",t);return e+="&tt=E&ty=E",o.default.get(e)}},trackLose:function(t){if(window.location.hostname.indexOf("localhost")<0){var e=m.replace("{{type}}","lose").replace("{{value}}","").replace("{{userId}}",t);return e+="&tt=E&ty=E",o.default.get(e)}},lose:function(t,e){return new Promise(function(e,n){var r=!1,i={},o="";f.collection("users").get().then(function(a){a.forEach(function(e){e.data().id==t&&(r=!0,o=e.id,i=e.data())}),r?f.collection("users").doc(o).update({state:"lose"}).then(function(){e({data:{message:"marked.",status:!0}})}).catch(function(t){n({data:{message:"error during mark",status:!0}})}):n({data:{message:"user not found",status:!1}})})})},passResult:function(t,e,n,r){var i=new FormData;return i.append("user_id",t),i.append("flag",e),i.append("campaign_id","ca8ca8c34a363fa07b2d38d007ca55c6"),i.append("source",n),r&&i.append("coupon_url",encodeURIComponent(r)),o.default.post(h+"/api/coupon/softbank/api_call",i,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}};e.default=y},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n(40);var i=function(t){return t&&"object"===(void 0===t?"undefined":r(t))&&"default"in t?t.default:t}(n(4));t.exports=i},function(t,e,n){"use strict";(function(t,e){function r(){}function i(t,e){return function(){t.apply(e,arguments)}}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function a(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?s:u)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void u(e.promise,t)}s(e.promise,r)})}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===(void 0===e?"undefined":d(e))||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l(i(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function h(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}function f(t,e){return e={exports:{}},t(e,e.exports),e.exports}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n(43);var p=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new h(t,e,n)),n},o.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},o.all=function(t){return new o(function(e,n){function r(t,a){try{if(a&&("object"===(void 0===a?"undefined":d(a))||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(t,e)},n)}i[t]=a,0==--o&&e(i)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},o.resolve=function(t){return t&&"object"===(void 0===t?"undefined":d(t))&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(t){p(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var m=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();m.Promise||(m.Promise=o);var y=f(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),g=f(function(t){var e=t.exports={version:"2.5.5"};"number"==typeof __e&&(__e=e)}),v=(g.version,function(t){return"object"===(void 0===t?"undefined":d(t))?null!==t:"function"==typeof t}),b=function(t){if(!v(t))throw TypeError(t+" is not an object!");return t},w=function(t){try{return!!t()}catch(t){return!0}},E=!w(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),T=y.document,I=v(T)&&v(T.createElement),S=function(t){return I?T.createElement(t):{}},A=!E&&!w(function(){return 7!=Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a}),_=function(t,e){if(!v(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!v(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!v(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!v(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},k=Object.defineProperty,N=E?Object.defineProperty:function(t,e,n){if(b(t),e=_(e,!0),b(n),A)try{return k(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t},C={f:N},D=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},O=E?function(t,e,n){return C.f(t,e,D(1,n))}:function(t,e,n){return t[e]=n,t},R={}.hasOwnProperty,x=function(t,e){return R.call(t,e)},L=0,P=Math.random(),M=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++L+P).toString(36))},B=f(function(t){var e=M("src"),n=Function.toString,r=(""+n).split("toString");g.inspectSource=function(t){return n.call(t)},(t.exports=function(t,n,i,o){var a="function"==typeof i;a&&(x(i,"name")||O(i,"name",n)),t[n]!==i&&(a&&(x(i,e)||O(i,e,t[n]?""+t[n]:r.join(String(n)))),t===y?t[n]=i:o?t[n]?t[n]=i:O(t,n,i):(delete t[n],O(t,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[e]||n.call(this)})}),U=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},F=function(t,e,n){if(U(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},V=function t(e,n,r){var i,o,a,s,u=e&t.F,c=e&t.G,h=e&t.S,l=e&t.P,f=e&t.B,d=c?y:h?y[n]||(y[n]={}):(y[n]||{}).prototype,p=c?g:g[n]||(g[n]={}),m=p.prototype||(p.prototype={});c&&(r=n);for(i in r)o=!u&&d&&void 0!==d[i],a=(o?d:r)[i],s=f&&o?F(a,y):l&&"function"==typeof a?F(Function.call,a):a,d&&B(d,i,a,e&t.U),p[i]!=a&&O(p,i,s),l&&m[i]!=a&&(m[i]=a)};y.core=g,V.F=1,V.G=2,V.S=4,V.P=8,V.B=16,V.W=32,V.U=64,V.R=128;var q=V,j={}.toString,W=function(t){return j.call(t).slice(8,-1)},K=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==W(t)?t.split(""):Object(t)},H=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},G=function(t){return Object(H(t))},Q=Math.ceil,z=Math.floor,X=function(t){return isNaN(t=+t)?0:(t>0?z:Q)(t)},Y=Math.min,J=function(t){return t>0?Y(X(t),9007199254740991):0},$=Array.isArray||function(t){return"Array"==W(t)},Z=y["__core-js_shared__"]||(y["__core-js_shared__"]={}),tt=function(t){return Z[t]||(Z[t]={})},et=f(function(t){var e=tt("wks"),n=y.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:M)("Symbol."+t))}).store=e}),nt=et("species"),rt=function(t){var e;return $(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!$(e.prototype)||(e=void 0),v(e)&&null===(e=e[nt])&&(e=void 0)),void 0===e?Array:e},it=function(t,e){return new(rt(t))(e)},ot=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||it;return function(e,c,h){for(var l,f,d=G(e),p=K(d),m=F(c,h,3),y=J(p.length),g=0,v=n?u(e,y):r?u(e,0):void 0;y>g;g++)if((s||g in p)&&(l=p[g],f=m(l,g,d),t))if(n)v[g]=f;else if(f)switch(t){case 3:return!0;case 5:return l;case 6:return g;case 2:v.push(l)}else if(o)return!1;return a?-1:i||o?o:v}},at=et("unscopables"),st=Array.prototype;void 0==st[at]&&O(st,at,{});var ut=function(t){st[at][t]=!0},ct=ot(5),ht=!0;"find"in[]&&Array(1).find(function(){ht=!1}),q(q.P+q.F*ht,"Array",{find:function(t){return ct(this,t,arguments.length>1?arguments[1]:void 0)}}),ut("find");var lt=(g.Array.find,ot(6)),ft=!0;"findIndex"in[]&&Array(1).findIndex(function(){ft=!1}),q(q.P+q.F*ft,"Array",{findIndex:function(t){return lt(this,t,arguments.length>1?arguments[1]:void 0)}}),ut("findIndex");var dt=(g.Array.findIndex,function(t){return K(H(t))}),pt=Math.max,mt=Math.min,yt=function(t,e){return t=X(t),t<0?pt(t+e,0):mt(t,e)},gt=tt("keys"),vt=function(t){return gt[t]||(gt[t]=M(t))},bt=function(t){return function(e,n,r){var i,o=dt(e),a=J(o.length),s=yt(r,a);if(t&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}}(!1),wt=vt("IE_PROTO"),Et=function(t,e){var n,r=dt(t),i=0,o=[];for(n in r)n!=wt&&x(r,n)&&o.push(n);for(;e.length>i;)x(r,n=e[i++])&&(~bt(o,n)||o.push(n));return o},Tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),It=Object.keys||function(t){return Et(t,Tt)},St=Object.getOwnPropertySymbols,At={f:St},_t={}.propertyIsEnumerable,kt={f:_t},Nt=Object.assign,Ct=!Nt||w(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Nt({},t)[n]||Object.keys(Nt({},e)).join("")!=r})?function(t,e){for(var n=G(t),r=arguments.length,i=1,o=At.f,a=kt.f;r>i;)for(var s,u=K(arguments[i++]),c=o?It(u).concat(o(u)):It(u),h=c.length,l=0;h>l;)a.call(u,s=c[l++])&&(n[s]=u[s]);return n}:Nt;q(q.S+q.F,"Object",{assign:Ct});var Dt=(g.Object.assign,et("match")),Ot=function(t){var e;return v(t)&&(void 0!==(e=t[Dt])?!!e:"RegExp"==W(t))},Rt=function(t,e,n){if(Ot(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(H(t))},xt=et("match"),Lt="".startsWith;q(q.P+q.F*function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[xt]=!1,!"/./"[t](e)}catch(t){}}return!0}("startsWith"),"String",{startsWith:function(t){var e=Rt(this,t,"startsWith"),n=J(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return Lt?Lt.call(e,r,n):e.slice(n,n+r.length)===r}});var Pt=(g.String.startsWith,function(t){var e=String(H(this)),n="",r=X(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n});q(q.P,"String",{repeat:Pt});var Mt=(g.String.repeat,f(function(t){var e=M("meta"),n=C.f,r=0,i=Object.isExtensible||function(){return!0},o=!w(function(){return i(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},s=function(t,n){if(!v(t))return"symbol"==(void 0===t?"undefined":d(t))?t:("string"==typeof t?"S":"P")+t;if(!x(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},u=function(t,n){if(!x(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},c=function(t){return o&&h.NEED&&i(t)&&!x(t,e)&&a(t),t},h=t.exports={KEY:e,NEED:!1,fastKey:s,getWeak:u,onFreeze:c}})),Bt=(Mt.KEY,Mt.NEED,Mt.fastKey,Mt.getWeak,Mt.onFreeze,C.f),Ut=et("toStringTag"),Ft=function(t,e,n){t&&!x(t=n?t:t.prototype,Ut)&&Bt(t,Ut,{configurable:!0,value:e})},Vt=et,qt={f:Vt},jt=C.f,Wt=function(t){var e=g.Symbol||(g.Symbol=y.Symbol||{});"_"==t.charAt(0)||t in e||jt(e,t,{value:qt.f(t)})},Kt=function(t){var e=It(t),n=At.f;if(n)for(var r,i=n(t),o=kt.f,a=0;i.length>a;)o.call(t,r=i[a++])&&e.push(r);return e},Ht=E?Object.defineProperties:function(t,e){b(t);for(var n,r=It(e),i=r.length,o=0;i>o;)C.f(t,n=r[o++],e[n]);return t},Gt=y.document,Qt=Gt&&Gt.documentElement,zt=vt("IE_PROTO"),Xt=function(){},Yt=function(){var t,e=S("iframe"),n=Tt.length;for(e.style.display="none",Qt.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),Yt=t.F;n--;)delete Yt.prototype[Tt[n]];return Yt()},Jt=Object.create||function(t,e){var n;return null!==t?(Xt.prototype=b(t),n=new Xt,Xt.prototype=null,n[zt]=t):n=Yt(),void 0===e?n:Ht(n,e)},$t=Tt.concat("length","prototype"),Zt=Object.getOwnPropertyNames||function(t){return Et(t,$t)},te={f:Zt},ee=te.f,ne={}.toString,re="object"==("undefined"==typeof window?"undefined":d(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ie=function(t){try{return ee(t)}catch(t){return re.slice()}},oe=function(t){return re&&"[object Window]"==ne.call(t)?ie(t):ee(dt(t))},ae={f:oe},se=Object.getOwnPropertyDescriptor,ue=E?se:function(t,e){if(t=dt(t),e=_(e,!0),A)try{return se(t,e)}catch(t){}if(x(t,e))return D(!kt.f.call(t,e),t[e])},ce={f:ue},he=Mt.KEY,le=ce.f,fe=C.f,de=ae.f,pe=y.Symbol,me=y.JSON,ye=me&&me.stringify,ge=et("_hidden"),ve=et("toPrimitive"),be={}.propertyIsEnumerable,we=tt("symbol-registry"),Ee=tt("symbols"),Te=tt("op-symbols"),Ie=Object.prototype,Se="function"==typeof pe,Ae=y.QObject,_e=!Ae||!Ae.prototype||!Ae.prototype.findChild,ke=E&&w(function(){return 7!=Jt(fe({},"a",{get:function(){return fe(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=le(Ie,e);r&&delete Ie[e],fe(t,e,n),r&&t!==Ie&&fe(Ie,e,r)}:fe,Ne=function(t){var e=Ee[t]=Jt(pe.prototype);return e._k=t,e},Ce=Se&&"symbol"==d(pe.iterator)?function(t){return"symbol"==(void 0===t?"undefined":d(t))}:function(t){return t instanceof pe},De=function(t,e,n){return t===Ie&&De(Te,e,n),b(t),e=_(e,!0),b(n),x(Ee,e)?(n.enumerable?(x(t,ge)&&t[ge][e]&&(t[ge][e]=!1),n=Jt(n,{enumerable:D(0,!1)})):(x(t,ge)||fe(t,ge,D(1,{})),t[ge][e]=!0),ke(t,e,n)):fe(t,e,n)},Oe=function(t,e){b(t);for(var n,r=Kt(e=dt(e)),i=0,o=r.length;o>i;)De(t,n=r[i++],e[n]);return t},Re=function(t,e){return void 0===e?Jt(t):Oe(Jt(t),e)},xe=function(t){var e=be.call(this,t=_(t,!0));return!(this===Ie&&x(Ee,t)&&!x(Te,t))&&(!(e||!x(this,t)||!x(Ee,t)||x(this,ge)&&this[ge][t])||e)},Le=function(t,e){if(t=dt(t),e=_(e,!0),t!==Ie||!x(Ee,e)||x(Te,e)){var n=le(t,e);return!n||!x(Ee,e)||x(t,ge)&&t[ge][e]||(n.enumerable=!0),n}},Pe=function(t){for(var e,n=de(dt(t)),r=[],i=0;n.length>i;)x(Ee,e=n[i++])||e==ge||e==he||r.push(e);return r},Me=function(t){for(var e,n=t===Ie,r=de(n?Te:dt(t)),i=[],o=0;r.length>o;)!x(Ee,e=r[o++])||n&&!x(Ie,e)||i.push(Ee[e]);return i};Se||(pe=function(){if(this instanceof pe)throw TypeError("Symbol is not a constructor!");var t=M(arguments.length>0?arguments[0]:void 0),e=function e(n){this===Ie&&e.call(Te,n),x(this,ge)&&x(this[ge],t)&&(this[ge][t]=!1),ke(this,t,D(1,n))};return E&&_e&&ke(Ie,t,{configurable:!0,set:e}),Ne(t)},B(pe.prototype,"toString",function(){return this._k}),ce.f=Le,C.f=De,te.f=ae.f=Pe,kt.f=xe,At.f=Me,E&&B(Ie,"propertyIsEnumerable",xe,!0),qt.f=function(t){return Ne(et(t))}),q(q.G+q.W+q.F*!Se,{Symbol:pe});for(var Be="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ue=0;Be.length>Ue;)et(Be[Ue++]);for(var Fe=It(et.store),Ve=0;Fe.length>Ve;)Wt(Fe[Ve++]);q(q.S+q.F*!Se,"Symbol",{for:function(t){return x(we,t+="")?we[t]:we[t]=pe(t)},keyFor:function(t){if(!Ce(t))throw TypeError(t+" is not a symbol!");for(var e in we)if(we[e]===t)return e},useSetter:function(){_e=!0},useSimple:function(){_e=!1}}),q(q.S+q.F*!Se,"Object",{create:Re,defineProperty:De,defineProperties:Oe,getOwnPropertyDescriptor:Le,getOwnPropertyNames:Pe,getOwnPropertySymbols:Me}),me&&q(q.S+q.F*(!Se||w(function(){var t=pe();return"[null]"!=ye([t])||"{}"!=ye({a:t})||"{}"!=ye(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(v(e)||void 0!==t)&&!Ce(t))return $(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Ce(e))return e}),r[1]=e,ye.apply(me,r)}}),pe.prototype[ve]||O(pe.prototype,ve,pe.prototype.valueOf),Ft(pe,"Symbol"),Ft(Math,"Math",!0),Ft(y.JSON,"JSON",!0);var qe=et("toStringTag"),je="Arguments"==W(function(){return arguments}()),We=function(t,e){try{return t[e]}catch(t){}},Ke=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=We(e=Object(t),qe))?n:je?W(e):"Object"==(r=W(e))&&"function"==typeof e.callee?"Arguments":r},He={};He[et("toStringTag")]="z",He+""!="[object z]"&&B(Object.prototype,"toString",function(){return"[object "+Ke(this)+"]"},!0),Wt("asyncIterator"),Wt("observable");var Ge=(g.Symbol,{}),Qe={};O(Qe,et("iterator"),function(){return this});var ze=function(t,e,n){t.prototype=Jt(Qe,{next:D(1,n)}),Ft(t,e+" Iterator")},Xe=vt("IE_PROTO"),Ye=Object.prototype,Je=Object.getPrototypeOf||function(t){return t=G(t),x(t,Xe)?t[Xe]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ye:null},$e=et("iterator"),Ze=!([].keys&&"next"in[].keys()),tn=function(){return this},en=function(t,e,n,r,i,o,a){ze(n,e,r);var s,u,c,h=function(t){if(!Ze&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",f="values"==i,d=!1,p=t.prototype,m=p[$e]||p["@@iterator"]||i&&p[i],y=m||h(i),g=i?f?h("entries"):y:void 0,v="Array"==e?p.entries||m:m;if(v&&(c=Je(v.call(new t)))!==Object.prototype&&c.next&&(Ft(c,l,!0),"function"!=typeof c[$e]&&O(c,$e,tn)),f&&m&&"values"!==m.name&&(d=!0,y=function(){return m.call(this)}),(Ze||d||!p[$e])&&O(p,$e,y),Ge[e]=y,Ge[l]=tn,i)if(s={values:f?y:h("values"),keys:o?y:h("keys"),entries:g},a)for(u in s)u in p||B(p,u,s[u]);else q(q.P+q.F*(Ze||d),e,s);return s},nn=function(t){return function(e,n){var r,i,o=String(H(e)),a=X(n),s=o.length;return a<0||a>=s?t?"":void 0:(r=o.charCodeAt(a),r<55296||r>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?t?o.charAt(a):r:t?o.slice(a,a+2):i-56320+(r-55296<<10)+65536)}}(!0);en(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=nn(e,n),this._i+=t.length,{value:t,done:!1})});var rn=function(t,e){return{value:e,done:!!t}},on=en(Array,"Array",function(t,e){this._t=dt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,rn(1)):"keys"==e?rn(0,n):"values"==e?rn(0,t[n]):rn(0,[n,t[n]])},"values");Ge.Arguments=Ge.Array,ut("keys"),ut("values"),ut("entries");for(var an=et("iterator"),sn=et("toStringTag"),un=Ge.Array,cn={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},hn=It(cn),ln=0;ln<hn.length;ln++){var fn,dn=hn[ln],pn=cn[dn],mn=y[dn],yn=mn&&mn.prototype;if(yn&&(yn[an]||O(yn,an,un),yn[sn]||O(yn,sn,dn),Ge[dn]=un,pn))for(fn in on)yn[fn]||B(yn,fn,on[fn],!0)}qt.f("iterator")}).call(e,n(41).setImmediate,n(1))},function(t,e,n){"use strict";(function(t){function r(t,e){this._id=t,this._clearFn=e}var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(42),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||void 0,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||void 0}).call(e,n(1))},function(t,e,n){"use strict";(function(t,e){!function(t,n){function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return c[u]=r,s(u),u++}function i(t){delete c[t]}function o(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function a(t){if(h)setTimeout(a,0,t);else{var e=c[t];if(e){h=!0;try{o(e)}finally{i(t),h=!1}}}}if(!t.setImmediate){var s,u=1,c={},h=!1,l=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var t=l.documentElement;s=function(e){var n=l.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),f.setImmediate=r,f.clearImmediate=i}}("undefined"==typeof self?void 0===t?void 0:t:self)}).call(e,n(1),n(3))},function(t,e,n){"use strict";!function(t){function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return g.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader,n=a(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=a(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function h(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(g.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(g.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(g.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(g.arrayBuffer&&g.blob&&b(t))this._bodyArrayBuffer=h(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!g.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!w(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return E.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var n=e.body;if(t instanceof d){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function m(t){var e=new i;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function y(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var g={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(g.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(t){return t&&DataView.prototype.isPrototypeOf(t)},w=ArrayBuffer.isView||function(t){return t&&v.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,r){t=e(t),r=n(r);var i=this.map[t];this.map[t]=i?i+","+r:r},i.prototype.delete=function(t){delete this.map[e(t)]},i.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},i.prototype.set=function(t,r){this.map[e(t)]=n(r)},i.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},g.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},l.call(d.prototype),l.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var T=[301,302,303,307,308];y.redirect=function(t,e){if(-1===T.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=d,t.Response=y,t.fetch=function(t,e){return new Promise(function(n,r){var i=new d(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new y(e,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&g.blob&&(o.responseType="blob"),i.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:void 0)},function(t,e,n){"use strict";function r(t){return i(void 0,t)}function i(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&(t[r]=i(t[r],e[r]));return t}function o(t,e,n){t[e]=n}function a(t){var e=x;return x=t,e}function s(t){return JSON.parse(t)}function u(t){return JSON.stringify(t)}function c(t,e){var n=new ot(t,e);return n.subscribe.bind(n)}function h(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}function l(t,e){if("object"!==(void 0===t?"undefined":g(t))||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}function f(){}function d(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}function p(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(d(t,e,r)+"must be a valid firebase namespace.")}function m(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(d(t,e,r)+"must be a valid function.")}function y(t,e,n,r){if((!r||n)&&("object"!==(void 0===n?"undefined":g(n))||null===n))throw new Error(d(t,e,r)+"must be a valid context object.")}var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var v=n(11),b={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},w=function(t,e){if(!t)throw E(e)},E=function(t){return new Error("Firebase Database ("+b.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},T=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},I=function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var o=t[n++],a=t[n++],s=t[n++],u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{var o=t[n++],a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")},S={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(T(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):I(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length,s=a?n[t.charAt(i)]:0;++i;var u=i<t.length,c=u?n[t.charAt(i)]:64;++i;var h=i<t.length,l=h?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==c||null==l)throw Error();var f=o<<2|s>>4;if(r.push(f),64!=c){var d=s<<4&240|c>>2;if(r.push(d),64!=l){var p=c<<6&192|l;r.push(p)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},A=function(t){var e=T(t);return S.encodeByteArray(e,!0)},_=function(t){try{return S.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},k=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),N=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},C=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(N())},D=function(){return"object"===("undefined"==typeof navigator?"undefined":g(navigator))&&"ReactNative"===navigator.product},O=function(){return!0===b.NODE_CLIENT||!0===b.NODE_ADMIN},R="FirebaseError",x=Error.captureStackTrace,L=function(){function t(t,e){if(this.code=t,this.message=e,x)x(this,P.prototype.create);else try{throw Error.apply(this,arguments)}catch(t){this.name=R,Object.defineProperty(this,"stack",{get:function(){return t.stack}})}}return t}();L.prototype=Object.create(Error.prototype),L.prototype.constructor=L,L.prototype.name=R;var P=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new L(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}(),M=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=s(_(o[0])||""),n=s(_(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},B=function(t){var e,n,r=M(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"===(void 0===r?"undefined":g(r))&&(r.hasOwnProperty("nbf")?e=r.nbf:r.hasOwnProperty("iat")&&(e=r.iat),n=r.hasOwnProperty("exp")?r.exp:e+86400),i&&e&&n&&i>=e&&i<=n},U=function(t){var e=M(t).claims;return"object"===(void 0===e?"undefined":g(e))&&e.hasOwnProperty("iat")?e.iat:null},F=function(t){var e=M(t),n=e.claims;return!!e.signature&&!!n&&"object"===(void 0===n?"undefined":g(n))&&n.hasOwnProperty("iat")},V=function(t){var e=M(t).claims;return"object"===(void 0===e?"undefined":g(e))&&!0===e.admin},q=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},j=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},W=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},K=function(t,e){return W(e,function(e,n){t[e]=n}),t},H=function(t){return K({},t)},G=function(t){return"object"===(void 0===t?"undefined":g(t))&&null!==t},Q=function(t){for(var e in t)return!1;return!0},z=function(t){var e=0;for(var n in t)e++;return e},X=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},Y=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},J=function(t,e,n){var r=Y(t,e,n);return r&&t[r]},$=function(t){for(var e in t)return e},Z=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},tt=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},et=function(t){var e=[];return W(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},nt=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},rt=function(){function t(){this.blockSize=-1}return t}(),it=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return v.__extends(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(var r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4],r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);var i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(rt),ot=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=l(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=f),void 0===r.error&&(r.error=f),void 0===r.complete&&(r.complete=f);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}(),at=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},st=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,w(r<t.length,"Surrogate pair missing trail surrogate.");i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},ut=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};e.assert=w,e.assertionError=E,e.base64=S,e.base64Decode=_,e.base64Encode=A,e.CONSTANTS=b,e.deepCopy=r,e.deepExtend=i,e.patchProperty=o,e.Deferred=k,e.getUA=N,e.isMobileCordova=C,e.isNodeSdk=O,e.isReactNative=D,e.ErrorFactory=P,e.FirebaseError=L,e.patchCapture=a,e.jsonEval=s,e.stringify=u,e.decode=M,e.isAdmin=V,e.issuedAtTime=U,e.isValidFormat=F,e.isValidTimestamp=B,e.clone=H,e.contains=q,e.every=tt,e.extend=K,e.findKey=Y,e.findValue=J,e.forEach=W,e.getAnyKey=$,e.getCount=z,e.getValues=Z,e.isEmpty=Q,e.isNonNullObject=G,e.map=X,e.safeGet=j,e.querystring=et,e.querystringDecode=nt,e.Sha1=it,e.async=h,e.createSubscribe=c,e.errorPrefix=d,e.validateArgCount=at,e.validateCallback=m,e.validateContextObject=y,e.validateNamespace=p,e.stringLength=ut,e.stringToByteArray=st},function(t,e,n){"use strict";n(46)},function(t,e,n){"use strict";(function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){function t(t){return"string"==typeof t}function r(t){return"boolean"==typeof t}function i(){}function o(t){var n=void 0===t?"undefined":e(t);if("object"==n){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return n;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==n&&void 0===t.call)return"object";return n}function a(t){return null===t}function s(t){return"array"==o(t)}function u(t){var e=o(t);return"array"==e||"object"==e&&"number"==typeof t.length}function c(t){return"function"==o(t)}function h(t){var n=void 0===t?"undefined":e(t);return"object"==n&&null!=t||"function"==n}function l(t,e,n){return t.call.apply(t.bind,arguments)}function f(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function d(t,e,n){return d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:f,d.apply(null,arguments)}function p(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function m(t,e){function n(){}n.prototype=e.prototype,t.lb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.cd=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function y(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function g(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function v(t){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function b(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");v.call(this,n+t[r])}function w(t,e){throw new b("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function E(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function T(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function I(){this.b=this.a=null}function S(){var t=Yu,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function A(){this.next=this.b=this.a=null}function _(e,n){var r=e.length,i=t(e)?e.split(""):e;for(--r;0<=r;--r)r in i&&n.call(void 0,i[r],r,e)}function k(e){t:{for(var n=Gr,r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e)){n=o;break t}n=-1}return 0>n?null:t(e)?e.charAt(n):e[n]}function N(t,e){return 0<=Ru(t,e)}function C(t,e){e=Ru(t,e);var n;return(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function D(t,e){var n=0;_(t,function(r,i){e.call(void 0,r,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&n++})}function O(t){return Array.prototype.concat.apply([],arguments)}function R(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function x(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function L(t){return Wu.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(Bu,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Uu,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Fu,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Vu,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(qu,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ju,"&#0;")),t):t}function P(t,e){return-1!=t.indexOf(e)}function M(t,e){return t<e?-1:t>e?1:0}function B(t){return P(Ou,t)}function U(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function F(t){for(var e in t)return!1;return!0}function V(t){var e,n={};for(e in t)n[e]=t[e];return n}function q(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<zu.length;o++)n=zu[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function j(t){_u.setTimeout(function(){throw t},0)}function W(){var t=_u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!B("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=d(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!B("Trident")&&!B("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.tb;n.tb=null,t()}},function(t){r.next={tb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){_u.setTimeout(t,0)}}function K(t,e){Qu||H(),Xu||(Qu(),Xu=!0),Yu.add(t,e)}function H(){if(_u.Promise&&_u.Promise.resolve){var t=_u.Promise.resolve(void 0);Qu=function(){t.then(G)}}else Qu=function(){var t=G;!c(_u.setImmediate)||_u.Window&&_u.Window.prototype&&!B("Edge")&&_u.Window.prototype.setImmediate==_u.setImmediate?(Gu||(Gu=W()),Gu(t)):_u.setImmediate(t)}}function G(){for(var t;t=S();){try{t.a.call(t.b)}catch(t){j(t)}T(Du,t)}Xu=!1}function Q(t,e){if(this.a=Ju,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=i)try{var n=this;t.call(e,function(t){it(n,$u,t)},function(t){if(!(t instanceof ft))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}it(n,Zu,t)})}catch(t){it(this,Zu,t)}}function z(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function X(t,e,n){var r=tc.get();return r.g=t,r.b=e,r.f=n,r}function Y(t){if(t instanceof Q)return t;var e=new Q(i);return it(e,$u,t),e}function J(t){return new Q(function(e,n){n(t)})}function $(t,e,n){ot(t,e,n,null)||K(p(e,t))}function Z(t){return new Q(function(e,n){var r=t.length,i=[];if(r)for(var o,a=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],$(o,p(a,u),s);else e(i)})}function tt(t){return new Q(function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Zb:!0,value:o}:{Zb:!1,reason:o},0==n&&e(r)},a=0;a<t.length;a++)i=t[a],$(i,p(o,a,!0),p(o,a,!1));else e(r)})}function et(t,e){if(t.a==Ju)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Ju&&1==r?et(n,e):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):ut(n),ct(n,i,Zu,e)))}t.c=null}else it(t,Zu,e)}function nt(t,e){t.b||t.a!=$u&&t.a!=Zu||st(t),t.f?t.f.next=e:t.b=e,t.f=e}function rt(t,e,n,r){var i=X(null,null,null);return i.a=new Q(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof ft?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,nt(t,i),i.a}function it(t,e,n){t.a==Ju&&(t===n&&(e=Zu,n=new TypeError("Promise cannot resolve to itself")),t.a=1,ot(n,t.Lc,t.Mc,t)||(t.i=n,t.a=e,t.c=null,st(t),e!=Zu||n instanceof ft||lt(t,n)))}function ot(t,e,n,r){if(t instanceof Q)return nt(t,X(e||i,n||null,r)),!0;if(g(t))return t.then(e,n,r),!0;if(h(t))try{var o=t.then;if(c(o))return at(t,o,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function at(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(t){o(t)}}function st(t){t.h||(t.h=!0,K(t.Ub,t))}function ut(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ct(t,e,n,r){if(n==Zu&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ht(e,n,r);else try{e.c?e.g.call(e.f):ht(e,n,r)}catch(t){ec.call(null,t)}T(tc,e)}function ht(t,e,n){e==$u?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function lt(t,e){t.g=!0,K(function(){t.g&&ec.call(null,e)})}function ft(t){v.call(this,t)}function dt(){0!=nc&&(rc[this[ku]||(this[ku]=++Nu)]=this),this.pa=this.pa,this.ja=this.ja}function pt(t){if(!t.pa&&(t.pa=!0,t.ua(),0!=nc)){var e=t[ku]||(t[ku]=++Nu);if(0!=nc&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete rc[e]}}function mt(t){return mt[" "](t),t}function yt(t,e){var n=mc;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function gt(){var t=_u.document;return t?t.documentMode:void 0}function vt(t){return yt(t,function(){for(var e=0,n=Mu(String(ic)).split("."),r=Mu(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=M(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||M(0==a[2].length,0==s[2].length)||M(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function bt(t,e){this.type=t,this.b=this.target=e,this.Gb=!0}function wt(e,n){if(bt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var r=this.type=e.type,i=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=n,n=e.relatedTarget){if(cc){t:{try{mt(n.nodeName);var o=!0;break t}catch(t){}o=!1}o||(n=null)}}else"mouseover"==r?n=e.fromElement:"mouseout"==r&&(n=e.toElement);this.relatedTarget=n,null===i?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=t(e.pointerType)?e.pointerType:Ec[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}function Et(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++Ic,this.na=this.Ia=!1}function Tt(t){t.na=!0,t.listener=null,t.proxy=null,t.src=null,t.La=null}function It(t){this.src=t,this.a={},this.b=0}function St(t,e){var n=e.type;n in t.a&&C(t.a[n],e)&&(Tt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.na&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}function _t(t,e,n,r,i){if(r&&r.once)Ct(t,e,n,r,i);else if(s(e))for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);else n=Bt(n),t&&t[Tc]?Ft(t,e,n,h(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=h(i)?!!i.capture:!!i,s=Mt(t);if(s||(t[Sc]=s=new It(t)),n=s.add(e,n,r,a,o),!n.proxy){if(r=Nt(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)wc||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}_c++}}function Nt(){var t=Pt,e=vc?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function Ct(t,e,n,r,i){if(s(e))for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);else n=Bt(n),t&&t[Tc]?Vt(t,e,n,h(r)?!!r.capture:!!r,i):kt(t,e,n,!0,r,i)}function Dt(t,e,n,r,i){if(s(e))for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);else r=h(r)?!!r.capture:!!r,n=Bt(n),t&&t[Tc]?(t=t.m,(e=String(e).toString())in t.a&&(o=t.a[e],-1<(n=At(o,n,r,i))&&(Tt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Mt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=At(e,n,r,i)),(n=-1<t?e[t]:null)&&Ot(n))}function Ot(t){if("number"!=typeof t&&t&&!t.na){var e=t.src;if(e&&e[Tc])St(e.m,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),_c--,(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[Sc]=null)):Tt(t)}}}function Rt(t){return t in Ac?Ac[t]:Ac[t]="on"+t}function xt(t,e,n,r){var i=!0;if((t=Mt(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.na&&(o=Lt(o,r),i=i&&!1!==o)}return i}function Lt(t,e){var n=t.listener,r=t.La||t.src;return t.Ia&&Ot(t),n.call(r,e)}function Pt(t,e){if(t.na)return!0;if(!vc){if(!e)t:{e=["window","event"];for(var n=_u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new wt(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=xt(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=xt(r[i],t,!1,e),n=n&&o}return n}return Lt(t,new wt(e,this))}function Mt(t){return t=t[Sc],t instanceof It?t:null}function Bt(t){return c(t)?t:(t[kc]||(t[kc]=function(e){return t.handleEvent(e)}),t[kc])}function Ut(){dt.call(this),this.m=new It(this),this.Nb=this,this.Ua=null}function Ft(t,e,n,r,i){t.m.add(String(e),n,!1,r,i)}function Vt(t,e,n,r,i){t.m.add(String(e),n,!0,r,i)}function qt(t,e,n,r){if(!(e=t.m.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.na&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&St(t.m,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Gb}function jt(t,e,n){if(c(t))n&&(t=d(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=d(t.handleEvent,t)}return 2147483647<Number(e)?-1:_u.setTimeout(t,e||0)}function Wt(t){var e=null;return new Q(function(n,r){-1==(e=jt(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw _u.clearTimeout(e),t})}function Kt(e){if(e.S&&"function"==typeof e.S)return e.S();if(t(e))return e.split("");if(u(e)){for(var n=[],r=e.length,i=0;i<r;i++)n.push(e[i]);return n}n=[],r=0;for(i in e)n[r++]=e[i];return n}function Ht(e){if(e.U&&"function"==typeof e.U)return e.U();if(!e.S||"function"!=typeof e.S){if(u(e)||t(e)){var n=[];e=e.length;for(var r=0;r<e;r++)n.push(r);return n}n=[],r=0;for(var i in e)n[r++]=i;return n}}function Gt(e,n){if(e.forEach&&"function"==typeof e.forEach)e.forEach(n,void 0);else if(u(e)||t(e))xu(e,n,void 0);else for(var r=Ht(e),i=Kt(e),o=i.length,a=0;a<o;a++)n.call(void 0,i[a],r&&r[a],e)}function Qt(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qt)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function zt(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xt(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Xt(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Yt(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Jt(t,e){if(this.b=this.m=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof Jt){this.f=void 0!==e?e:t.f,$t(this,t.c),this.m=t.m,this.b=t.b,Zt(this,t.i),this.g=t.g,e=t.a;var n=new ue;n.c=e.c,e.a&&(n.a=new Qt(e.a),n.b=e.b),te(this,n),this.h=t.h}else t&&(n=String(t).match(Nc))?(this.f=!!e,$t(this,n[1]||"",!0),this.m=oe(n[2]||""),this.b=oe(n[3]||"",!0),Zt(this,n[4]),this.g=oe(n[5]||"",!0),te(this,n[6]||"",!0),this.h=oe(n[7]||"")):(this.f=!!e,this.a=new ue(null,this.f))}function $t(t,e,n){t.c=n?oe(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Zt(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function te(t,e,n){e instanceof ue?(t.a=e,me(t.a,t.f)):(n||(e=ae(e,Rc)),t.a=new ue(e,t.f))}function ee(t,e,n){t.a.set(e,n)}function ne(t,e){return t.a.get(e)}function re(t){return t instanceof Jt?new Jt(t):new Jt(t,void 0)}function ie(t,e){var n=new Jt(null,void 0);return $t(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function oe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ae(e,n,r){return t(e)?(e=encodeURI(e).replace(n,se),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function se(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function ue(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ce(t){t.a||(t.a=new Qt,t.b=0,t.c&&Yt(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function he(t){var e=Ht(t);if(void 0===e)throw Error("Keys are undefined");var n=new ue(null,void 0);t=Kt(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];s(o)?de(n,i,o):n.add(i,o)}return n}function le(t,e){ce(t),e=pe(t,e),Xt(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Xt(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&zt(t)))}function fe(t,e){return ce(t),e=pe(t,e),Xt(t.a.b,e)}function de(t,e,n){le(t,e),0<n.length&&(t.c=null,t.a.set(pe(t,e),R(n)),t.b+=n.length)}function pe(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function me(t,e){e&&!t.f&&(ce(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(le(this,e),de(this,n,t))},t)),t.f=e}function ye(){this.a="",this.b=Pc}function ge(t){return t instanceof ye&&t.constructor===ye&&t.b===Pc?t.a:(w("expected object of type Const, got '"+t+"'"),"type_error:Const")}function ve(t){var e=new ye;return e.a=t,e}function be(){this.a="",this.b=Uc}function we(t){return t instanceof be&&t.constructor===be&&t.b===Uc?t.a:(w("expected object of type TrustedResourceUrl, got '"+t+"' of type "+o(t)),"type_error:TrustedResourceUrl")}function Ee(t,e){var n=ge(t);if(!Bc.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Mc,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[r],t instanceof ye?ge(t):encodeURIComponent(String(t))}),Te(t)}function Te(t){var e=new be;return e.a=t,e}function Ie(){this.a="",this.b=Vc}function Se(t){return t instanceof Ie&&t.constructor===Ie&&t.b===Vc?t.a:(w("expected object of type SafeUrl, got '"+t+"' of type "+o(t)),"type_error:SafeUrl")}function Ae(t){return t instanceof Ie?t:(t=t.ma?t.la():String(t),Fc.test(t)||(t="about:invalid#zClosurez"),_e(t))}function _e(t){var e=new Ie;return e.a=t,e}function ke(){this.a="",this.b=qc}function Ne(t){return t instanceof ke&&t.constructor===ke&&t.b===qc?t.a:(w("expected object of type SafeHtml, got '"+t+"' of type "+o(t)),"type_error:SafeHtml")}function Ce(t){var e=new ke;return e.a=t,e}function De(e){var n=document;return t(e)?n.getElementById(e):e}function Oe(t,e){U(e,function(e,n){e&&e.ma&&(e=e.la()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:jc.hasOwnProperty(n)?t.setAttribute(jc[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}function Re(e,n,r){var i=arguments,o=document,a=String(i[0]),u=i[1];if(!Lc&&u&&(u.name||u.type)){if(a=["<",a],u.name&&a.push(' name="',L(u.name),'"'),u.type){a.push(' type="',L(u.type),'"');var c={};q(c,u),delete c.type,u=c}a.push(">"),a=a.join("")}return a=o.createElement(a),u&&(t(u)?a.className=u:s(u)?a.className=u.join(" "):Oe(a,u)),2<i.length&&xe(o,a,i),a}function xe(e,n,r){function i(r){r&&n.appendChild(t(r)?e.createTextNode(r):r)}for(var o=2;o<r.length;o++){var a=r[o];!u(a)||h(a)&&0<a.nodeType?i(a):xu(Le(a)?R(a):a,i)}}function Le(t){if(t&&"number"==typeof t.length){if(h(t))return"function"==typeof t.item||"string"==typeof t.item;if(c(t))return"function"==typeof t.item}return!1}function Pe(t){var e=[];return Be(new Me,t,e),e.join("")}function Me(){}function Be(t,n,r){if(null==n)r.push("null");else{if("object"==(void 0===n?"undefined":e(n))){if(s(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),Be(t,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){r.push("{"),o="";for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Ue(i,r),r.push(":"),Be(t,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(void 0===n?"undefined":e(n)){case"string":Ue(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+(void 0===n?"undefined":e(n)))}}}function Ue(t,e){e.push('"',t.replace(Kc,function(t){var e=Wc[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Wc[t]=e),e}),'"')}function Fe(){var t=on();return ac&&!!pc&&11==pc||/Edge\/\d+/.test(t)}function Ve(){return _u.window&&_u.window.location.href||self&&self.location&&self.location.href||""}function qe(t,e){e=e||_u.window;var n="about:blank";t&&(n=Se(Ae(t))),e.location.href=n}function je(t,n){var r,i=[];for(r in t)r in n?e(t[r])!=e(n[r])?i.push(r):"object"==e(t[r])&&null!=t[r]&&null!=n[r]?0<je(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}function We(){var t=on();return!((t=nn(t)!=Qc?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!ac||!pc||9<pc)}function Ke(t){return t=(t||on()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function He(t){t=t||_u.window;try{t.close()}catch(t){}}function Ge(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=on().toLowerCase(),r&&(e.target=r,P(n,"crios/")&&(e.target="_blank")),nn(on())==Gc&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Ie?n:Ae(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[];for(a in t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((B("iPhone")&&!B("iPod")&&!B("iPad")||B("iPad")||B("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),e instanceof Ie||e instanceof Ie||(e=e.ma?e.la():String(e),Fc.test(e)||(e="about:invalid#zClosurez"),e=_e(e)),a.href=Se(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=Se(e),a&&(uc&&P(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,ve("b/12014412, meta tag with sanitized URL"),t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+L(t)+'">',t=Ce(t),a.document.write(Ne(t)),a.document.close())):(a=r.open(Se(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}function Qe(t){return new Q(function(e){function n(){Wt(2e3).then(function(){if(t&&!t.closed)return n();e()})}return n()})}function ze(){var t=null;return new Q(function(e){"complete"==_u.document.readyState?e():(t=function(){e()},Ct(window,"load",t))}).s(function(e){throw Dt(window,"load",t),e})}function Xe(){return Ye(void 0)?ze().then(function(){return new Q(function(t,e){var n=_u.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):J(Error("Cordova must run in an Android or iOS file scheme."))}function Ye(t){return t=t||on(),!("file:"!==hn()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Je(){var t=_u.window;try{return!(!t||t==t.top)}catch(t){return!1}}function $e(){return"object"!==e(_u.window)&&"function"==typeof _u.importScripts}function Ze(){return Su.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Su.INTERNAL.hasOwnProperty("node")?"Node":$e()?"Worker":"Browser"}function tn(){var t=Ze();return"ReactNative"===t||"Node"===t}function en(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function nn(t){var e=t.toLowerCase();return P(e,"opera/")||P(e,"opr/")||P(e,"opios/")?"Opera":P(e,"iemobile")?"IEMobile":P(e,"msie")||P(e,"trident/")?"IE":P(e,"edge/")?"Edge":P(e,"firefox/")?Gc:P(e,"silk/")?"Silk":P(e,"blackberry")?"Blackberry":P(e,"webos")?"Webos":!P(e,"safari/")||P(e,"chrome/")||P(e,"crios/")||P(e,"android")?!P(e,"chrome/")&&!P(e,"crios/")||P(e,"edge/")?P(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Qc:"Safari"}function rn(t,e){e=e||[];var n,r=[],i={};for(n in zc)i[zc[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),e=r,e.length||(e=["FirebaseCore-web"]),r=Ze(),"Browser"===r?(i=on(),r=nn(i)):"Worker"===r&&(i=on(),r=nn(i)+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function on(){return _u.navigator&&_u.navigator.userAgent||""}function an(t,n){t=t.split("."),n=n||_u;for(var r=0;r<t.length&&"object"==(void 0===n?"undefined":e(n))&&null!=n;r++)n=n[t[r]];return r!=t.length&&(n=void 0),n}function sn(){try{var t=_u.localStorage,e=mn();if(t)return t.setItem(e,"1"),t.removeItem(e),!Fe()||!!_u.indexedDB}catch(t){return $e()&&!!_u.indexedDB}return!1}function un(){return(cn()||"chrome-extension:"===hn()||Ye())&&!tn()&&sn()&&!$e()}function cn(){return"http:"===hn()||"https:"===hn()}function hn(){return _u.location&&_u.location.protocol||null}function ln(t){return t=t||on(),!Ke(t)&&nn(t)!=Gc}function fn(t){return void 0===t?null:Pe(t)}function dn(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function pn(t){if(null!==t)return JSON.parse(t)}function mn(t){return t||Math.floor(1e9*Math.random()).toString()}function yn(t){return t=t||on(),"Safari"!=nn(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function gn(){var t=_u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function vn(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=on(),e=Ze(),this.b=Ke(t)||"ReactNative"===e}function bn(){var t=_u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function wn(){var t=_u.document,e=null;return bn()||!t?Y():new Q(function(n){e=function(){bn()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}function En(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Tn(){return!(!an("fireauth.oauthhelper",_u)&&!an("fireauth.iframe",_u))}function In(t){Yc[t]||(Yc[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}function Sn(t,e,n){Xc?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function An(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Sn(t,n,e[n])}function _n(t){var e={};return An(e,t),e}function kn(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function Nn(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}function Cn(t){var n=t;if("object"==(void 0===t?"undefined":e(t))&&null!=t){n="length"in t?[]:{};for(var r in t)Sn(n,r,Cn(t[r]))}return n}function Dn(t){var e={},n=t[Zc],r=t[th];if(!(t=t[eh])||t!=$c&&!n)throw Error("Invalid provider user info!");e[rh]=r||null,e[nh]=n||null,Sn(this,oh,t),Sn(this,ih,Cn(e))}function On(t,e){this.code=ah+t,this.message=e||sh[t]||""}function Rn(t){var e=t&&t.code;return e?new On(e.substring(ah.length),t.message):null}function xn(t){var n=t[lh];if(void 0===n)throw new On("missing-continue-uri");if("string"!=typeof n||"string"==typeof n&&!n.length)throw new On("invalid-continue-uri");this.h=n,this.b=this.a=null,this.g=!1;var r=t[uh];if(r&&"object"===(void 0===r?"undefined":e(r))){n=r[ph];var i=r[fh];if(r=r[dh],"string"==typeof n&&n.length){if(this.a=n,void 0!==i&&"boolean"!=typeof i)throw new On("argument-error",fh+" property must be a boolean when specified.");if(this.g=!!i,void 0!==r&&("string"!=typeof r||"string"==typeof r&&!r.length))throw new On("argument-error",dh+" property must be a non empty string when specified.");this.b=r||null}else{if(void 0!==n)throw new On("argument-error",ph+" property must be a non empty string when specified.");if(void 0!==i||void 0!==r)throw new On("missing-android-pkg-name")}}else if(void 0!==r)throw new On("argument-error",uh+" property must be a non null object when specified.");if(this.f=null,(n=t[hh])&&"object"===(void 0===n?"undefined":e(n))){if("string"==typeof(n=n[mh])&&n.length)this.f=n;else if(void 0!==n)throw new On("argument-error",mh+" property must be a non empty string when specified.")}else if(void 0!==n)throw new On("argument-error",hh+" property must be a non null object when specified.");if(void 0!==(t=t[ch])&&"boolean"!=typeof t)throw new On("argument-error",ch+" property must be a boolean when specified.");this.c=!!t}function Ln(t){var e={};e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f;for(var n in e)null===e[n]&&delete e[n];return e}function Pn(t){return Lu(t,function(t){return t=t.toString(16),1<t.length?t:"0"+t}).join("")}function Mn(t){var e="";return Bn(t,function(t){e+=String.fromCharCode(t)}),e}function Bn(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=gh[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}Un();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}function Un(){if(!yh){yh={},gh={};for(var t=0;65>t;t++)yh[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),gh[yh[t]]=t,62<=t&&(gh["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}function Fn(t){this.c=t.sub,Cu(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Vn(t){return(t=qn(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Fn(t):null}function qn(t){if(!t)return null;if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Mn(t))}catch(t){}return null}function jn(t){for(var e in wh)if(wh[e].Na==t)return wh[e];return null}function Wn(t){var e={};e["facebook.com"]=Gn,e["google.com"]=zn,e["github.com"]=Qn,e["twitter.com"]=Xn;var n=t&&t[Th];try{if(n)return e[n]?new e[n](t):new Hn(t);if(void 0!==t[Eh])return new Kn(t)}catch(t){}return null}function Kn(t){var e=t[Th];if(!e&&t[Eh]){var n=Vn(t[Eh]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Sn(this,"providerId",e),Sn(this,"isNewUser",n)}function Hn(t){Kn.call(this,t),t=pn(t.rawUserInfo||"{}"),Sn(this,"profile",Cn(t||{}))}function Gn(t){if(Hn.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qn(t){if(Hn.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Sn(this,"username",this.profile&&this.profile.login||null)}function zn(t){if(Hn.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Xn(t){if(Hn.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Sn(this,"username",t.screenName||null)}function Yn(t){this.a=re(t)}function Jn(t){var e=re(t),n=ne(e,"link"),r=ne(re(n),"link");return e=ne(e,"deep_link_id"),ne(re(e),"link")||e||r||n||t}function $n(t,e){return t.then(function(t){if(t[qh]){var n=Vn(t[qh]);if(!n||e!=n.c)throw new On("user-mismatch");return t}throw new On("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==ah+"user-not-found"?new On("user-mismatch"):t})}function Zn(t,e,n){if(e.idToken||e.accessToken)e.idToken&&Sn(this,"idToken",e.idToken),e.accessToken&&Sn(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new On("internal-error","failed to construct a credential");Sn(this,"accessToken",e.oauthToken),Sn(this,"secret",e.oauthTokenSecret)}Sn(this,"providerId",t),Sn(this,"signInMethod",n)}function tr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:he(e).toString(),requestUri:"http://localhost"}}function er(t,e){this.Ac=e||[],An(this,{providerId:t,isOAuthProvider:!0}),this.vb={},this.$a=(jn(t)||{}).Ma||null,this.Ya=null}function nr(t){er.call(this,t,bh),this.a=[]}function rr(){nr.call(this,"facebook.com")}function ir(t){if(!t)throw new On("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return h(t)&&(e=t.accessToken),(new rr).credential(null,e)}function or(){nr.call(this,"github.com")}function ar(t){if(!t)throw new On("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return h(t)&&(e=t.accessToken),(new or).credential(null,e)}function sr(){nr.call(this,"google.com"),this.ta("profile")}function ur(t,e){var n=t;return h(t)&&(n=t.idToken,e=t.accessToken),(new sr).credential(n,e)}function cr(){er.call(this,"twitter.com",vh)}function hr(t,e){var n=t;if(h(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new On("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Zn("twitter.com",n,"twitter.com")}function lr(t,e,n){this.a=t,this.b=e,Sn(this,"providerId","password"),Sn(this,"signInMethod",n===fr.EMAIL_LINK_SIGN_IN_METHOD?fr.EMAIL_LINK_SIGN_IN_METHOD:fr.EMAIL_PASSWORD_SIGN_IN_METHOD)}function fr(){An(this,{providerId:"password",isOAuthProvider:!1})}function dr(t,e){if(!(e=pr(e)))throw new On("argument-error","Invalid email link!");return new lr(t,e,fr.EMAIL_LINK_SIGN_IN_METHOD)}function pr(t){t=Jn(t),t=new Yn(t);var e=ne(t.a,"oobCode")||null;return"signIn"===(ne(t.a,"mode")||null)&&e?e:null}function mr(t){if(!(t.Sa&&t.Ra||t.Fa&&t.$))throw new On("internal-error");this.a=t,Sn(this,"providerId","phone"),Sn(this,"signInMethod","phone")}function yr(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Sa,code:t.a.Ra}}function gr(t){try{this.a=t||Su.auth()}catch(t){throw new On("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}An(this,{providerId:"phone",isOAuthProvider:!1})}function vr(t,e){if(!t)throw new On("missing-verification-id");if(!e)throw new On("missing-verification-code");return new mr({Sa:t,Ra:e})}function br(t){if(t.temporaryProof&&t.phoneNumber)return new mr({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return ur(t,n);case"facebook.com":return ir(n);case"github.com":return ar(n);case"twitter.com":return hr(n,r);default:return new nr(e).credential(t,n)}}catch(t){return null}}function wr(t){if(!t.isOAuthProvider)throw new On("invalid-oauth-provider")}function Er(t,e,n,r,i){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new On("invalid-auth-event");if(this.f&&this.a)throw new On("invalid-auth-event");if(this.f&&!this.g)throw new On("invalid-auth-event")}function Tr(t){return t=t||{},t.type?new Er(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Rn(t.error)):null}function Ir(){this.b=null,this.a=[]}function Sr(t){var e="unauthorized-domain",n=void 0,r=re(t);t=r.b,r=r.c,"chrome-extension"==r?n=x("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=x("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",On.call(this,e,n)}function Ar(t,e,n){On.call(this,t,n),t=e||{},t.wb&&Sn(this,"email",t.wb),t.$&&Sn(this,"phoneNumber",t.$),t.credential&&Sn(this,"credential",t.credential)}function _r(t){if(t.code){var e=t.code||"";0==e.indexOf(ah)&&(e=e.substring(ah.length));var n={credential:br(t)};if(t.email)n.wb=t.email;else{if(!t.phoneNumber)return new On(e,t.message||void 0);n.$=t.phoneNumber}return new Ar(e,n,t.message)}return null}function kr(){}function Nr(t){return t.c||(t.c=t.b())}function Cr(){}function Dr(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Or(){}function Rr(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=d(this.bc,this),this.a.onerror=d(this.Bb,this),this.a.onprogress=d(this.cc,this),this.a.ontimeout=d(this.fc,this)}function xr(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Lr(t,e,n){this.reset(t,e,n,void 0,void 0)}function Pr(t){this.f=t,this.b=this.c=this.a=null}function Mr(t,e){this.name=t,this.value=e}function Br(t){return t.c?t.c:t.a?Br(t.a):(w("Root logger has no level set."),null)}function Ur(t){Rh||(Rh=new Pr(""),Oh[""]=Rh,Rh.c=Ch);var e;if(!(e=Oh[t])){e=new Pr(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=Ur(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,Oh[t]=e}return e}function Fr(t,e){t&&t.log(Dh,e,void 0)}function Vr(t){this.f=t}function qr(t){Ut.call(this),this.i=t,this.readyState=xh,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=Ur("goog.net.FetchXmlHttp")}function jr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Wr(t){Ut.call(this),this.headers=new Qt,this.C=t||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Lh,this.v=this.O=!1}function Kr(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.N=n,t.G=!1,t.c=!0,t.a=t.C?t.C.a():Ah.a(),t.w=Nr(t.C?t.C:Ah),t.a.onreadystatechange=d(t.Fb,t);try{Fr(t.b,ei(t,"Opening Xhr")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(e){return Fr(t.b,ei(t,"Error opening Xhr: "+e.message)),void Qr(t,e)}e=r||"";var o=new Qt(t.headers);i&&Gt(i,function(t,e){o.set(e,t)}),i=k(o.U()),r=_u.FormData&&e instanceof _u.FormData,!N(Mh,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Jr(t),0<t.g&&(t.v=Hr(t.a),Fr(t.b,ei(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=d(t.Ga,t)):t.u=jt(t.Ga,t.g,t)),Fr(t.b,ei(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Fr(t.b,ei(t,"Send error: "+e.message)),Qr(t,e)}}function Hr(t){return ac&&vt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Gr(t){return"content-type"==t.toLowerCase()}function Qr(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,zr(t),Yr(t)}function zr(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Xr(t){if(t.c&&void 0!==Au)if(t.w[1]&&4==$r(t)&&2==Zr(t))Fr(t.b,ei(t,"Local request error detected and ignored"));else if(t.i&&4==$r(t))jt(t.Fb,0,t);else if(t.dispatchEvent("readystatechange"),4==$r(t)){Fr(t.b,ei(t,"Request complete")),t.c=!1;try{var e=Zr(t);t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.l).match(Nc)[1]||null;if(!o&&_u.self&&_u.self.location){var a=_u.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ph.test(o?o.toLowerCase():"")}r=i}if(r)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var s=2<$r(t)?t.a.statusText:""}catch(e){Fr(t.b,"Can not get status: "+e.message),s=""}t.h=s+" ["+Zr(t)+"]",zr(t)}}finally{Yr(t)}}}function Yr(t,e){if(t.a){Jr(t);var n=t.a,r=t.w[0]?i:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(kh,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Jr(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(_u.clearTimeout(t.u),t.u=null)}function $r(t){return t.a?t.a.readyState:0}function Zr(t){try{return 2<$r(t)?t.a.status:-1}catch(t){return-1}}function ti(t){try{return t.a?t.a.responseText:""}catch(e){return Fr(t.b,"Can not get responseText: "+e.message),""}}function ei(t,e){return e+" ["+t.N+" "+t.l+" "+Zr(t)+"]"}function ni(t,e){this.g=[],this.v=t,this.u=e||null,this.f=this.a=!1,this.c=void 0,this.l=this.w=this.i=!1,this.h=0,this.b=null,this.m=0}function ri(t,e,n){t.a=!0,t.c=n,t.f=!e,ui(t)}function ii(t){if(t.a){if(!t.l)throw new ci(t);t.l=!1}}function oi(t,e){ai(t,null,e,void 0)}function ai(t,e,n,r){t.g.push([e,n,r]),t.a&&ui(t)}function si(t){return Pu(t.g,function(t){return c(t[1])})}function ui(t){if(t.h&&t.a&&si(t)){var e=t.h,n=Bh[e];n&&(_u.clearTimeout(n.a),delete Bh[e]),t.h=0}t.b&&(t.b.m--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.u,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(g(e)||"function"==typeof _u.Promise&&e instanceof _u.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,si(t)||(n=!0)}}t.c=e,r&&(s=d(t.o,t,!0),r=d(t.o,t,!1),e instanceof ni?(ai(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new li(e),Bh[e.a]=e,t.h=e.a)}function ci(){v.call(this)}function hi(){v.call(this)}function li(t){this.a=_u.setTimeout(d(this.c,this),0),this.b=t}function fi(t){var e={},n=e.document||document,r=we(t),i=document.createElement("SCRIPT"),o={Hb:i,Ga:void 0},a=new ni(pi,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){mi(i,!0);var t=new yi(Fh,"Timeout reached for loading script "+r);ii(a),ri(a,!1,t)},u),o.Ga=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(mi(i,e.dd||!1,s),a.C())},i.onerror=function(){mi(i,!0,s);var t=new yi(Uh,"Error while loading script "+r);ii(a),ri(a,!1,t)},o=e.attributes||{},q(o,{type:"text/javascript",charset:"UTF-8"}),Oe(i,o),i.src=we(t),di(n).appendChild(i),a}function di(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}function pi(){if(this&&this.Hb){var t=this.Hb;t&&"SCRIPT"==t.tagName&&mi(t,!0,this.Ga)}}function mi(t,e,n){null!=n&&_u.clearTimeout(n),t.onload=i,t.onerror=i,t.onreadystatechange=i,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}function yi(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),v.call(this,n),this.code=t}function gi(t){this.f=t}function vi(t,e,n){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||jh,this.f=V(t.secureTokenHeaders||Wh),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||Kh,this.a=V(t.firebaseHeaders||Hh),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==Ze(),!(n=_u.XMLHttpRequest||n&&Su.INTERNAL.node&&Su.INTERNAL.node.XMLHttpRequest)&&!$e())throw new On("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,$e()?this.c=new Vr(self):tn()?this.c=new gi(n):this.c=new Or}function bi(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function wi(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function Ei(t,e,n,r,i,o,a){We()||$e()?t=d(t.o,t):(Vh||(Vh=new Q(function(t,e){Ti(t,e)})),t=d(t.l,t)),t(e,n,r,i,o,a)}function Ti(t,e){if(((window.gapi||{}).client||{}).request)t();else{_u[Qh]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};oi(fi(Ee(Gh,{onload:Qh})),function(){e(Error("CORS_UNSUPPORTED"))})}}function Ii(t,e){return new Q(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ei(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(ji(t)):t.access_token&&t.refresh_token?n(t):r(new On("internal-error")):r(new On("network-request-failed"))},"POST",he(e).toString(),t.f,t.m.get()):r(new On("internal-error"))})}function Si(t,e,n,r,i,o){var a=re(t.g+e);ee(a,"key",t.b),o&&ee(a,"cb",Cu().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&ee(a,u,r[u]);return new Q(function(e,o){Ei(t,a.toString(),function(t){t?t.error?o(ji(t,i||{})):e(t):o(new On("network-request-failed"))},n,s?void 0:Pe(dn(r)),t.a,t.h.get())})}function Ai(t){if(!Sh.test(t.email))throw new On("invalid-email")}function _i(t){"email"in t&&Ai(t)}function ki(t,e){return Vi(t,Zh,{identifier:e,continueUri:cn()?Ve():"http://localhost"}).then(function(t){return t.allProviders||[]})}function Ni(t,e){return Vi(t,Zh,{identifier:e,continueUri:cn()?Ve():"http://localhost"}).then(function(t){return t.signinMethods||[]})}function Ci(t){return Vi(t,ul,{}).then(function(t){return t.authorizedDomains||[]})}function Di(t){if(!t[qh])throw new On("internal-error")}function Oi(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new On("internal-error")}else{if(!t.sessionInfo)throw new On("missing-verification-id");if(!t.code)throw new On("missing-verification-code")}}function Ri(t,e){return Vi(t,ll,e)}function xi(t,e,n){return Vi(t,el,{idToken:e,deleteProvider:n})}function Li(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new On("internal-error")}function Pi(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=_r(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=_r(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=_r(t)):t.errorMessage&&(e=qi(t.errorMessage)),e)throw e;if(!t[qh])throw new On("internal-error")}function Mi(t,e){return e.returnIdpCredential=!0,Vi(t,ml,e)}function Bi(t,e){return e.returnIdpCredential=!0,Vi(t,gl,e)}function Ui(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Vi(t,yl,e)}function Fi(t){if(!t.oobCode)throw new On("invalid-action-code")}function Vi(t,e,n){if(!Nn(n,e.T))return J(new On("internal-error"));var r,i=e.Eb||"POST";return Y(n).then(e.B).then(function(){return e.R&&(n.returnSecureToken=!0),Si(t,e.endpoint,i,n,e.Tb,e.rb||!1)}).then(function(t){return r=t}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new On("internal-error");return r[e.da]})}function qi(t){return ji({error:{errors:[{message:t}],code:400,message:t}})}function ji(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new On(r[n]):null)return n;n=t.error&&t.error.message||"",r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},q(r,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0;for(var i in r)if(0===n.indexOf(i))return new On(r[i],e);return!e&&t&&(e=fn(t)),new On("internal-error",e)}function Wi(t){for(var e in Il)if(Il[e].id===t)return t=Il[e],{firebaseEndpoint:t.Za,secureTokenEndpoint:t.fb};return null}function Ki(t){this.b=t,this.a=null,this.bb=Hi(this)}function Hi(t){return zi().then(function(){return new Q(function(e,n){an("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:an("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},_l.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}function Gi(t,e){return t.bb.then(function(){return new Q(function(n){t.a.send(e.type,e,n,an("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function Qi(t,e){t.bb.then(function(){t.a.register("authEvent",e,an("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}function zi(){return kl||(kl=new Q(function(t,e){function n(){gn(),an("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){gn(),e(Error("Network Error"))},timeout:Al.get()})}if(an("gapi.iframes.Iframe"))t();else if(an("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();_u[r]=function(){an("gapi.load")?n():e(Error("Network Error"))},r=Ee(Sl,{onload:r}),Y(fi(r)).s(function(){e(Error("Network Error"))})}}).s(function(t){throw kl=null,t}))}function Xi(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=ie(this.i,"/__/auth/iframe"),ee(this.a,"apiKey",this.g),ee(this.a,"appName",this.h),this.b=null,this.c=[]}function Yi(t,e,n,r,i){this.o=t,this.l=e,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ji(t){try{return Su.app(t).auth().xa()}catch(t){return[]}}function $i(t,e,n,r,i){this.l=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Zi(t){var e=Ve();return Ci(t).then(function(t){t:{var n=re(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=re(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Hc.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Sr(Ve())})}function to(t){return t.m?t.m:(t.m=ze().then(function(){if(!t.u){var e=t.c,n=t.h,r=Ji(t.b),i=new Xi(t.l,t.f,t.b);i.f=e,i.b=n,i.c=R(r||[]),t.u=i.toString()}t.i=new Ki(t.u),ro(t)}),t.m)}function eo(t){return t.o||(t.v=t.c?rn(t.c,Ji(t.b)):null,t.o=new vi(t.f,Wi(t.h),t.v)),t.o}function no(t,e,n,r,i,o,a,s,u,c){return t=new Yi(t,e,n,r,i),t.i=o,t.g=a,t.h=s,t.b=V(u||null),t.f=c,t.toString()}function ro(t){if(!t.i)throw Error("IfcHandler must be initialized!");Qi(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Tr(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return n={},n.status=r?"ACK":"ERROR",Y(n)}return n.status="ERROR",Y(n)})}function io(t){var e={type:"webStorageSupport"};return to(t).then(function(){return Gi(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})}function oo(t){if(this.a=t||Su.INTERNAL.reactNative&&Su.INTERNAL.reactNative.AsyncStorage,!this.a)throw new On("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ao(){if(!ho())throw new On("web-storage-unsupported");this.f={},this.a=[],this.b=0,this.g=_u.indexedDB,this.type="indexedDB"}function so(t){return new Q(function(e,n){var r=t.g.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}function uo(t){return new Q(function(e,n){var r=t.g.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){r=r.target.result,r.objectStoreNames.contains("firebaseLocalStorage")?e(r):so(t).then(function(){return uo(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function co(t){return t.h||(t.h=uo(t)),t.h}function ho(){try{return!!_u.indexedDB}catch(t){return!1}}function lo(t){return t.objectStore("firebaseLocalStorage")}function fo(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function po(t){return new Q(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})}function mo(t){function e(){return t.c=Wt(800).then(d(t.Kc,t)).then(function(e){0<e.length&&xu(t.a,function(t){t(e)})}).then(e).s(function(t){"STOP_EVENT"!=t.message&&e()}),t.c}t.c&&t.c.cancel("STOP_EVENT"),e()}function yo(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Y().then(function(){return ho()?(Nl||(Nl=new ao),n=Nl,n.set("__sak","!").then(function(){return n.get("__sak")}).then(function(t){if("!"!==t)throw Error("indexedDB not supported!");return n.P("__sak")}).then(function(){return n}).s(function(){return e.c})):e.c}).then(function(t){return e.type=t.type,t.Y(function(t){xu(e.a,function(e){e(t)})}),t})}function go(){this.a={},this.type="inMemory"}function vo(){if(!wo()){if("Node"==Ze())throw new On("internal-error","The LocalStorage compatibility library was not found.");throw new On("web-storage-unsupported")}this.a=bo()||Su.INTERNAL.node.localStorage,this.type="localStorage"}function bo(){try{var t=_u.localStorage,e=mn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function wo(){var t="Node"==Ze();if(!(t=bo()||t&&Su.INTERNAL.node&&Su.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}function Eo(){this.type="nullStorage"}function To(){if(!So()){if("Node"==Ze())throw new On("internal-error","The SessionStorage compatibility library was not found.");throw new On("web-storage-unsupported")}this.a=Io()||Su.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Io(){try{var t=_u.sessionStorage,e=mn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function So(){var t="Node"==Ze();if(!(t=Io()||t&&Su.INTERNAL.node&&Su.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}function Ao(){var t={};t.Browser=Ol,t.Node=Rl,t.ReactNative=xl,t.Worker=Ll,this.a=t[Ze()]}function _o(t){var e=new On("invalid-persistence-type"),n=new On("unsupported-persistence-type");t:{for(r in Pl)if(Pl[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Ze()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!sn()&&"none"!==t)throw n}}function ko(){var t=!(yn(on())||!Je()),e=ln(),n=sn();this.o=t,this.h=e,this.m=n,this.a={},Cl||(Cl=new Ao),t=Cl;try{this.g=!Fe()&&Tn()||!_u.indexedDB?new t.a.A:new yo($e()?new go:new t.a.A)}catch(t){this.g=new go,this.h=!0}try{this.i=new t.a.Qa}catch(t){this.i=new go}this.l=new go,this.f=d(this.Lb,this),this.b={}}function No(){return Dl||(Dl=new ko),Dl}function Co(t,e){switch(e){case"session":return t.i;case"none":return t.l;default:return t.g}}function Do(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Oo(t,e,n){var r=Do(e,n),i=Co(t,e.A);return t.get(e,n).then(function(o){var a=null;try{a=pn(_u.localStorage.getItem(r))}catch(t){}if(a&&!o)return _u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&_u.localStorage.removeItem(r)})}function Ro(t,e,n){return n=Do(e,n),"local"==e.A&&(t.b[n]=null),Co(t,e.A).P(n)}function xo(t){Lo(t),t.c=setInterval(function(){for(var e in t.a){var n=_u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new wt({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Lb(n))}},1e3)}function Lo(t){t.c&&(clearInterval(t.c),t.c=null)}function Po(t){this.a=t,this.b=No()}function Mo(t){return t.b.get(Bl,t.a).then(function(t){return Tr(t)})}function Bo(){this.a=No()}function Uo(){this.b=-1}function Fo(t,e){this.b=-1,this.b=Ul,this.f=_u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.m=_u.Int32Array?new Int32Array(64):Array(64),void 0!==Ml||(Ml=_u.Int32Array?new Int32Array(Wl):Wl),this.reset()}function Vo(t){for(var e=t.f,n=t.m,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=c&h^~c&l,o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0,a=a+(0|Ml[e])|0,a=o+(a+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function qo(e,n,r){void 0===r&&(r=n.length);var i=0,o=e.c;if(t(n))for(;i<r;)e.f[o++]=n.charCodeAt(i++),o==e.b&&(Vo(e),o=0);else{if(!u(n))throw Error("message must be string or array");for(;i<r;){var a=n[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");e.f[o++]=a,o==e.b&&(Vo(e),o=0)}}e.c=o,e.g+=r}function jo(){Fo.call(this,8,Kl)}function Wo(t,e,n,r,i){this.l=t,this.i=e,this.m=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new Bo,this.g=new Po(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ko(t){return new On("invalid-cordova-configuration",t)}function Ho(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function Go(t){var e=new jo;qo(e,t),t=[];var n=8*e.g;56>e.c?qo(e,jl,56-e.c):qo(e,jl,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Vo(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return Pn(t)}function Qo(t,e,n,r){var i=Ho(),o=new Er(e,r,null,i,new On("no-auth-event")),a=an("BuildInfo.packageName",_u);if("string"!=typeof a)throw new On("invalid-cordova-configuration");var s=an("BuildInfo.displayName",_u),u={};if(on().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!on().toLowerCase().match(/android/))return J(new On("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=Go(i),u.sessionId=i;var c=no(t.l,t.i,t.m,e,n,null,r,t.o,u,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(Bl,o.D(),e)}).then(function(){var e=an("cordova.plugins.browsertab.isAvailable",_u);if("function"!=typeof e)throw new On("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=an("cordova.plugins.browsertab.openUrl",_u)))throw new On("invalid-cordova-configuration");n(c)}else{if("function"!=typeof(n=an("cordova.InAppBrowser.open",_u)))throw new On("invalid-cordova-configuration");e=on(),e=!(!e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=n(c,e?"_blank":"_system","location=yes")}})})}function zo(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Xo(t){return t.f||(t.f=t.ga().then(function(){return new Q(function(e){function n(r){return e(r),t.Ka(n),!1}t.va(n),Jo(t)})})),t.f}function Yo(t){var e=null;return Mo(t.g).then(function(n){return e=n,n=t.g,Ro(n.b,Bl,n.a)}).then(function(){return e})}function Jo(t){function n(n){i=!0,o&&o.cancel(),Yo(t).then(function(i){var o=r;if(i&&n&&n.url){var a=null;o=Jn(n.url),-1!=o.indexOf("/__/auth/callback")&&(a=re(o),a=pn(ne(a,"firebaseError")||null),a=(a="object"===(void 0===a?"undefined":e(a))?Rn(a):null)?new Er(i.b,i.c,null,null,a):new Er(i.b,i.c,o,i.g)),o=a||r}zo(t,o)})}var r=new Er("unknown",null,null,null,new On("no-auth-event")),i=!1,o=Wt(500).then(function(){return Yo(t).then(function(){i||zo(t,r)})}),a=_u.handleOpenURL;_u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(an("BuildInfo.packageName",_u).toLowerCase()+"://")&&n({url:t}),"function"==typeof a)try{a(t)}catch(t){console.error(t)}},Ih||(Ih=new Ir),Ih.subscribe(n)}function $o(t){this.a=t,this.b=No()}function Zo(t){return t.b.set(Hl,"pending",t.a)}function ta(t){return Ro(t.b,Hl,t.a)}function ea(t){return t.b.get(Hl,t.a).then(function(t){return"pending"==t})}function na(t,e,n){this.v=t,this.m=e,this.l=n,this.h=[],this.f=!1,this.i=d(this.o,this),this.c=new ca,this.u=new ya,this.g=new $o(this.m+":"+this.l),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.u,this.b.linkViaPopup=this.u,this.b.reauthViaPopup=this.u,this.a=ra(this.v,this.m,this.l,Xh)}function ra(t,e,n,r){var i=Su.SDK_VERSION||null;return Ye()?new Wo(t,e,n,i,r):new $i(t,e,n,i,r)}function ia(t){t.f||(t.f=!0,t.a.va(t.i));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function oa(t){t.a.Ib()&&ia(t).s(function(e){var n=new Er("unknown",null,null,null,new On("operation-not-supported-in-this-environment"));sa(e)&&t.o(n)}),t.a.Db()||ha(t.c)}function aa(t,e,n,r,i,o){return t.a.zb(e,n,r,function(){t.f||(t.f=!0,t.a.va(t.i))},function(){t.reset()},i,o)}function sa(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function ua(t,e,n){var r=e+":"+n;return zl[r]||(zl[r]=new na(t,e,n)),zl[r]}function ca(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function ha(t){t.g||(t.g=!0,pa(t,!1,null,null))}function la(t,e,n){n=n.wa(e.b,e.c);var r=e.f,i=e.g,o=!!e.b.match(/Redirect$/);n(r,i).then(function(e){pa(t,o,e,null)}).s(function(e){pa(t,o,null,e)})}function fa(t,e){if(t.b=function(){return J(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}function da(t,e){if(t.b=function(){return Y(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function pa(t,e,n,r){e?r?fa(t,r):da(t,n):da(t,{user:null}),t.f=[],t.c=[]}function ma(t){var e=new On("timeout");t.a&&t.a.cancel(),t.a=Wt(Ql.get()).then(function(){t.b||pa(t,!0,null,e)})}function ya(){}function ga(t,e){var n=t.c,r=t.b;e.wa(r,n)(t.f,t.g).then(function(t){e.ha(r,t,null,n)}).s(function(t){e.ha(r,null,t,n)})}function va(){this.pb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.pb},set:function(t){this.pb=t},enumerable:!1})}function ba(t,e){this.a=e,Sn(this,"verificationId",t)}function wa(t,e,n,r){return new gr(t).Ta(e,n).then(function(t){return new ba(t,r)})}function Ea(t){var e=qn(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new On("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");An(this,{token:t,expirationTime:En(1e3*e.exp),authTime:En(1e3*e.auth_time),issuedAtTime:En(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Ta(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Ia(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function Sa(t,e){t.stop(),t.b=Wt(Ia(t,e)).then(function(){return wn()}).then(function(){return t.h()}).then(function(){Sa(t,!0)}).s(function(e){t.i(e)&&Sa(t,!1)})}function Aa(t){this.f=t,this.b=this.a=null,this.c=0}function _a(t,e){var n=e[qh],r=e.refreshToken;e=Na(e.expiresIn),t.b=n,t.c=e,t.a=r}function ka(t,e){t.b=e.b,t.a=e.a,t.c=e.c}function Na(t){return Cu()+1e3*parseInt(t,10)}function Ca(t,e){return Ii(t.f,e).then(function(e){return t.b=e.access_token,t.c=Na(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function Da(t,e){this.a=t||null,this.b=e||null,An(this,{lastSignInTime:En(e||null),creationTime:En(t||null)})}function Oa(t){return new Da(t.a,t.b)}function Ra(t,e,n,r,i,o){An(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function xa(t,e){bt.call(this,t);for(var n in e)this[n]=e[n]}function La(t,e,n){this.G=[],this.l=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=Su.SDK_VERSION?rn(Su.SDK_VERSION):null,this.b=new vi(this.l,Wi(Xh),t),this.h=new Aa(this.b),ja(this,e[qh]),_a(this.h,e),Sn(this,"refreshToken",this.h.a),Ga(this,n||{}),Ut.call(this),this.I=!1,this.u&&un()&&(this.a=ua(this.u,this.l,this.o)),this.N=[],this.i=null,this.w=Fa(this),this.V=d(this.Ha,this);var r=this;this.ka=null,this.sa=function(t){r.oa(t.g)},this.X=null,this.O=[],this.ra=function(t){Ma(r,t.c)},this.W=null}function Pa(t,e){t.X&&Dt(t.X,"languageCodeChanged",t.sa),(t.X=e)&&_t(e,"languageCodeChanged",t.sa)}function Ma(t,e){t.O=e,wi(t.b,Su.SDK_VERSION?rn(Su.SDK_VERSION,t.O):null)}function Ba(t,e){t.W&&Dt(t.W,"frameworkChanged",t.ra),(t.W=e)&&_t(e,"frameworkChanged",t.ra)}function Ua(t){try{return Su.app(t.o).auth()}catch(e){throw new On("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function Fa(t){return new Ta(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-Cu()-3e5;return 0<e?e:0})}function Va(t){t.C||t.w.b||(t.w.start(),Dt(t,"tokenChanged",t.V),_t(t,"tokenChanged",t.V))}function qa(t){Dt(t,"tokenChanged",t.V),t.w.stop()}function ja(t,e){t.qa=e,Sn(t,"_lat",e)}function Wa(t,e){D(t.N,function(t){return t==e})}function Ka(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return tt(e).then(function(){return t})}function Ha(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Ga(t,e){An(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new Da(e.createdAt,e.lastLoginAt),providerData:[]})}function Qa(){}function za(t){return Y().then(function(){if(t.C)throw new On("app-deleted")})}function Xa(t){return Lu(t.providerData,function(t){return t.providerId})}function Ya(t,e){e&&(Ja(t,e.providerId),t.providerData.push(e))}function Ja(t,e){D(t.providerData,function(t){return t.providerId==e})}function $a(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Sn(t,e,n)}function Za(t,e){t!=e&&(An(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Sn(t,"metadata",Oa(e.metadata)):Sn(t,"metadata",new Da),xu(e.providerData,function(e){Ya(t,e)}),ka(t.h,e.h),Sn(t,"refreshToken",t.h.a))}function ts(t){return t.F().then(function(e){var n=t.isAnonymous;return ns(t,e).then(function(){return n||$a(t,"isAnonymous",!1),e})})}function es(t,e){e[qh]&&t.qa!=e[qh]&&(_a(t.h,e),t.dispatchEvent(new xa("tokenChanged")),ja(t,e[qh]),$a(t,"refreshToken",t.h.a))}function ns(t,e){return Vi(t.b,il,{idToken:e}).then(d(t.uc,t))}function rs(t){return(t=t.providerUserInfo)&&t.length?Lu(t,function(t){return new Ra(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}function is(t,e){return ts(t).then(function(){if(N(Xa(t),e))return Ka(t).then(function(){throw new On("provider-already-linked")})})}function os(t,e,n){var r=br(e);return e=Wn(e),_n({user:t,credential:r,additionalUserInfo:e,operationType:n})}function as(t,e){return es(t,e),t.reload().then(function(){return t})}function ss(t,e,n,r,i){if(!un())return J(new On("operation-not-supported-in-this-environment"));if(t.i&&!i)return J(t.i);var o=jn(n.providerId),a=mn(t.uid+":::"),s=null;(!ln()||Je())&&t.u&&n.isOAuthProvider&&(s=no(t.u,t.l,t.o,e,n,null,a,Su.SDK_VERSION||null));var u=Ge(s,o&&o.Ba,o&&o.Aa);return r=r().then(function(){if(cs(t),!i)return t.F().then(function(){})}).then(function(){return aa(t.a,u,e,n,a,!!s)}).then(function(){return new Q(function(n,r){t.ha(e,null,new On("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.c=t.a.Ea(t,e,u,a)})}).then(function(t){return u&&He(u),t?_n(t):null}).s(function(t){throw u&&He(u),t}),hs(t,r,i)}function us(t,e,n,r,i){if(!un())return J(new On("operation-not-supported-in-this-environment"));if(t.i&&!i)return J(t.i);var o=null,a=mn(t.uid+":::");return r=r().then(function(){if(cs(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,Ka(t)}).then(function(e){return t.ba&&(e=t.ba,e=e.b.set(Xl,t.D(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return ys(t.ba);throw o}).then(function(){if(o)throw o}),hs(t,r,i)}function cs(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new On("internal-error");throw new On("auth-domain-config-required")}}function hs(t,e,n){var r=ls(t,e,n);return t.G.push(r),r.ia(function(){C(t.G,r)}),r}function ls(t,e,n){return t.i&&!n?(e.cancel(),J(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new xa("userInvalidated")),t.i=e),e})}function fs(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[qh]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-Cu())/1e3;var r=new La(e,n,t);return t.providerData&&xu(t.providerData,function(t){t&&Ya(r,_n(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}function ds(t,e,n,r){var i=new La(t,e);return n&&(i.ba=n),r&&Ma(i,r),i.reload().then(function(){return i})}function ps(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[qh]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-Cu())/1e3,e=new La(e,o),n&&(e.ba=n),r&&Ma(e,r),Za(e,t),e}function ms(t){this.a=t,this.b=No()}function ys(t){return Ro(t.b,Xl,t.a)}function gs(t,e){return t.b.get(Xl,t.a).then(function(t){return t&&e&&(t.authDomain=e),fs(t||{})})}function vs(t){this.a=t,this.b=No(),this.c=null,this.f=ws(this),this.b.addListener(Es("local"),this.a,d(this.g,this))}function bs(t,e){var n,r=[];for(n in Pl)Pl[n]!==e&&r.push(Ro(t.b,Es(Pl[n]),t.a));return r.push(Ro(t.b,Yl,t.a)),Z(r)}function ws(t){var e=Es("local"),n=Es("session"),r=Es("none");return Oo(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Yl,t.a).then(function(t){return t?Es(t):e})})})}).then(function(e){return t.c=e,bs(t,e.A)}).s(function(){t.c||(t.c=e)})}function Es(t){return{name:"authUser",A:t}}function Ts(t){return _s(t,function(){return t.b.set(Yl,t.c.A,t.a)})}function Is(t,e){return _s(t,function(){return t.b.set(t.c,e.D(),t.a)})}function Ss(t){return _s(t,function(){return Ro(t.b,t.c,t.a)})}function As(t,e){return _s(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),fs(t||{})})})}function _s(t,e){return t.f=t.f.then(e,e),t.f}function ks(t){if(this.l=!1,Sn(this,"settings",new va),Sn(this,"app",t),!Fs(this).options||!Fs(this).options.apiKey)throw new On("invalid-api-key");t=Su.SDK_VERSION?rn(Su.SDK_VERSION):null,this.b=new vi(Fs(this).options&&Fs(this).options.apiKey,Wi(Xh),t),this.N=[],this.o=[],this.I=[],this.Pb=Su.INTERNAL.createSubscribe(d(this.ic,this)),this.O=void 0,this.Qb=Su.INTERNAL.createSubscribe(d(this.jc,this)),Ls(this,null),this.h=new vs(Fs(this).options.apiKey+":"+Fs(this).name),this.w=new ms(Fs(this).options.apiKey+":"+Fs(this).name),this.V=Ks(this,Ms(this)),this.i=Ks(this,Bs(this)),this.X=!1,this.ka=d(this.Jc,this),this.Ha=d(this.Z,this),this.qa=d(this.Yb,this),this.ra=d(this.gc,this),this.sa=d(this.hc,this),Rs(this),this.INTERNAL={},this.INTERNAL.delete=d(this.delete,this),this.INTERNAL.logFramework=d(this.qc,this),this.u=0,Ut.call(this),Ds(this),this.G=[]}function Ns(t){bt.call(this,"languageCodeChanged"),this.g=t}function Cs(t){bt.call(this,"frameworkChanged"),this.c=t}function Ds(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.oa(t)},enumerable:!1}),t.W=null}function Os(t){return t.Ob||J(new On("auth-domain-config-required"))}function Rs(t){var e=Fs(t).options.authDomain,n=Fs(t).options.apiKey;e&&un()&&(t.Ob=t.V.then(function(){if(!t.l){if(t.a=ua(e,n,Fs(t).name),t.a.subscribe(t),Vs(t)&&Ha(Vs(t)),t.C){Ha(t.C);var r=t.C;r.oa(t.ea()),Pa(r,t),r=t.C,Ma(r,t.G),Ba(r,t),t.C=null}return t.a}}))}function xs(t,e){var n={};return n.apiKey=Fs(t).options.apiKey,n.authDomain=Fs(t).options.authDomain,n.appName=Fs(t).name,t.V.then(function(){return ds(n,e,t.w,t.xa())}).then(function(e){return Vs(t)&&e.uid==Vs(t).uid?(Za(Vs(t),e),t.Z(e)):(Ls(t,e),Ha(e),t.Z(e))}).then(function(){js(t)})}function Ls(t,e){Vs(t)&&(Wa(Vs(t),t.Ha),Dt(Vs(t),"tokenChanged",t.qa),Dt(Vs(t),"userDeleted",t.ra),Dt(Vs(t),"userInvalidated",t.sa),qa(Vs(t))),e&&(e.N.push(t.Ha),_t(e,"tokenChanged",t.qa),_t(e,"userDeleted",t.ra),_t(e,"userInvalidated",t.sa),0<t.u&&Va(e)),Sn(t,"currentUser",e),e&&(e.oa(t.ea()),Pa(e,t),Ma(e,t.G),Ba(e,t))}function Ps(t){var e=gs(t.w,Fs(t).options.authDomain).then(function(e){return(t.C=e)&&(e.ba=t.w),ys(t.w)});return Ks(t,e)}function Ms(t){var e=Fs(t).options.authDomain,n=Ps(t).then(function(){return As(t.h,e)}).then(function(e){return e?(e.ba=t.w,t.C&&(t.C.aa||null)==(e.aa||null)?e:e.reload().then(function(){return Is(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:Ss(t.h)})):null}).then(function(e){Ls(t,e||null)});return Ks(t,n)}function Bs(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.l)return t.ka()}).s(function(){}).then(function(){if(!t.l){t.X=!0;var e=t.h;e.b.addListener(Es("local"),e.a,t.ka)}})}function Us(t,e){var n=null,r=null;return Ks(t,e.then(function(e){return n=br(e),r=Wn(e),xs(t,e)}).then(function(){return _n({user:Vs(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Fs(t){return t.app}function Vs(t){return t.currentUser}function qs(t){return Vs(t)&&Vs(t)._lat||null}function js(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](qs(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](qs(t))}}function Ws(t,e){t.I.push(e),Ks(t,t.i.then(function(){!t.l&&N(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(qs(t)))}))}function Ks(t,e){return t.N.push(e),e.ia(function(){C(t.N,e)}),e}function Hs(){}function Gs(){this.a={},this.b=1e12}function Qs(t,e){return(e=zs(e))?t.a[e]||null:null}function zs(t){return(t=void 0===t?1e12:t)?t.toString():null}function Xs(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=De(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():_t(this.f,"click",this.i)}function Ys(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Js(){}function $s(){this.b=_u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function Zs(t,e,n,r,i,o,a){if(Sn(this,"type","recaptcha"),this.c=this.f=null,this.C=!1,this.l=e,this.g=null,a?($l||($l=new Js),a=$l):(ef||(ef=new $s),a=ef),this.o=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[of])throw new On("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[af],!_u.document)throw new On("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!De(e)||!this.i&&De(e).hasChildNodes())throw new On("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new vi(t,o||null,i||null),this.v=r||function(){return null};var s=this;this.m=[];var u=this.a[nf];this.a[nf]=function(t){if(tu(s,t),"function"==typeof u)u(t);else if("string"==typeof u){var e=an(u,_u);"function"==typeof e&&e(t)}};var c=this.a[rf];this.a[rf]=function(){if(tu(s,null),"function"==typeof c)c();else if("string"==typeof c){var t=an(c,_u);"function"==typeof t&&t()}}}function tu(t,e){for(var n=0;n<t.m.length;n++)try{t.m[n](e)}catch(t){}}function eu(t,e){D(t.m,function(t){return t==e})}function nu(t,e){return t.h.push(e),e.ia(function(){C(t.h,e)}),e}function ru(t){if(t.C)throw new On("internal-error","RecaptchaVerifier instance has been destroyed.")}function iu(t,e,n){var r=!1;try{this.b=n||Su.app()}catch(t){throw new On("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new On("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().xa()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=Su.SDK_VERSION?rn(Su.SDK_VERSION,o):null,Zs.call(this,n,t,e,function(){try{var t=i.b.auth().ea()}catch(e){t=null}return t},o,Wi(Xh),r)}function ou(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new On("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=sf.length)throw new On("internal-error","Argument validator received an unsupported number of arguments.");n=sf[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new On("argument-error",t+" failed: "+r)}function au(e,n){return{name:e||"",K:"a valid string",optional:!!n,M:t}}function su(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:r}}function uu(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:h}}function cu(t,e){return{name:t||"",K:"a function",optional:!!e,M:c}}function hu(t,e){return{name:t||"",K:"null",optional:!!e,M:a}}function lu(){return{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}}}function fu(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ks)}}}function du(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof Su.app.App)}}}function pu(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ya||!n)}}}function mu(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function yu(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&t(e.type)&&c(e.verify))}}}function gu(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function vu(t,e){for(var n in e){var r=e[n].name;t[r]=Eu(r,t[n],e[n].j)}}function bu(t,e){for(var n in e){var r=e[n].name;if(r!==n){var i=e[n].qb;Object.defineProperty(t,r,{get:function(){return this[n]},set:function(t){ou(r,[i],[t],!0),this[n]=t},enumerable:!0})}}}function wu(t,e,n,r){t[e]=Eu(e,n,r)}function Eu(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return ou(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=Tu(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}function Tu(t){return t=t.split("."),t[t.length-1]}var Iu,Su=n(4).default,Au=Au||{},_u=this,ku="closure_uid_"+(1e9*Math.random()>>>0),Nu=0,Cu=Date.now||function(){return+new Date};m(v,Error),v.prototype.name="CustomError",m(b,v),b.prototype.name="AssertionError",E.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Du=new E(function(){return new A},function(t){t.reset()});I.prototype.add=function(t,e){var n=Du.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},A.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},A.prototype.reset=function(){this.next=this.b=this.a=null};var Ou,Ru=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(e,n){if(t(e))return t(n)&&1==n.length?e.indexOf(n,0):-1;for(var r=0;r<e.length;r++)if(r in e&&e[r]===n)return r;return-1},xu=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)a in o&&n.call(r,o[a],a,e)},Lu=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(e,n){for(var r=e.length,i=Array(r),o=t(e)?e.split(""):e,a=0;a<r;a++)a in o&&(i[a]=n.call(void 0,o[a],a,e));return i},Pu=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(e,n){for(var r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e))return!0;return!1},Mu=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Bu=/&/g,Uu=/</g,Fu=/>/g,Vu=/"/g,qu=/'/g,ju=/\x00/g,Wu=/[\x00&<>"']/;t:{var Ku=_u.navigator;if(Ku){var Hu=Ku.userAgent;if(Hu){Ou=Hu;break t}}Ou=""}var Gu,Qu,zu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Xu=!1,Yu=new I,Ju=0,$u=2,Zu=3;z.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var tc=new E(function(){return new z},function(t){t.reset()});Q.prototype.then=function(t,e,n){return rt(this,c(t)?t:null,c(e)?e:null,n)},y(Q),Iu=Q.prototype,Iu.ia=function(t,e){return t=X(t,t,e),t.c=!0,nt(this,t),this},Iu.s=function(t,e){return rt(this,null,t,e)},Iu.cancel=function(t){this.a==Ju&&K(function(){et(this,new ft(t))},this)},Iu.Lc=function(t){this.a=Ju,it(this,$u,t)},Iu.Mc=function(t){this.a=Ju,it(this,Zu,t)},Iu.Ub=function(){for(var t;t=ut(this);)ct(this,t,this.a,this.i);this.h=!1};var ec=j;m(ft,v),ft.prototype.name="cancel";var nc=0,rc={};dt.prototype.pa=!1,dt.prototype.ua=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},mt[" "]=i;var ic,oc=B("Opera"),ac=B("Trident")||B("MSIE"),sc=B("Edge"),uc=sc||ac,cc=B("Gecko")&&!(P(Ou.toLowerCase(),"webkit")&&!B("Edge"))&&!(B("Trident")||B("MSIE"))&&!B("Edge"),hc=P(Ou.toLowerCase(),"webkit")&&!B("Edge");t:{var lc="",fc=function(){var t=Ou;return cc?/rv:([^\);]+)(\)|;)/.exec(t):sc?/Edge\/([\d\.]+)/.exec(t):ac?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):hc?/WebKit\/(\S+)/.exec(t):oc?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(fc&&(lc=fc?fc[1]:""),ac){var dc=gt();if(null!=dc&&dc>parseFloat(lc)){ic=String(dc);break t}}ic=lc}var pc,mc={},yc=_u.document;pc=yc&&ac?gt()||("CSS1Compat"==yc.compatMode?parseInt(ic,10):5):void 0;var gc=Object.freeze||function(t){return t},vc=!ac||9<=Number(pc),bc=ac&&!vt("9"),wc=function(){if(!_u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return _u.addEventListener("test",i,e),_u.removeEventListener("test",i,e),t}();bt.prototype.preventDefault=function(){this.Gb=!1},m(wt,bt);var Ec=gc({2:"touch",3:"pen",4:"mouse"});wt.prototype.preventDefault=function(){wt.lb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bc)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},wt.prototype.f=function(){return this.a};var Tc="closure_listenable_"+(1e6*Math.random()|0),Ic=0;It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=At(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):(e=new Et(e,this.src,o,!!r,i),e.Ia=n,t.push(e)),e};var Sc="closure_lm_"+(1e6*Math.random()|0),Ac={},_c=0,kc="__closure_events_fn_"+(1e9*Math.random()>>>0);m(Ut,dt),Ut.prototype[Tc]=!0,Ut.prototype.addEventListener=function(t,e,n,r){_t(this,t,e,n,r)},Ut.prototype.removeEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},Ut.prototype.dispatchEvent=function(e){var n,r=this.Ua;if(r)for(n=[];r;r=r.Ua)n.push(r);r=this.Nb;var i=e.type||e;if(t(e))e=new bt(e,r);else if(e instanceof bt)e.target=e.target||r;else{var o=e;e=new bt(i,r),q(e,o)}if(o=!0,n)for(var a=n.length-1;0<=a;a--){var s=e.b=n[a];o=qt(s,i,!0,e)&&o}if(s=e.b=r,o=qt(s,i,!0,e)&&o,o=qt(s,i,!1,e)&&o,n)for(a=0;a<n.length;a++)s=e.b=n[a],o=qt(s,i,!1,e)&&o;return o},Ut.prototype.ua=function(){if(Ut.lb.ua.call(this),this.m){var t,e=this.m,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,Tt(r[i]);delete e.a[t],e.b--}}this.Ua=null},Iu=Qt.prototype,Iu.S=function(){zt(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Iu.U=function(){return zt(this),this.a.concat()},Iu.clear=function(){this.b={},this.c=this.a.length=0},Iu.get=function(t,e){return Xt(this.b,t)?this.b[t]:e},Iu.set=function(t,e){Xt(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Iu.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Nc=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Jt.prototype.toString=function(){var t=[],e=this.c;e&&t.push(ae(e,Cc,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.m)&&t.push(ae(e,Cc,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(ae(n,"/"==n.charAt(0)?Oc:Dc,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",ae(n,xc)),t.join("")};var Cc=/[#\/\?@]/g,Dc=/[#\?:]/g,Oc=/[#\?]/g,Rc=/[#\?@]/g,xc=/#/g;Iu=ue.prototype,Iu.add=function(t,e){ce(this),this.c=null,t=pe(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Iu.clear=function(){this.a=this.c=null,this.b=0},Iu.forEach=function(t,e){ce(this),this.a.forEach(function(n,r){xu(n,function(n){t.call(e,n,r,this)},this)},this)},Iu.U=function(){ce(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Iu.S=function(e){ce(this);var n=[];if(t(e))fe(this,e)&&(n=O(n,this.a.get(pe(this,e))));else{e=this.a.S();for(var r=0;r<e.length;r++)n=O(n,e[r])}return n},Iu.set=function(t,e){return ce(this),this.c=null,t=pe(this,t),fe(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Iu.get=function(t,e){return t=t?this.S(t):[],0<t.length?String(t[0]):e},Iu.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Lc=!ac||9<=Number(pc);ye.prototype.ma=!0,ye.prototype.la=function(){return this.a},ye.prototype.toString=function(){return"Const{"+this.a+"}"};var Pc={};ve(""),be.prototype.ma=!0,be.prototype.la=function(){return this.a},be.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Mc=/%{(\w+)}/g,Bc=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,Uc={};Ie.prototype.ma=!0,Ie.prototype.la=function(){return this.a},Ie.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Fc=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,Vc={};_e("about:blank"),ke.prototype.ma=!0,ke.prototype.la=function(){return this.a},ke.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var qc={};Ce("<!DOCTYPE html>"),Ce(""),Ce("<br>");var jc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Wc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Kc=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,Hc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gc="Firefox",Qc="Chrome",zc={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};vn.prototype.get=function(){var t=_u.navigator;return(t&&"boolean"==typeof t.onLine&&(cn()||"chrome-extension:"===hn()||void 0!==t.connection)?t.onLine:1)?this.b?this.c:this.a:Math.min(5e3,this.a)};var Xc,Yc={};try{var Jc={};Object.defineProperty(Jc,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Jc,"abcd",{configurable:!0,enumerable:!0,value:2}),Xc=2==Jc.abcd}catch(t){Xc=!1}var $c="EMAIL_SIGNIN",Zc="email",th="newEmail",eh="requestType",nh="email",rh="fromEmail",ih="data",oh="operation";m(On,Error),On.prototype.D=function(){return{code:this.code,message:this.message}},On.prototype.toJSON=function(){return this.D()};var ah="auth/",sh={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},uh="android",ch="handleCodeInApp",hh="iOS",lh="url",fh="installApp",dh="minimumVersion",ph="packageName",mh="bundleId",yh=null,gh=null;Fn.prototype.f=function(){return this.b};var vh="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),bh=["client_id","response_type","scope","redirect_uri","state"],wh={Tc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",eb:bh},Vc:{Ma:null,Ba:500,Aa:620,Na:"github.com",eb:bh},Wc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",eb:bh},bd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",eb:vh}},Eh="idToken",Th="providerId";m(Hn,Kn),m(Gn,Hn),m(Qn,Hn),m(zn,Hn),m(Xn,Hn),Zn.prototype.ya=function(t){return Mi(t,tr(this))},Zn.prototype.c=function(t,e){var n=tr(this);return n.idToken=e,Bi(t,n)},Zn.prototype.f=function(t,e){return $n(Ui(t,tr(this)),e)},Zn.prototype.D=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t},er.prototype.Da=function(t){return this.vb=V(t),this},m(nr,er),nr.prototype.ta=function(t){return N(this.a,t)||this.a.push(t),this},nr.prototype.Ab=function(){return R(this.a)},nr.prototype.credential=function(t,e){if(!t&&!e)throw new On("argument-error","credential failed: must provide the ID token and/or the access token.");return new Zn(this.providerId,{idToken:t||null,accessToken:e||null},this.providerId)},m(rr,nr),Sn(rr,"PROVIDER_ID","facebook.com"),Sn(rr,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),m(or,nr),Sn(or,"PROVIDER_ID","github.com"),Sn(or,"GITHUB_SIGN_IN_METHOD","github.com"),m(sr,nr),Sn(sr,"PROVIDER_ID","google.com"),Sn(sr,"GOOGLE_SIGN_IN_METHOD","google.com"),m(cr,er),Sn(cr,"PROVIDER_ID","twitter.com"),Sn(cr,"TWITTER_SIGN_IN_METHOD","twitter.com"),lr.prototype.ya=function(t){return this.signInMethod==fr.EMAIL_LINK_SIGN_IN_METHOD?Vi(t,nl,{email:this.a,oobCode:this.b}):Vi(t,bl,{email:this.a,password:this.b})},lr.prototype.c=function(t,e){return this.signInMethod==fr.EMAIL_LINK_SIGN_IN_METHOD?Vi(t,rl,{idToken:e,email:this.a,oobCode:this.b}):Vi(t,dl,{idToken:e,email:this.a,password:this.b})},lr.prototype.f=function(t,e){return $n(this.ya(t),e)},lr.prototype.D=function(){return{email:this.a,password:this.b,signInMethod:this.signInMethod}},An(fr,{PROVIDER_ID:"password"}),An(fr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),An(fr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),mr.prototype.ya=function(t){return t.Ta(yr(this))},mr.prototype.c=function(t,e){var n=yr(this);return n.idToken=e,Vi(t,El,n)},mr.prototype.f=function(t,e){var n=yr(this);return n.operation="REAUTH",t=Vi(t,Tl,n),$n(t,e)},mr.prototype.D=function(){var t={providerId:"phone"};return this.a.Sa&&(t.verificationId=this.a.Sa),this.a.Ra&&(t.verificationCode=this.a.Ra),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},gr.prototype.Ta=function(e,n){var r=this.a.b;return Y(n.verify()).then(function(i){if(!t(i))throw new On("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return Ri(r,{phoneNumber:e,recaptchaToken:i}).then(function(t){return"function"==typeof n.reset&&n.reset(),t},function(t){throw"function"==typeof n.reset&&n.reset(),t});default:throw new On("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},An(gr,{PROVIDER_ID:"phone"}),An(gr,{PHONE_SIGN_IN_METHOD:"phone"}),Er.prototype.D=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.D()}};var Ih=null;Ir.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=an("universalLinks.subscribe",_u))&&t(null,this.b))},Ir.prototype.unsubscribe=function(t){D(this.a,function(e){return e==t})},m(Sr,On),m(Ar,On),Ar.prototype.D=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.D();return e&&q(t,e),t},Ar.prototype.toJSON=function(){return this.D()};var Sh=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;kr.prototype.c=null;var Ah;m(Cr,kr),Cr.prototype.a=function(){var t=Dr(this);return t?new ActiveXObject(t):new XMLHttpRequest},Cr.prototype.b=function(){var t={};return Dr(this)&&(t[0]=!0,t[1]=!0),t},Ah=new Cr,m(Or,kr),Or.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Rr;throw Error("Unsupported browser")},Or.prototype.b=function(){return{}},Iu=Rr.prototype,Iu.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},Iu.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},Iu.abort=function(){this.a.abort()},Iu.setRequestHeader=function(){},Iu.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},Iu.bc=function(){this.status=200,this.responseText=this.a.responseText,xr(this,4)},Iu.Bb=function(){this.status=500,this.responseText="",xr(this,4)},Iu.fc=function(){this.Bb()},Iu.cc=function(){this.status=200,xr(this,1)},Iu.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Lr.prototype.a=null;var _h=0;Lr.prototype.reset=function(t,e,n,r,i){"number"==typeof i||_h++,r||Cu(),delete this.a},Mr.prototype.toString=function(){return this.name};var kh=new Mr("SEVERE",1e3),Nh=new Mr("WARNING",900),Ch=new Mr("CONFIG",700),Dh=new Mr("FINE",500);Pr.prototype.log=function(t,e,n){if(t.value>=Br(this).value)for(c(e)&&(e=e()),t=new Lr(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Oh={},Rh=null;m(Vr,kr),Vr.prototype.a=function(){return new qr(this.f)},Vr.prototype.b=function(t){return function(){return t}}({}),m(qr,Ut);var xh=0;Iu=qr.prototype,Iu.open=function(t,e){if(this.readyState!=xh)throw this.abort(),Error("Error reopening a connection");this.h=t,this.c=e,this.readyState=1,jr(this)},Iu.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.g,method:this.h,credentials:void 0,cache:void 0};t&&(e.body=t),this.i.fetch(new Request(this.c,e)).then(this.ec.bind(this),this.Cb.bind(this))},Iu.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,jr(this)),this.readyState=xh},Iu.ec=function(t){this.a&&(this.b||(this.b=t.headers,this.readyState=2,jr(this)),this.a&&(this.readyState=3,jr(this),this.a&&t.text().then(this.dc.bind(this,t),this.Cb.bind(this))))},Iu.dc=function(t,e){this.a&&(this.status=t.status,this.statusText=t.statusText,this.responseText=e,this.readyState=4,jr(this))},Iu.Cb=function(t){var e=this.f;e&&e.log(Nh,"Failed to fetch url "+this.c,t instanceof Error?t:Error(t)),this.a&&(this.readyState=4,jr(this))},Iu.setRequestHeader=function(t,e){this.g.append(t,e)},Iu.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.f)&&t.log(Nh,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},Iu.getAllResponseHeaders=function(){if(!this.b){var t=this.f;return t&&t.log(Nh,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},m(Wr,Ut);var Lh="";Wr.prototype.b=Ur("goog.net.XhrIo");var Ph=/^https?$/i,Mh=["POST","PUT"];Iu=Wr.prototype,Iu.Ga=function(){void 0!==Au&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Fr(this.b,ei(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},Iu.abort=function(){this.a&&this.c&&(Fr(this.b,ei(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Yr(this))},Iu.ua=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Yr(this,!0)),Wr.lb.ua.call(this)},Iu.Fb=function(){this.pa||(this.I||this.i||this.f?Xr(this):this.tc())},Iu.tc=function(){Xr(this)},Iu.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Lh:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(kh,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return Fr(this.b,"Can not get response: "+t.message),null}},ni.prototype.cancel=function(t){if(this.a)this.c instanceof ni&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):0>=--e.m&&e.cancel()}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new hi(this),ii(this),ri(this,!1,t))}},ni.prototype.o=function(t,e){this.i=!1,ri(this,t,e)},ni.prototype.C=function(){ii(this),ri(this,!0,null)},ni.prototype.then=function(t,e,n){var r,i,o=new Q(function(t,e){r=t,i=e});return ai(this,r,function(t){t instanceof hi?o.cancel():i(t)}),o.then(t,e,n)},y(ni),m(ci,v),ci.prototype.message="Deferred has already fired",ci.prototype.name="AlreadyCalledError",m(hi,v),hi.prototype.message="Deferred was canceled",hi.prototype.name="CanceledError",li.prototype.c=function(){throw delete Bh[this.a],this.b};var Bh={},Uh=0,Fh=1;m(yi,v),m(gi,kr),gi.prototype.a=function(){return new this.f},gi.prototype.b=function(){return{}};var Vh,qh="idToken",jh=new vn(3e4,6e4),Wh={"Content-Type":"application/x-www-form-urlencoded"},Kh=new vn(3e4,6e4),Hh={"Content-Type":"application/json"};vi.prototype.o=function(t,e,n,r,i,o){if($e()&&(void 0===_u.fetch||void 0===_u.Headers||void 0===_u.Request))throw new On("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Wr(this.c);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent("timeout")},o)}Ft(a,"complete",function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(ti(this))||null}catch(e){t=null}e&&e(t)}),Vt(a,"ready",function(){s&&clearTimeout(s),pt(this)}),Vt(a,"timeout",function(){s&&clearTimeout(s),pt(this),e&&e(null)}),Kr(a,t,n,r,i)};var Gh=ve("https://apis.google.com/js/client.js?onload=%{onload}"),Qh="__fcb"+Math.floor(1e6*Math.random()).toString();vi.prototype.l=function(t,e,n,r,i){var o=this;Vh.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},vi.prototype.Pa=function(){return Vi(this,pl,{})},vi.prototype.mb=function(t,e){return Vi(this,fl,{idToken:t,email:e})},vi.prototype.nb=function(t,e){return Vi(this,dl,{idToken:t,password:e})};var zh={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};Iu=vi.prototype,Iu.ob=function(t,e){var n={idToken:t},r=[];return U(zh,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Vi(this,fl,n)},Iu.hb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},q(t,e),Vi(this,sl,t)},Iu.ib=function(t,e){return t={requestType:"EMAIL_SIGNIN",email:t},q(t,e),Vi(this,ol,t)},Iu.gb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},q(t,e),Vi(this,al,t)},Iu.Ta=function(t){return Vi(this,wl,t)},Iu.Xa=function(t,e){return Vi(this,hl,{oobCode:t,newPassword:e})},Iu.Ja=function(t){return Vi(this,Jh,{oobCode:t})},Iu.Va=function(t){return Vi(this,Yh,{oobCode:t})};var Xh,Yh={endpoint:"setAccountInfo",B:Fi,da:"email"},Jh={endpoint:"resetPassword",B:Fi,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new On("internal-error")}},$h={endpoint:"signupNewUser",B:function(t){if(Ai(t),!t.password)throw new On("weak-password")},J:Di,R:!0},Zh={endpoint:"createAuthUri"},tl={endpoint:"deleteAccount",T:["idToken"]},el={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(t){if(!s(t.deleteProvider))throw new On("internal-error")}},nl={endpoint:"emailLinkSignin",T:["email","oobCode"],B:Ai,J:Di,R:!0},rl={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:Ai,J:Di,R:!0},il={endpoint:"getAccountInfo"},ol={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new On("internal-error");Ai(t)},da:"email"},al={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new On("internal-error")},da:"email"},sl={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new On("internal-error");Ai(t)},da:"email"},ul={rb:!0,endpoint:"getProjectConfig",Eb:"GET"},cl={rb:!0,endpoint:"getRecaptchaParam",Eb:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new On("internal-error")}},hl={endpoint:"resetPassword",B:Fi,da:"email"},ll={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},fl={endpoint:"setAccountInfo",T:["idToken"],B:_i,R:!0},dl={endpoint:"setAccountInfo",T:["idToken"],B:function(t){if(_i(t),!t.password)throw new On("weak-password")},J:Di,R:!0},pl={endpoint:"signupNewUser",J:Di,R:!0},ml={endpoint:"verifyAssertion",B:Li,J:Pi,R:!0},yl={endpoint:"verifyAssertion",B:Li,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new On("user-not-found");if(t.errorMessage)throw qi(t.errorMessage);if(!t[qh])throw new On("internal-error")},R:!0},gl={endpoint:"verifyAssertion",B:function(t){if(Li(t),!t.idToken)throw new On("internal-error")},J:Pi,R:!0},vl={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new On("invalid-custom-token")},J:Di,R:!0},bl={endpoint:"verifyPassword",B:function(t){if(Ai(t),!t.password)throw new On("wrong-password")},J:Di,R:!0},wl={endpoint:"verifyPhoneNumber",B:Oi,J:Di},El={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new On("internal-error");Oi(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",_r(t);Di(t)}},Tl={Tb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:Oi,J:Di},Il={Yc:{Za:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",fb:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{Za:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",fb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{Za:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",fb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};Xh=Wi("__EID__")?"__EID__":void 0;var Sl=ve("https://apis.google.com/js/api.js?onload=%{onload}"),Al=new vn(3e4,6e4),_l=new vn(5e3,15e3),kl=null;Xi.prototype.toString=function(){return this.f?ee(this.a,"v",this.f):le(this.a.a,"v"),this.b?ee(this.a,"eid",this.b):le(this.a.a,"eid"),this.c.length?ee(this.a,"fw",this.c.join(",")):le(this.a.a,"fw"),this.a.toString()},Yi.prototype.toString=function(){var t=ie(this.o,"/__/auth/handler");if(ee(t,"apiKey",this.l),ee(t,"appName",this.c),ee(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=Su.app(this.c).auth().ea()}catch(t){n=null}e.Ya=n,ee(t,"providerId",this.a.providerId),e=this.a,n=dn(e.vb);for(var r in n)n[r]=n[r].toString();r=e.Ac,n=V(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.$a&&e.Ya&&!n[e.$a]&&(n[e.$a]=e.Ya),F(n)||ee(t,"customParameters",fn(n))}if("function"==typeof this.a.Ab&&(e=this.a.Ab(),e.length&&ee(t,"scopes",e.join(","))),this.i?ee(t,"redirectUrl",this.i):le(t.a,"redirectUrl"),this.g?ee(t,"eventId",this.g):le(t.a,"eventId"),this.h?ee(t,"v",this.h):le(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!ne(t,a)&&ee(t,a,this.b[a]);return this.f?ee(t,"eid",this.f):le(t.a,"eid"),a=Ji(this.c),a.length&&ee(t,"fw",a.join(",")),t.toString()},Iu=$i.prototype,Iu.Ea=function(t,e,n){var r=new On("popup-closed-by-user"),i=new On("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){io(o).then(function(n){n||(t&&He(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return Qe(t)}).then(function(){if(!a)return Wt(n).then(function(){e(r)})})},Iu.Ib=function(){var t=on();return!ln(t)&&!yn(t)},Iu.Db=function(){return!1},Iu.zb=function(t,e,n,r,i,o,a){if(!t)return J(new On("popup-blocked"));if(a&&!ln())return this.ga().s(function(e){He(t),i(e)}),r(),Y();this.a||(this.a=Zi(eo(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw He(t),i(e),e});return r(),e}).then(function(){if(wr(n),!a){qe(no(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},Iu.Ca=function(t,e,n){this.a||(this.a=Zi(eo(this)));var r=this;return this.a.then(function(){wr(e),qe(no(r.l,r.f,r.b,t,e,Ve(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},Iu.ga=function(){var t=this;return to(this).then(function(){return t.i.bb}).s(function(){throw t.a=null,new On("network-request-failed")})},Iu.Mb=function(){return!0},Iu.va=function(t){this.g.push(t)},Iu.Ka=function(t){D(this.g,function(e){return e==t})},Iu=oo.prototype,Iu.get=function(t){return Y(this.a.getItem(t)).then(function(t){return t&&pn(t)})},Iu.set=function(t,e){return Y(this.a.setItem(t,fn(e)))},Iu.P=function(t){return Y(this.a.removeItem(t))},Iu.Y=function(){},Iu.ca=function(){};var Nl;Iu=ao.prototype,Iu.set=function(t,e){var n,r=!1,i=this;return co(this).then(function(e){return n=e,e=lo(fo(n,!0)),po(e.get(t))}).then(function(o){var a=lo(fo(n,!0));return o?(o.value=e,po(a.put(o))):(i.b++,r=!0,o={},o.fbase_key=t,o.value=e,po(a.add(o)))}).then(function(){i.f[t]=e}).ia(function(){r&&i.b--})},Iu.get=function(t){return co(this).then(function(e){return po(lo(fo(e,!1)).get(t))}).then(function(t){return t&&t.value})},Iu.P=function(t){var e=!1,n=this;return co(this).then(function(r){return e=!0,n.b++,po(lo(fo(r,!0)).delete(t))}).then(function(){delete n.f[t]}).ia(function(){e&&n.b--})},Iu.Kc=function(){var t=this;return co(this).then(function(t){var e=lo(fo(t,!1));return e.getAll?po(e.getAll()):new Q(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(Error(t.target.errorCode))}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=je(t.f,n),t.f=n}return r})},Iu.Y=function(t){0==this.a.length&&mo(this),this.a.push(t)},Iu.ca=function(t){D(this.a,function(e){return e==t}),0==this.a.length&&this.c&&this.c.cancel("STOP_EVENT")},Iu=yo.prototype,Iu.get=function(t){return this.b.then(function(e){return e.get(t)})},Iu.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},Iu.P=function(t){return this.b.then(function(e){return e.P(t)})},Iu.Y=function(t){this.a.push(t)},Iu.ca=function(t){D(this.a,function(e){return e==t})},Iu=go.prototype,Iu.get=function(t){return Y(this.a[t])},Iu.set=function(t,e){return this.a[t]=e,Y()},Iu.P=function(t){return delete this.a[t],Y()},Iu.Y=function(){},Iu.ca=function(){},Iu=vo.prototype,Iu.get=function(t){var e=this;return Y().then(function(){return pn(e.a.getItem(t))})},Iu.set=function(t,e){var n=this;return Y().then(function(){var r=fn(e);null===r?n.P(t):n.a.setItem(t,r)})},Iu.P=function(t){var e=this;return Y().then(function(){e.a.removeItem(t)})},Iu.Y=function(t){_u.window&&_t(_u.window,"storage",t)},Iu.ca=function(t){_u.window&&Dt(_u.window,"storage",t)},Iu=Eo.prototype,Iu.get=function(){return Y(null)},Iu.set=function(){return Y()},Iu.P=function(){return Y()},Iu.Y=function(){},Iu.ca=function(){},Iu=To.prototype,Iu.get=function(t){var e=this;return Y().then(function(){return pn(e.a.getItem(t))})},Iu.set=function(t,e){var n=this;return Y().then(function(){var r=fn(e);null===r?n.P(t):n.a.setItem(t,r)})},Iu.P=function(t){var e=this;return Y().then(function(){e.a.removeItem(t)})},Iu.Y=function(){},Iu.ca=function(){};var Cl,Dl,Ol={A:vo,Qa:To},Rl={A:vo,Qa:To},xl={A:oo,Qa:Eo},Ll={A:vo,Qa:Eo},Pl={Xc:"local",NONE:"none",Zc:"session"};Iu=ko.prototype,Iu.get=function(t,e){return Co(this,t.A).get(Do(t,e))},Iu.set=function(t,e,n){var r=Do(t,n),i=this,o=Co(this,t.A);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.A&&(i.b[r]=e)})},Iu.addListener=function(t,e,n){t=Do(t,e),this.m&&(this.b[t]=_u.localStorage.getItem(t)),F(this.a)&&(Co(this,"local").Y(this.f),this.h||(Fe()||!Tn())&&_u.indexedDB||!this.m||xo(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},Iu.removeListener=function(t,e,n){t=Do(t,e),this.a[t]&&(D(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),F(this.a)&&(Co(this,"local").ca(this.f),Lo(this))},Iu.Lb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=_u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Wa(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Co(this,"local").ca(this.f):Lo(this),this.o)if(n=_u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?_u.localStorage.setItem(e,r):_u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===_u.localStorage.getItem(e)||(o.b[e]=_u.localStorage.getItem(e),o.Wa(e))},ac&&pc&&10==pc&&_u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else xu(t,d(this.Wa,this))},Iu.Wa=function(t){this.a[t]&&xu(this.a[t],function(t){t()})};var Ml,Bl={name:"authEvent",A:"local"};m(Fo,Uo);for(var Ul=64,Fl=Ul-1,Vl=[],ql=0;ql<Fl;ql++)Vl[ql]=0;var jl=O(128,Vl);Fo.prototype.reset=function(){this.g=this.c=0,this.a=_u.Int32Array?new Int32Array(this.h):R(this.h)};var Wl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];m(jo,Fo);var Kl=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];Iu=Wo.prototype,Iu.ga=function(){return this.za?this.za:this.za=Xe().then(function(){if("function"!=typeof an("universalLinks.subscribe",_u))throw Ko("cordova-universal-links-plugin is not installed");if(void 0===an("BuildInfo.packageName",_u))throw Ko("cordova-plugin-buildinfo is not installed");if("function"!=typeof an("cordova.plugins.browsertab.openUrl",_u))throw Ko("cordova-plugin-browsertab is not installed");if("function"!=typeof an("cordova.InAppBrowser.open",_u))throw Ko("cordova-plugin-inappbrowser is not installed")},function(){throw new On("cordova-not-ready")})},Iu.Ea=function(t,e){return e(new On("operation-not-supported-in-this-environment")),Y()},Iu.zb=function(){return J(new On("operation-not-supported-in-this-environment"))},Iu.Mb=function(){return!1},Iu.Ib=function(){return!0},Iu.Db=function(){return!0},Iu.Ca=function(t,e,n){if(this.c)return J(new On("redirect-operation-pending"));var r=this,i=_u.document,o=null,a=null,s=null,u=null;return this.c=Y().then(function(){return wr(e),Xo(r)}).then(function(){return Qo(r,t,e,n)}).then(function(){return new Q(function(t,e){a=function(){var e=an("cordova.plugins.browsertab.close",_u);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.va(a),s=function(){o||(o=Wt(2e3).then(function(){e(new On("redirect-cancelled-by-user"))}))},u=function(){bn()&&s()},i.addEventListener("resume",s,!1),on().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).s(function(t){return Yo(r).then(function(){throw t})})}).ia(function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ka(a),r.c=null})},Iu.va=function(t){this.b.push(t),Xo(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Er("unknown",null,null,null,new On("no-auth-event")),t(e))})},Iu.Ka=function(t){D(this.b,function(e){return e==t})};var Hl={name:"pendingRedirect",A:"session"};na.prototype.reset=function(){this.f=!1,this.a.Ka(this.i),this.a=ra(this.v,this.m,this.l)},na.prototype.subscribe=function(t){if(N(this.h,t)||this.h.push(t),!this.f){var e=this;ea(this.g).then(function(t){t?ta(e.g).then(function(){ia(e).s(function(t){var n=new Er("unknown",null,null,null,new On("operation-not-supported-in-this-environment"));sa(t)&&e.o(n)})}):oa(e)}).s(function(){oa(e)})}},na.prototype.unsubscribe=function(t){D(this.h,function(e){return e==t})},na.prototype.o=function(t){if(!t)throw new On("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.sb(t.b,t.c)){(e=this.b[t.b])&&e.h(t,r),e=!0;break}}return ha(this.c),e};var Gl=new vn(2e3,1e4),Ql=new vn(3e4,6e4);na.prototype.fa=function(){return this.c.fa()},na.prototype.Ca=function(t,e,n){var r,i=this;return Zo(this.g).then(function(){return i.a.Ca(t,e,n).s(function(t){if(sa(t))throw new On("operation-not-supported-in-this-environment");return r=t,ta(i.g).then(function(){throw r})}).then(function(){return i.a.Mb()?new Q(function(){}):ta(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},na.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},Gl.get())};var zl={};ca.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},ca.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;"unknown"!=n||i||o?t.a?(pa(this,!0,null,t.a),Y()):e.wa(n,r)?la(this,t,e):J(new On("invalid-auth-event")):(pa(this,!1,null,null),Y())}else J(new On("invalid-auth-event"))},ca.prototype.fa=function(){var t=this;return new Q(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),ma(t))})},ya.prototype.h=function(t,e){if(t){var n=t.b,r=t.c;t.a?(e.ha(t.b,null,t.a,t.c),Y()):e.wa(n,r)?ga(t,e):J(new On("invalid-auth-event"))}else J(new On("invalid-auth-event"))},ba.prototype.confirm=function(t){return t=vr(this.verificationId,t),this.a(t)},Ta.prototype.start=function(){this.a=this.c,Sa(this,!0)},Ta.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Aa.prototype.D=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Aa.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?J(new On("user-token-expired")):t||!this.b||Cu()>this.c-3e4?this.a?Ca(this,{grant_type:"refresh_token",refresh_token:this.a}):Y(null):Y({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Da.prototype.D=function(){return{lastLoginAt:this.b,createdAt:this.a}},m(xa,bt),m(La,Ut),La.prototype.oa=function(t){this.ka=t,bi(this.b,t)},La.prototype.ea=function(){return this.ka},La.prototype.xa=function(){return R(this.O)},La.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},Sn(La.prototype,"providerId","firebase"),Iu=La.prototype,Iu.reload=function(){var t=this;return hs(this,za(this).then(function(){return ts(t).then(function(){return Ka(t)}).then(Qa)}))},Iu.ac=function(t){return this.F(t).then(function(t){return new Ea(t)})},Iu.F=function(t){var e=this;return hs(this,za(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new On("internal-error");return t.accessToken!=e.qa&&(ja(e,t.accessToken),e.dispatchEvent(new xa("tokenChanged"))),$a(e,"refreshToken",t.refreshToken),t.accessToken}))},Iu.uc=function(t){if(!(t=t.users)||!t.length)throw new On("internal-error");t=t[0],Ga(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=rs(t),n=0;n<e.length;n++)Ya(this,e[n]);$a(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},Iu.cb=function(t){var e=this,n=null;return hs(this,t.f(this.b,this.uid).then(function(t){return es(e,t),n=os(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},Iu.vc=function(t){return In("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.cb(t).then(function(){})},Iu.ab=function(t){var e=this,n=null;return hs(this,is(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.c(e.b,n)}).then(function(t){return n=os(e,t,"link"),as(e,t)}).then(function(){return n}))},Iu.mc=function(t){return In("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.ab(t).then(function(t){return t.user})},Iu.nc=function(t,e){var n=this;return hs(this,is(this,"phone").then(function(){return wa(Ua(n),t,e,d(n.ab,n))}))},Iu.wc=function(t,e){var n=this;return hs(this,Y().then(function(){return wa(Ua(n),t,e,d(n.cb,n))}),!0)},Iu.mb=function(t){var e=this;return hs(this,this.F().then(function(n){return e.b.mb(n,t)}).then(function(t){return es(e,t),e.reload()}))},Iu.Pc=function(t){var e=this;return hs(this,this.F().then(function(n){return t.c(e.b,n)}).then(function(t){return es(e,t),e.reload()}))},Iu.nb=function(t){var e=this;return hs(this,this.F().then(function(n){return e.b.nb(n,t)}).then(function(t){return es(e,t),e.reload()}))},Iu.ob=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return za(this);var e=this;return hs(this,this.F().then(function(n){return e.b.ob(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return es(e,t),$a(e,"displayName",t.displayName||null),$a(e,"photoURL",t.photoUrl||null),xu(e.providerData,function(t){"password"===t.providerId&&(Sn(t,"displayName",e.displayName),Sn(t,"photoURL",e.photoURL))}),Ka(e)}).then(Qa))},Iu.Nc=function(t){var e=this;return hs(this,ts(this).then(function(n){return N(Xa(e),t)?xi(e.b,n,[t]).then(function(t){var n={};return xu(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),xu(Xa(e),function(t){n[t]||Ja(e,t)}),n[gr.PROVIDER_ID]||Sn(e,"phoneNumber",null),Ka(e)}):Ka(e).then(function(){throw new On("no-such-provider")})}))},Iu.delete=function(){var t=this;return hs(this,this.F().then(function(e){return Vi(t.b,tl,{idToken:e})}).then(function(){t.dispatchEvent(new xa("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");Pa(t,null),Ba(t,null),t.G=[],t.C=!0,qa(t),Sn(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},Iu.sb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},Iu.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},Iu.wa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?d(this.xb,this):"reauthViaPopup"==t&&e==(this.g||null)?d(this.yb,this):"linkViaRedirect"==t&&(this.aa||null)==e?d(this.xb,this):"reauthViaRedirect"==t&&(this.aa||null)==e?d(this.yb,this):null},Iu.oc=function(t){var e=this;return ss(this,"linkViaPopup",t,function(){return is(e,t.providerId).then(function(){return Ka(e)})},!1)},Iu.xc=function(t){return ss(this,"reauthViaPopup",t,function(){return Y()},!0)},Iu.pc=function(t){var e=this;return us(this,"linkViaRedirect",t,function(){return is(e,t.providerId)},!1)},Iu.yc=function(t){return us(this,"reauthViaRedirect",t,function(){return Y()},!0)},Iu.xb=function(t,e){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return hs(this,this.F().then(function(r){return Bi(n.b,{requestUri:t,sessionId:e,idToken:r})}).then(function(t){return r=os(n,t,"link"),as(n,t)}).then(function(){return r}))},Iu.yb=function(t,e){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return hs(this,Y().then(function(){return $n(Ui(n.b,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return r=os(n,t,"reauthenticate"),es(n,t),n.i=null,n.reload()}).then(function(){return r}),!0)},Iu.gb=function(t){var e=this,n=null;return hs(this,this.F().then(function(e){return n=e,void 0===t||F(t)?{}:Ln(new xn(t))}).then(function(t){return e.b.gb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},Iu.toJSON=function(){return this.D()},Iu.D=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.D(),redirectEventId:this.aa||null};return this.metadata&&q(t,this.metadata.D()),xu(this.providerData,function(e){t.providerData.push(kn(e))}),t};var Xl={name:"redirectUser",A:"session"};vs.prototype.g=function(){var t=this,e=Es("local");_s(this,function(){return Y().then(function(){return t.c&&"local"!=t.c.A?t.b.get(e,t.a):null}).then(function(n){if(n)return bs(t,"local").then(function(){t.c=e})})})};var Yl={name:"persistence",A:"session"};vs.prototype.jb=function(t){var e=null,n=this;return _o(t),_s(this,function(){return t!=n.c.A?n.b.get(n.c,n.a).then(function(r){return e=r,bs(n,t)}).then(function(){if(n.c=Es(t),e)return n.b.set(n.c,e,n.a)}):Y()})},m(ks,Ut),m(Ns,bt),m(Cs,bt),Iu=ks.prototype,Iu.jb=function(t){return t=this.h.jb(t),Ks(this,t)},Iu.oa=function(t){this.W===t||this.l||(this.W=t,bi(this.b,this.W),this.dispatchEvent(new Ns(this.ea())))},Iu.ea=function(){return this.W},Iu.Qc=function(){var t=_u.navigator;this.oa(t?t.languages&&t.languages[0]||t.language||t.userLanguage||null:null)},Iu.qc=function(t){this.G.push(t),wi(this.b,Su.SDK_VERSION?rn(Su.SDK_VERSION,this.G):null),this.dispatchEvent(new Cs(this.G))},Iu.xa=function(){return R(this.G)},Iu.toJSON=function(){return{apiKey:Fs(this).options.apiKey,authDomain:Fs(this).options.authDomain,appName:Fs(this).name,currentUser:Vs(this)&&Vs(this).D()}},Iu.sb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},Iu.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},Iu.wa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?d(this.Xb,this):null},Iu.Xb=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var r=null,i=null,o=Mi(n.b,t).then(function(t){return r=br(t),i=Wn(t),t});return t=n.V.then(function(){return o}).then(function(t){return xs(n,t)}).then(function(){return _n({user:Vs(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}),Ks(this,t)},Iu.Hc=function(t){if(!un())return J(new On("operation-not-supported-in-this-environment"));var e=this,n=jn(t.providerId),r=mn(),i=null;(!ln()||Je())&&Fs(this).options.authDomain&&t.isOAuthProvider&&(i=no(Fs(this).options.authDomain,Fs(this).options.apiKey,Fs(this).name,"signInViaPopup",t,null,r,Su.SDK_VERSION||null));var o=Ge(i,n&&n.Ba,n&&n.Aa);return n=Os(this).then(function(e){return aa(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new Q(function(t,n){e.ha("signInViaPopup",null,new On("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.c=e.a.Ea(e,"signInViaPopup",o,r)})}).then(function(t){return o&&He(o),t?_n(t):null}).s(function(t){throw o&&He(o),t}),Ks(this,n)},Iu.Ic=function(t){if(!un())return J(new On("operation-not-supported-in-this-environment"));var e=this;return Ks(this,Os(this).then(function(){return Ts(e.h)}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},Iu.fa=function(){if(!un())return J(new On("operation-not-supported-in-this-environment"));var t=this;return Ks(this,Os(this).then(function(){return t.a.fa()}).then(function(t){return t?_n(t):null}))},Iu.Oc=function(t){if(!t)return J(new On("null-user"));var e=this,n={};n.apiKey=Fs(this).options.apiKey,n.authDomain=Fs(this).options.authDomain,n.appName=Fs(this).name;var r=ps(t,n,e.w,e.xa());return Ks(this,this.i.then(function(){if(Fs(e).options.apiKey!=t.l)return r.reload()}).then(function(){return Vs(e)&&t.uid==Vs(e).uid?(Za(Vs(e),t),e.Z(t)):(Ls(e,r),Ha(r),e.Z(r))}).then(function(){js(e)}))},Iu.kb=function(){var t=this;return Ks(this,this.i.then(function(){return Vs(t)?(Ls(t,null),Ss(t.h).then(function(){js(t)})):Y()}))},Iu.Jc=function(){var t=this;return As(this.h,Fs(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=Vs(t)&&e){n=Vs(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Za(Vs(t),e),Vs(t).F();(Vs(t)||e)&&(Ls(t,e),e&&(Ha(e),e.ba=t.w),t.a&&t.a.subscribe(t),js(t))}})},Iu.Z=function(t){return Is(this.h,t)},Iu.Yb=function(){js(this),this.Z(Vs(this))},Iu.gc=function(){this.kb()},Iu.hc=function(){this.kb()},Iu.ic=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Vs(e))})},Iu.jc=function(t){var e=this;Ws(this,function(){t.next(Vs(e))})},Iu.sc=function(t,e,n){var r=this;return this.X&&Su.Promise.resolve().then(function(){c(t)?t(Vs(r)):c(t.next)&&t.next(Vs(r))}),this.Pb(t,e,n)},Iu.rc=function(t,e,n){var r=this;return this.X&&Su.Promise.resolve().then(function(){r.O=r.getUid(),c(t)?t(Vs(r)):c(t.next)&&t.next(Vs(r))}),this.Qb(t,e,n)},Iu.$b=function(t){var e=this;return Ks(this,this.i.then(function(){return Vs(e)?Vs(e).F(t).then(function(t){return{accessToken:t}}):null}))},Iu.Jb=function(t){var e=this;return this.i.then(function(){return Us(e,Vi(e.b,vl,{token:t}))}).then(function(t){var n=t.user;return $a(n,"isAnonymous",!1),e.Z(n),t})},Iu.Bc=function(t){return In("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Jb(t)},Iu.Cc=function(t,e){return In("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Kb(t,e)},Iu.Kb=function(t,e){var n=this;return this.i.then(function(){return Us(n,Vi(n.b,bl,{email:t,password:e}))})},Iu.ub=function(t,e){var n=this;return this.i.then(function(){return Us(n,Vi(n.b,$h,{email:t,password:e}))})},Iu.Sb=function(t,e){return In("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.ub(t,e)},Iu.Ec=function(t){return In("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Oa(t).then(function(t){return t.user})},Iu.Oa=function(t){var e=this;return this.i.then(function(){return Us(e,t.ya(e.b))})},Iu.Pa=function(){var t=this;return this.i.then(function(){var e=Vs(t);if(e&&e.isAnonymous){return _n({user:e,credential:null,additionalUserInfo:_n({providerId:null,isNewUser:!1}),operationType:"signIn"})}return Us(t,t.b.Pa()).then(function(e){var n=e.user;return $a(n,"isAnonymous",!0),t.Z(n),e})})},Iu.Dc=function(){return In("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Pa()},Iu.getUid=function(){return Vs(this)&&Vs(this).uid||null},Iu.Rb=function(t){this.addAuthTokenListener(t),0<++this.u&&Vs(this)&&Va(Vs(this))},Iu.zc=function(t){var e=this;xu(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&Vs(this)&&qa(Vs(this)),this.removeAuthTokenListener(t)},Iu.addAuthTokenListener=function(t){var e=this;this.o.push(t),Ks(this,this.i.then(function(){e.l||N(e.o,t)&&t(qs(e))}))},Iu.removeAuthTokenListener=function(t){D(this.o,function(e){return e==t})},Iu.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h,t.b.removeListener(Es("local"),t.a,this.ka)),this.a&&this.a.unsubscribe(this),Su.Promise.resolve()},Iu.Vb=function(t){return In("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),Ks(this,ki(this.b,t))},Iu.Wb=function(t){return Ks(this,Ni(this.b,t))},Iu.kc=function(t){return!!pr(t)},Iu.ib=function(t,e){var n=this;return Ks(this,Y().then(function(){var t=new xn(e);if(!t.c)throw new On("argument-error",ch+" must be true when sending sign in link to email");return Ln(t)}).then(function(e){return n.b.ib(t,e)}).then(function(){}))},Iu.Rc=function(t){return this.Ja(t).then(function(t){return t.data.email})},Iu.Xa=function(t,e){return Ks(this,this.b.Xa(t,e).then(function(){}))},Iu.Ja=function(t){return Ks(this,this.b.Ja(t).then(function(t){return new Dn(t)}))},Iu.Va=function(t){return Ks(this,this.b.Va(t).then(function(){}))},Iu.hb=function(t,e){var n=this;return Ks(this,Y().then(function(){return void 0===e||F(e)?{}:Ln(new xn(e))}).then(function(e){return n.b.hb(t,e)}).then(function(){}))},Iu.Gc=function(t,e){return Ks(this,wa(this,t,e,d(this.Oa,this)))},Iu.Fc=function(t,e){var n=this;return Ks(this,Y().then(function(){var r=dr(t,e||Ve());return n.Oa(r)}))},Hs.prototype.render=function(){},Hs.prototype.reset=function(){},Hs.prototype.getResponse=function(){},Hs.prototype.execute=function(){};var Jl=null;Gs.prototype.render=function(t,e){return this.a[this.b.toString()]=new Xs(t,e),this.b++},Gs.prototype.reset=function(t){var e=Qs(this,t);t=zs(t),e&&t&&(e.delete(),delete this.a[t])},Gs.prototype.getResponse=function(t){return(t=Qs(this,t))?t.getResponse():null},Gs.prototype.execute=function(t){(t=Qs(this,t))&&t.execute()},Xs.prototype.getResponse=function(){return Ys(this),this.b},Xs.prototype.execute=function(){Ys(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=en();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},Xs.prototype.delete=function(){Ys(this),this.g=!0,clearTimeout(this.a),this.a=null,Dt(this.f,"click",this.i)},Js.prototype.g=function(){return Jl||(Jl=new Gs),Y(Jl)},Js.prototype.c=function(){};var $l=null,Zl=ve("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),tf=new vn(3e4,6e4);$s.prototype.g=function(t){var e=this;return new Q(function(n,r){var i=setTimeout(function(){r(new On("network-request-failed"))},tf.get());if(!_u.grecaptcha||t!==e.f&&!e.b){_u[e.a]=function(){if(_u.grecaptcha){e.f=t;var o=_u.grecaptcha.render;_u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(_u.grecaptcha)}else clearTimeout(i),r(new On("internal-error"));delete _u[e.a]};Y(fi(Ee(Zl,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(i),r(new On("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(i),n(_u.grecaptcha)})},$s.prototype.c=function(){this.b--};var ef=null,nf="callback",rf="expired-callback",of="sitekey",af="size";Iu=Zs.prototype,Iu.za=function(){var t=this;return this.f?this.f:this.f=nu(this,Y().then(function(){if(cn()&&!$e())return ze();throw new On("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,Vi(t.u,cl,{})}).then(function(e){t.a[of]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},Iu.render=function(){ru(this);var t=this;return nu(this,this.za().then(function(){if(null===t.c){var e=t.l;if(!t.i){var n=De(e);e=Re("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},Iu.verify=function(){ru(this);var t=this;return nu(this,this.render().then(function(e){return new Q(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function e(r){r&&(eu(t,e),n(r))};t.m.push(i),t.i&&t.g.execute(t.c)}})}))},Iu.reset=function(){ru(this),null!==this.c&&this.g.reset(this.c)},Iu.clear=function(){ru(this),this.C=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=De(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},m(iu,Zs);var sf="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");vu(ks.prototype,{Va:{name:"applyActionCode",j:[au("code")]},Ja:{name:"checkActionCode",j:[au("code")]},Xa:{name:"confirmPasswordReset",j:[au("code"),au("newPassword")]},ub:{name:"createUserWithEmailAndPassword",j:[au("email"),au("password")]},Sb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[au("email"),au("password")]},Vb:{name:"fetchProvidersForEmail",j:[au("email")]},Wb:{name:"fetchSignInMethodsForEmail",j:[au("email")]},fa:{name:"getRedirectResult",j:[]},kc:{name:"isSignInWithEmailLink",j:[au("emailLink")]},rc:{name:"onAuthStateChanged",j:[gu(uu(),cu(),"nextOrObserver"),cu("opt_error",!0),cu("opt_completed",!0)]},sc:{name:"onIdTokenChanged",j:[gu(uu(),cu(),"nextOrObserver"),cu("opt_error",!0),cu("opt_completed",!0)]},hb:{name:"sendPasswordResetEmail",j:[au("email"),gu(uu("opt_actionCodeSettings",!0),hu(null,!0),"opt_actionCodeSettings",!0)]},ib:{name:"sendSignInLinkToEmail",j:[au("email"),uu("actionCodeSettings")]},jb:{name:"setPersistence",j:[au("persistence")]},Oa:{name:"signInAndRetrieveDataWithCredential",j:[pu()]},Pa:{name:"signInAnonymously",j:[]},Dc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Ec:{name:"signInWithCredential",j:[pu()]},Jb:{name:"signInWithCustomToken",j:[au("token")]},Bc:{name:"signInAndRetrieveDataWithCustomToken",j:[au("token")]},Kb:{name:"signInWithEmailAndPassword",j:[au("email"),au("password")]},Fc:{name:"signInWithEmailLink",j:[au("email"),au("emailLink",!0)]},Cc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[au("email"),au("password")]},Gc:{name:"signInWithPhoneNumber",j:[au("phoneNumber"),yu()]},Hc:{name:"signInWithPopup",j:[mu()]},Ic:{name:"signInWithRedirect",j:[mu()]},Oc:{name:"updateCurrentUser",j:[gu(function(t){return{name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof La)}}}(),hu(),"user")]},kb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[au(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[au("code")]}}),bu(ks.prototype,{lc:{name:"languageCode",qb:gu(au(),hu(),"languageCode")}}),ks.Persistence=Pl,ks.Persistence.LOCAL="local",ks.Persistence.SESSION="session",ks.Persistence.NONE="none",vu(La.prototype,{delete:{name:"delete",j:[]},ac:{name:"getIdTokenResult",j:[su("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[su("opt_forceRefresh",!0)]},ab:{name:"linkAndRetrieveDataWithCredential",j:[pu()]},mc:{name:"linkWithCredential",j:[pu()]},nc:{name:"linkWithPhoneNumber",j:[au("phoneNumber"),yu()]},oc:{name:"linkWithPopup",j:[mu()]},pc:{name:"linkWithRedirect",j:[mu()]},cb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[pu()]},vc:{name:"reauthenticateWithCredential",j:[pu()]},wc:{name:"reauthenticateWithPhoneNumber",j:[au("phoneNumber"),yu()]},xc:{name:"reauthenticateWithPopup",j:[mu()]},yc:{name:"reauthenticateWithRedirect",j:[mu()]},reload:{name:"reload",j:[]},gb:{name:"sendEmailVerification",j:[gu(uu("opt_actionCodeSettings",!0),hu(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[au(null,!0)]},Nc:{name:"unlink",j:[au("provider")]},mb:{name:"updateEmail",j:[au("email")]},nb:{name:"updatePassword",j:[au("password")]},Pc:{name:"updatePhoneNumber",j:[pu("phone")]},ob:{name:"updateProfile",j:[uu("profile")]}}),vu(Gs.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),vu(Hs.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),vu(Q.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),bu(va.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",qb:su("appVerificationDisabledForTesting")}}),vu(ba.prototype,{confirm:{name:"confirm",j:[au("verificationCode")]}}),wu(fr,"credential",function(t,e){return new lr(t,e)},[au("email"),au("password")]),vu(rr.prototype,{ta:{name:"addScope",j:[au("scope")]},Da:{name:"setCustomParameters",j:[uu("customOAuthParameters")]}}),wu(rr,"credential",ir,[gu(au(),uu(),"token")]),wu(fr,"credentialWithLink",dr,[au("email"),au("emailLink")]),vu(or.prototype,{ta:{name:"addScope",j:[au("scope")]},Da:{name:"setCustomParameters",j:[uu("customOAuthParameters")]}}),wu(or,"credential",ar,[gu(au(),uu(),"token")]),vu(sr.prototype,{ta:{name:"addScope",j:[au("scope")]},Da:{name:"setCustomParameters",j:[uu("customOAuthParameters")]}}),wu(sr,"credential",ur,[gu(au(),gu(uu(),hu()),"idToken"),gu(au(),hu(),"accessToken",!0)]),vu(cr.prototype,{Da:{name:"setCustomParameters",j:[uu("customOAuthParameters")]}}),wu(cr,"credential",hr,[gu(au(),uu(),"token"),au("secret",!0)]),vu(nr.prototype,{ta:{name:"addScope",j:[au("scope")]},credential:{name:"credential",j:[gu(au(),hu(),"idToken",!0),gu(au(),hu(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[uu("customOAuthParameters")]}}),wu(gr,"credential",vr,[au("verificationId"),au("verificationCode")]),vu(gr.prototype,{Ta:{name:"verifyPhoneNumber",j:[au("phoneNumber"),yu()]}}),vu(On.prototype,{toJSON:{name:"toJSON",j:[au(null,!0)]}}),vu(Ar.prototype,{toJSON:{name:"toJSON",j:[au(null,!0)]}}),vu(Sr.prototype,{toJSON:{name:"toJSON",j:[au(null,!0)]}}),vu(iu.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===Su||!Su.INTERNAL||!Su.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:ks,Error:On};wu(t,"EmailAuthProvider",fr,[]),wu(t,"FacebookAuthProvider",rr,[]),wu(t,"GithubAuthProvider",or,[]),wu(t,"GoogleAuthProvider",sr,[]),wu(t,"TwitterAuthProvider",cr,[]),wu(t,"OAuthProvider",nr,[au("providerId")]),wu(t,"PhoneAuthProvider",gr,[fu()]),wu(t,"RecaptchaVerifier",iu,[gu(au(),lu(),"recaptchaContainer"),uu("recaptchaParameters",!0),du()]),Su.INTERNAL.registerService("auth",function(t,e){return t=new ks(t),e({INTERNAL:{getUid:d(t.getUid,t),getToken:d(t.$b,t),addAuthTokenListener:d(t.Rb,t),removeAuthTokenListener:d(t.zc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),Su.INTERNAL.extendNamespace({User:La})}()}).call(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(e,n(1))},function(t,e,n){"use strict";n(48)},function(t,e,n){"use strict";(function(t){function r(){return se.logLevel===re.LogLevel.DEBUG?ee.DEBUG:se.logLevel===re.LogLevel.SILENT?ee.SILENT:ee.ERROR}function i(t){switch(t){case ee.DEBUG:se.logLevel=re.LogLevel.DEBUG;break;case ee.ERROR:se.logLevel=re.LogLevel.ERROR;break;case ee.SILENT:se.logLevel=re.LogLevel.SILENT;break;default:se.error("Firestore ("+ae+"): Invalid value passed to `setLogLevel`")}}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(se.logLevel<=re.LogLevel.DEBUG){var i=n.map(s);se.debug.apply(se,["Firestore ("+ae+") ["+t+"]: "+e].concat(i))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(se.logLevel<=re.LogLevel.ERROR){var r=e.map(s);se.error.apply(se,["Firestore ("+ae+"): "+t].concat(r))}}function s(t){if("string"==typeof t)return t;var e=ue.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function u(t){var e="FIRESTORE ("+ae+") INTERNAL ASSERTION FAILED: "+t;throw a(e),new Error(e)}function c(t,e){t||u(e)}function h(){return ue.getPlatform().emptyByteString}function l(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new he(ce.INVALID_ARGUMENT,t)}n.prototype=t.prototype;for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function d(t,e){return void 0!==t?t:e}function p(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function m(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function y(t){c(null!=t&&"object"===(void 0===t?"undefined":te(t)),"isEmpty() expects object parameter.");for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function g(t){c(t&&"object"===(void 0===t?"undefined":te(t)),"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function v(t,e,n){if(e.length!==n)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires "+U(n,"argument")+", but was called with "+U(e.length,"argument")+".")}function b(t,e,n){if(e.length<n)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires at least "+U(n,"argument")+", but was called with "+U(e.length,"argument")+".")}function w(t,e,n,r){if(e.length<n||e.length>r)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+U(e.length,"argument")+".")}function E(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+U(r,"element")+".")}function T(t,e,n,r){D(t,e,B(n)+" argument",r)}function I(t,e,n,r){void 0!==r&&T(t,e,n,r)}function S(t,e,n,r){D(t,e,n+" option",r)}function A(t,e,n,r){void 0!==r&&S(t,e,n,r)}function _(t,e,n,r,i){if(!(r instanceof Array))throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+R(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+R(r[o]))}function k(t,e,n,r,i){void 0!==r&&_(t,e,n,r,i)}function N(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(R(u))}var c=R(r);throw new he(ce.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function C(t,e,n,r,i){void 0!==r&&N(t,e,n,r,i)}function D(t,e,n,r){if((void 0===r?"undefined":te(r))!==e||"object"===e&&!O(r)){var i=R(r);throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function O(t){return"object"===(void 0===t?"undefined":te(t))&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function R(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"===(void 0===t?"undefined":te(t))){if(t instanceof Array)return"an array";var e=x(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":u("Unknown wrong type: "+(void 0===t?"undefined":te(t)))}function x(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(t.constructor.toString());if(n&&n.length>1)return n[1]}return null}function L(t,e,n){if(void 0===n)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+B(e)+" argument, but it was undefined.")}function P(t,e,n){m(e,function(e,r){if(n.indexOf(e)<0)throw new he(ce.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function M(t,e,n,r){var i=R(r);return new he(ce.INVALID_ARGUMENT,"Function "+t+"() requires its "+B(n)+" argument to be a "+e+", but it was: "+i)}function B(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function U(t,e){return t+" "+e+(1===t?"":"s")}function F(t,e){return t<e?-1:t>e?1:0}function V(t,e){return null!==t&&void 0!==t?!(!e||!t.isEqual(e)):t===e}function q(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function j(t){var e=t.length-1;return 0===t.length?"":"\0"===t.charAt(e)?t.substring(0,e):t.substring(0,e)+String.fromCharCode(t.charCodeAt(e)-1)}function W(t){return t+"\0"}function K(){if("undefined"==typeof Uint8Array)throw new he(ce.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function H(){if(!ue.getPlatform().base64Available)throw new he(ce.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function G(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}function Q(t,e){return t===e?0!==t||1/t==1/e:t!==t&&e!==e}function z(t){return null===t||void 0===t}function X(t){return Je(t)&&t<=Ye&&t>=Xe}function Y(t,e,n){if(n.isEqual(Pe.INSTANCE)){if(e!==Ze.EQUAL)throw new he(ce.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new en(t)}if(n.isEqual(Fe.NAN)){if(e!==Ze.EQUAL)throw new he(ce.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new nn(t)}return new tn(t,e,n)}function J(t){switch(t){case ce.OK:return u("Treated status OK as error");case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return u("Unknown status code: "+t)}}function $(t){var e=mn[t];if(void 0!==e)return Z(e)}function Z(t){if(void 0===t)return a("GRPC error has no .code"),ce.UNKNOWN;switch(t){case mn.OK:return ce.OK;case mn.CANCELLED:return ce.CANCELLED;case mn.UNKNOWN:return ce.UNKNOWN;case mn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case mn.INTERNAL:return ce.INTERNAL;case mn.UNAVAILABLE:return ce.UNAVAILABLE;case mn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case mn.NOT_FOUND:return ce.NOT_FOUND;case mn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case mn.ABORTED:return ce.ABORTED;case mn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case mn.DATA_LOSS:return ce.DATA_LOSS;default:return u("Unknown status code: "+t)}}function tt(t){if(void 0===t)return mn.OK;switch(t){case ce.OK:return mn.OK;case ce.CANCELLED:return mn.CANCELLED;case ce.UNKNOWN:return mn.UNKNOWN;case ce.DEADLINE_EXCEEDED:return mn.DEADLINE_EXCEEDED;case ce.RESOURCE_EXHAUSTED:return mn.RESOURCE_EXHAUSTED;case ce.INTERNAL:return mn.INTERNAL;case ce.UNAVAILABLE:return mn.UNAVAILABLE;case ce.UNAUTHENTICATED:return mn.UNAUTHENTICATED;case ce.INVALID_ARGUMENT:return mn.INVALID_ARGUMENT;case ce.NOT_FOUND:return mn.NOT_FOUND;case ce.ALREADY_EXISTS:return mn.ALREADY_EXISTS;case ce.PERMISSION_DENIED:return mn.PERMISSION_DENIED;case ce.FAILED_PRECONDITION:return mn.FAILED_PRECONDITION;case ce.ABORTED:return mn.ABORTED;case ce.OUT_OF_RANGE:return mn.OUT_OF_RANGE;case ce.UNIMPLEMENTED:return mn.UNIMPLEMENTED;case ce.DATA_LOSS:return mn.DATA_LOSS;default:return u("Unknown status code: "+t)}}function et(t){switch(t){case 200:return ce.OK;case 400:return ce.INVALID_ARGUMENT;case 401:return ce.UNAUTHENTICATED;case 403:return ce.PERMISSION_DENIED;case 404:return ce.NOT_FOUND;case 409:return ce.ABORTED;case 416:return ce.OUT_OF_RANGE;case 429:return ce.RESOURCE_EXHAUSTED;case 499:return ce.CANCELLED;case 500:return ce.UNKNOWN;case 501:return ce.UNIMPLEMENTED;case 503:return ce.UNAVAILABLE;case 504:return ce.DEADLINE_EXCEEDED;default:return t>=200&&t<300?ce.OK:t>=400&&t<500?ce.FAILED_PRECONDITION:t>=500&&t<600?ce.INTERNAL:ce.UNKNOWN}}function nt(){return An}function rt(){return _n}function it(){return kn}function ot(){return Nn}function at(t,e){e.length>0&&(t.resumeToken=e)}function st(t){return t instanceof Qe?t.internalValue.slice():[]}function ut(t,e){c(!z(t),e+" is missing")}function ct(t){return"number"==typeof t?t:"string"==typeof t?Number(t):u("can't parse "+t)}function ht(t,e,n){return e===n||!e&&n in t}function lt(t){if(t.search(or)>=0)throw new he(ce.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ir.bind.apply(ir,[void 0].concat(t.split("."))))}catch(e){throw new he(ce.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}function ft(t,e){var n=function(t){switch(t){case ar.Added:return 1;case ar.Modified:case ar.Metadata:return 2;case ar.Removed:return 0;default:return u("Unknown ChangeType: "+t)}};return n(t)-n(e)}function dt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=mt(e)),e=pt(t.get(n),e);return mt(e)}function pt(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Rr+Lr;break;case Rr:n+=Rr+Pr;break;default:n+=o}}return n}function mt(t){return t+Rr+xr}function yt(t){var e=t.length;if(c(e>=2,"Invalid path "+t),2===e)return c(t.charAt(0)===Rr&&t.charAt(1)===xr,"Non-empty path "+t+" had length 2"),we.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Rr,o);(a<0||a>n)&&u('Invalid encoded resource path: "'+t+'"');switch(t.charAt(a+1)){case xr:var s=t.substring(o,a),h=void 0;0===i.length?h=s:(i+=s,h=i,i=""),r.push(h);break;case Lr:i+=t.substring(o,a),i+="\0";break;case Pr:i+=t.substring(o,a+1);break;default:u('Invalid encoded resource path: "'+t+'"')}o=a+2}return new we(r)}function gt(t,e,n,r){c(n<r&&n>=0&&r<=2,"Unexpected schema upgrade from v${fromVersion} to v{toVersion}."),n<1&&r>=1&&(vt(t),bt(t),Et(t),wt(t));var i=yr.resolve();return n<2&&r>=2&&(i=It(e).next(function(t){return Tt(e,t)})),i}function vt(t){t.createObjectStore(Br.store)}function bt(t){t.createObjectStore(Ur.store,{keyPath:Ur.keyPath}),t.createObjectStore(Fr.store,{keyPath:Fr.keyPath}),t.createObjectStore(Vr.store)}function wt(t){t.createObjectStore(jr.store)}function Et(t){t.createObjectStore(Kr.store,{keyPath:Kr.keyPath}).createIndex(Kr.documentTargetsIndex,Kr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Wr.store,{keyPath:Wr.keyPath}).createIndex(Wr.queryTargetsIndexName,Wr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Hr.store)}function Tt(t,e){var n=t.store(Hr.store);return t.store(Wr.store).count().next(function(t){return e.targetCount=t,n.put(Hr.key,e)})}function It(t){var e=t.store(Hr.store);return e.get(Hr.key).next(function(t){return null!=t?yr.resolve(t):(t=new Hr(0,0,cn.MIN.toTimestamp(),0),e.put(Hr.key,t).next(function(){return t}))})}function St(t){return new yr(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}function At(e){return e instanceof Uint8Array?(c("YES"===t.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),e.toString()):e}function _t(t){return Ct(t,Fr.store)}function kt(t){return Ct(t,Vr.store)}function Nt(t){return Ct(t,Ur.store)}function Ct(t,e){return t instanceof Yr?t.store(e):u("Invalid transaction object provided!")}function Dt(t){return xt(t,Wr.store)}function Ot(t){return xt(t,Hr.store)}function Rt(t){return xt(t,Kr.store)}function xt(t,e){return t instanceof Yr?t.store(e):u("Invalid transaction object provided!")}function Lt(t){return t instanceof Yr?t.store(jr.store):u("Invalid transaction object provided!")}function Pt(t){return t.path.toArray()}function Mt(t){return void 0!==t.documents}function Bt(t){if(!t)return new xi;switch(t.type){case"gapi":return new Mi(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new he(ce.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function Ut(t){return Ft(t,["next","error","complete"])}function Ft(t,e){if("object"!==(void 0===t?"undefined":te(t))||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}function Vt(t){switch(t){case vi.Set:case vi.MergeSet:case vi.Update:return!0;case vi.Argument:return!1;default:throw u("Unexpected case for UserDataSource: "+t)}}function qt(t){return!("object"!==(void 0===t?"undefined":te(t))||null===t||t instanceof Array||t instanceof Date||t instanceof me||t instanceof pe||t instanceof fe||t instanceof Qi||t instanceof Bi)}function jt(t,e,n){if(!qt(n)||!O(n)){var r=R(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Wt(t,e){if(e instanceof ir)return e._internalPath;if("string"==typeof e)return Kt(t,e);throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Kt(t,e){try{return lt(e)._internalPath}catch(e){var n=Ht(e);throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Ht(t){return t instanceof Error?t.message:t.toString()}function Gt(){throw new he(ce.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}function Qt(t,e){if(void 0===e)return{merge:!1};if(P(t,e,["merge","mergeFields"]),A(t,"boolean","merge",e.merge),k(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof ir}),void 0!==e.mergeFields&&void 0!==e.merge)throw new he(ce.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function zt(t,e){return void 0===e?{}:(P(t,e,["serverTimestamps"]),C(t,"options","serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Xt(t,e,n){if(e instanceof ro){if(e.firestore!==n)throw new he(ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw M(t,"DocumentReference",1,e)}function Yt(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new ao(t,e.doc.key,e.doc,n.fromCache);return c(e.type===ar.Added,"Invalid event type for first snapshot"),c(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==ar.Metadata}).map(function(e){var r=new ao(t,e.doc.key,e.doc,n.fromCache),i=-1,a=-1;return e.type!==ar.Added&&(i=o.indexOf(e.doc.key),c(i>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==ar.Removed&&(o=o.add(e.doc),a=o.indexOf(e.doc.key)),{type:Jt(e.type),doc:r,oldIndex:i,newIndex:a}})}function Jt(t){switch(t){case ar.Added:return"added";case ar.Modified:case ar.Metadata:return"modified";case ar.Removed:return"removed";default:return u("Unknown change type: "+t)}}function $t(t){t.INTERNAL.registerService("firestore",function(t){return new to(t)},g(wo))}function Zt(t){$t(t)}var te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var ee,ne=function(t){return t&&"object"===(void 0===t?"undefined":te(t))&&"default"in t?t.default:t}(n(4)),re=n(49),ie=n(11),oe=n(50),ae=ne.SDK_VERSION,se=new re.Logger("@firebase/firestore");!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(ee||(ee={}));var ue=function(){function t(){}return t.setPlatform=function(e){t.platform&&u("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||u("Platform not set"),t.platform},t}(),ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},he=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return ie.__extends(e,t),e}(Error),le=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return c(20===e.length,"Invalid auto ID: "+e),e},t}(),fe=function(){function t(t){H(),this._binaryString=t}return t.fromBase64String=function(e){v("Blob.fromBase64String",arguments,1),T("Blob.fromBase64String","string",1,e),H();try{return new t(ue.getPlatform().atob(e))}catch(t){throw new he(ce.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(v("Blob.fromUint8Array",arguments,1),K(),!(e instanceof Uint8Array))throw M("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return v("Blob.toBase64",arguments,0),H(),ue.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){v("Blob.toUint8Array",arguments,0),K();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return F(this._binaryString,t._binaryString)},t}(),de=l(fe,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),pe=function(){function t(t,e){if(v("GeoPoint",arguments,2),T("GeoPoint","number",1,t),T("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new he(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new he(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return F(this._lat,t._lat)||F(this._long,t._long)},t}(),me=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new he(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new he(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new he(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new he(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?F(this.nanoseconds,t.nanoseconds):F(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),ye=function(){function t(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}return t}(),ge="(default)",ve=function(){function t(t,e){this.projectId=t,this.database=e||ge}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===ge},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return F(this.projectId,t.projectId)||F(this.database,t.database)},t}(),be=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&u("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&u("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):u("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,c(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return c(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return c(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return c(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return c(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),we=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ie.__extends(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new he(ce.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(be),Ee=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ie.__extends(e,t),e.isValidIdentifier=function(t){return Ee.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new he(ce.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new he(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new he(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new he(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(be),Ie=function(){function t(e){this.path=e,c(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(t){return null!==t&&0===we.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return we.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new we(e.slice()))},t.fromPathString=function(e){return new t(we.fromString(e))},t.EMPTY=new t(new we([])),t}(),Se=function(){function t(t,e,n,r){this.key=t,this.version=e,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(t){return this.data.field(t)},t.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.data.isEqual(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(t,e){return Ie.comparator(t.key,e.key)},t.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):u("Trying to compare documents on fields that don't exist")},t}(),Ae=function(){function t(t,e){this.key=t,this.version=e}return t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},t.prototype.isEqual=function(t){return t&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},t.compareByKey=function(t,e){return Ie.comparator(t.key,e.key)},t}(),_e=function(){function t(t,e){this.comparator=t,this.root=e||Ne.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ne.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ne.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new ke(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new ke(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new ke(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new ke(this.root,t,this.comparator,!0)},t}(),ke=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){c(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Ne=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw u("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw u("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw u("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Ce=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ne(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();Ne.EMPTY=new Ce;var De;!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(De||(De={}));var Oe;!function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(Oe||(Oe={}));var Re,xe=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Oe.Estimate,n);case"previous":return new t(Oe.Previous,n);case"none":case void 0:return new t(Oe.Default,n);default:return u("fromSnapshotOptions() called with invalid options.")}},t}(),Le=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return c(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),F(this.typeOrder,t.typeOrder)},t}(),Pe=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=De.NullValue,e.internalValue=null,e}return ie.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Le),Me=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.BooleanValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?F(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Le),Be=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.NumberValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?G(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Le),Ue=function(t){function e(e){return t.call(this,e)||this}return ie.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Q(this.internalValue,t.internalValue)},e}(Be),Fe=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return ie.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Q(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Be),Ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.StringValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?F(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Le),qe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.TimestampValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return t&&t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof je?-1:this.defaultCompareTo(t)},e}(Le),je=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=De.TimestampValue,r}return ie.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Oe.Estimate?new qe(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Oe.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof qe?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Le),We=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.BlobValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Le),Ke=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=De.RefValue,r}return ie.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:Ie.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Le),He=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.GeoPointValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Le),Ge=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.ObjectValue,n}return ie.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=F(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return F(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(c(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(c(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){c(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t)||void 0:void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new _e(F)),e}(Le),Qe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=De.ArrayValue,n}return ie.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return F(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(Le),ze=Number,Xe=ze.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Ye=ze.MAX_SAFE_INTEGER||Math.pow(2,53)-1,Je=ze.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},$e=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[sn]:this.memoizedOrderBy=[new an(t),sn];else{c(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:rn.ASCENDING;this.memoizedOrderBy.push(a===rn.ASCENDING?sn:un)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){c(null==this.getInequalityFilterField()||!(e instanceof tn)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),c(!Ie.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){c(!Ie.isDocumentKey(this.path),"No ordering allowed for document query"),c(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}z(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),z(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return c(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!z(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof tn&&n.isInequality())return n.field}return null},t.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(t){return t instanceof tn&&t.op===Ze.ARRAY_CONTAINS})},t.prototype.isDocumentQuery=function(){return Ie.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return Ie.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){c(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Ze=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;default:return u("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t}(),tn=function(){function t(t,e,n){this.field=t,this.op=e,this.value=n}return t.prototype.matches=function(t){if(this.field.isKeyField()){c(this.value instanceof Ke,"Comparing on key, but filter value not a RefValue"),c(this.op!==Ze.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var e=this.value,n=Ie.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(t){var e=this;return this.op===Ze.ARRAY_CONTAINS?t instanceof Qe&&void 0!==t.internalValue.find(function(t){return t.isEqual(e.value)}):this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(t){switch(this.op){case Ze.LESS_THAN:return t<0;case Ze.LESS_THAN_OR_EQUAL:return t<=0;case Ze.EQUAL:return 0===t;case Ze.GREATER_THAN:return t>0;case Ze.GREATER_THAN_OR_EQUAL:return t>=0;default:return u("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==Ze.EQUAL&&this.op!==Ze.ARRAY_CONTAINS},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&(this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value))},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),en=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),nn=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field).value();return"number"==typeof e&&isNaN(e)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),rn=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),on=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){c(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())c(o instanceof Ke,"Bound has a non-key value where the key path is being used."),n=Ie.comparator(o.key,e.key);else{var a=e.field(i.field);c(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===rn.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),an=function(){function t(t,e){this.field=t,void 0===e&&(e=rn.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Se.compareByKey(t,e):Se.compareByField(this.field,t,e);switch(this.dir){case rn.ASCENDING:return n;case rn.DESCENDING:return-1*n;default:return u("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),sn=new an(Te.keyField(),rn.ASCENDING),un=new an(Te.keyField(),rn.DESCENDING),cn=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new me(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new me(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(Re||(Re={}));var hn,ln=function(){function t(t,e,n,r,i){void 0===r&&(r=cn.MIN),void 0===i&&(i=h()),this.query=t,this.targetId=e,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),fn=function(){function t(t){this.fields=t}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++){if(n[e].isPrefixOf(t))return!0}return!1},t.prototype.isEqual=function(t){return q(this.fields,t.fields)},t}(),dn=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),pn=function(){function t(t,e){this.version=t,this.transformResults=e}return t}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(hn||(hn={}));var mn,yn=function(){function t(t,e){this.updateTime=t,this.exists=e,c(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Se&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists?t instanceof Se:null===t||t instanceof Ae:(c(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return V(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),gn=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&c(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Se?t.version:cn.MIN},t}(),vn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=hn.Set,i}return ie.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by SetMutation.");var n=gn.getPostMutationVersion(t);return new Se(this.key,n,this.value,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=gn.getPostMutationVersion(t);return new Se(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(gn),bn=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=hn.Patch,o}return ie.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return t;var n=gn.getPostMutationVersion(t),r=this.patchDocument(t);return new Se(this.key,n,r,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=gn.getPostMutationVersion(t),i=this.patchDocument(t);return new Se(this.key,r,i,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Se?t.data:Ge.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){for(var e=0,n=this.fieldMask.fields;e<n.length;e++){var r=n[e],i=this.data.field(r);t=void 0!==i?t.set(r,i):t.delete(r)}return t},e}(gn),wn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=hn.Transform,r.precondition=yn.exists(!0),r}return ie.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return t;var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=this.transformObject(n.data,r);return new Se(this.key,n.version,i,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new Se(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&q(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){c(t instanceof Se,"Unknown MaybeDocument type "+t);var e=t;return c(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];c(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Se&&(a=t.field(i.field)||null),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;e instanceof Se&&(s=e.field(o.field)||null),n.push(a.applyToLocalView(s,t))}return n},e.prototype.transformObject=function(t,e){c(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.field;t=t.set(i,e[n])}return t},e}(gn),En=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=hn.Delete,r}return ie.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by DeleteMutation."),new Ae(this.key,cn.MIN)},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&c(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Ae(this.key,cn.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(gn),Tn=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(mn||(mn={}));var In,Sn=function(){function t(t){this.comparator=t,this.data=new _e(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),An=new _e(Ie.comparator),_n=new _e(Ie.comparator),kn=new _e(Ie.comparator),Nn=new Sn(Ie.comparator),Cn=function(){function t(t,e,n,r){this.snapshotVersion=t,this.targetChanges=e,this.documentUpdates=n,this.limboDocuments=r}return t.prototype.addDocumentUpdate=function(t){this.documentUpdates=this.documentUpdates.insert(t.key,t)},t.prototype.handleExistenceFilterMismatch=function(t){this.targetChanges[t]={mapping:new Rn,snapshotVersion:cn.MIN,currentStatusUpdate:In.MarkNotCurrent,resumeToken:h()}},t.prototype.synthesizeDeleteForLimboTargetChange=function(t,e){t.currentStatusUpdate!==In.MarkCurrent||this.documentUpdates.get(e)||(this.documentUpdates=this.documentUpdates.insert(e,new Ae(e,this.snapshotVersion)),this.limboDocuments=this.limboDocuments.add(e))},t}();!function(t){t[t.None=0]="None",t[t.MarkNotCurrent=1]="MarkNotCurrent",t[t.MarkCurrent=2]="MarkCurrent"}(In||(In={}));var Dn,On=ot(),Rn=function(){function t(){this.docs=On}return Object.defineProperty(t.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.docs=this.docs.add(t)},t.prototype.delete=function(t){this.docs=this.docs.delete(t)},t.prototype.isEqual=function(t){return null!==t&&this.docs.isEqual(t.docs)},t.prototype.filterUpdates=function(t){},t}(),xn=function(){function t(){this.addedDocuments=On,this.removedDocuments=On}return t.prototype.applyToKeySet=function(t){var e=t;return this.addedDocuments.forEach(function(t){return e=e.add(t)}),this.removedDocuments.forEach(function(t){return e=e.delete(t)}),e},t.prototype.add=function(t){this.addedDocuments=this.addedDocuments.add(t),this.removedDocuments=this.removedDocuments.delete(t)},t.prototype.delete=function(t){this.addedDocuments=this.addedDocuments.delete(t),this.removedDocuments=this.removedDocuments.add(t)},t.prototype.isEqual=function(t){return null!==t&&this.addedDocuments.isEqual(t.addedDocuments)&&this.removedDocuments.isEqual(t.removedDocuments)},t.prototype.filterUpdates=function(t){var e=this.addedDocuments;this.addedDocuments.forEach(function(n){t.has(n)&&(e=e.delete(n))}),this.addedDocuments=e},t}(),Ln=function(){function t(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}return t}(),Pn=function(){function t(t,e){this.targetId=t,this.existenceFilter=e}return t}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Dn||(Dn={}));var Mn=function(){function t(t,e,n,r){void 0===n&&(n=h()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}return t}(),Bn=function(){function t(t,e,n){this.snapshotVersion=t,this.listenTargets=e,this.existenceFilters={},this.targetChanges={},this.documentUpdates=nt(),this.frozen=!1,this.limboDocuments=ot(),this.pendingTargetResponses=g(n)}return t.prototype.add=function(t){c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t instanceof Ln?this.addDocumentChange(t):t instanceof Mn?this.addTargetChange(t):t instanceof Pn?this.addExistenceFilterChange(t):u("Unknown watch change: "+t)},t.prototype.addChanges=function(t){var e=this;c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t.forEach(function(t){return e.add(t)})},t.prototype.createRemoteEvent=function(){var t=this,e=this.targetChanges;return p(this.targetChanges,function(n){t.isActiveTarget(n)||delete e[n]}),this.frozen=!0,new Cn(this.snapshotVersion,e,this.documentUpdates,this.limboDocuments)},t.prototype.ensureTargetChange=function(t){var e=this.targetChanges[t];return e||(e={currentStatusUpdate:In.None,snapshotVersion:this.snapshotVersion,mapping:new xn,resumeToken:h()},this.targetChanges[t]=e),e},t.prototype.queryDataForActiveTarget=function(t){var e=this.listenTargets[t];return e&&!f(this.pendingTargetResponses,t)?e:null},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.updateLimboDocuments=function(t,e,n){return!!n&&(this.documentUpdates.get(t)?e.purpose===Re.LimboResolution||(this.limboDocuments=this.limboDocuments.delete(t),!1):e.purpose===Re.LimboResolution&&(this.limboDocuments=this.limboDocuments.add(t),!0))},t.prototype.addDocumentChange=function(t){for(var e=!1,n=!0,r=0,i=t.updatedTargetIds;r<i.length;r++){var o=i[r],a=this.queryDataForActiveTarget(o);if(a){var s=this.ensureTargetChange(o);n=this.updateLimboDocuments(t.key,a,n),s.mapping.add(t.key),e=!0}}for(var u=0,c=t.removedTargetIds;u<c.length;u++){var o=c[u],a=this.queryDataForActiveTarget(o);if(a){var s=this.ensureTargetChange(o);n=this.updateLimboDocuments(t.key,a,n),s.mapping.delete(t.key),e=!0}}t.newDoc&&e&&(this.documentUpdates=this.documentUpdates.insert(t.key,t.newDoc))},t.prototype.addTargetChange=function(t){var e=this;t.targetIds.forEach(function(n){var r=e.ensureTargetChange(n);switch(t.state){case Dn.NoChange:e.isActiveTarget(n)&&at(r,t.resumeToken);break;case Dn.Added:e.recordTargetResponse(n),f(e.pendingTargetResponses,n)||(r.mapping=new xn,r.currentStatusUpdate=In.None,delete e.existenceFilters[n]),at(r,t.resumeToken);break;case Dn.Removed:e.recordTargetResponse(n),c(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Dn.Current:e.isActiveTarget(n)&&(r.currentStatusUpdate=In.MarkCurrent,at(r,t.resumeToken));break;case Dn.Reset:e.isActiveTarget(n)&&(r.mapping=new Rn,at(r,t.resumeToken));break;default:u("Unknown target watch change state: "+t.state)}})},t.prototype.recordTargetResponse=function(t){var e=(this.pendingTargetResponses[t]||0)-1;0===e?delete this.pendingTargetResponses[t]:this.pendingTargetResponses[t]=e},t.prototype.addExistenceFilterChange=function(t){this.isActiveTarget(t.targetId)&&(this.existenceFilters[t.targetId]=t.existenceFilter)},t}(),Un=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new je(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Fn=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=st(t),n=0,r=this.elements;n<r.length;n++){var i=r[n];!function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)}(i)}return new Qe(e)},t.prototype.isEqual=function(e){return e instanceof t&&q(e.elements,this.elements)},t}(),Vn=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=st(t),n=0,r=this.elements;n<r.length;n++){var i=r[n];!function(t){e=e.filter(function(e){return!e.isEqual(t)})}(i)}return new Qe(e)},t.prototype.isEqual=function(e){return e instanceof t&&q(e.elements,this.elements)},t}(),qn=function(){var t={};return t[rn.ASCENDING.name]="ASCENDING",t[rn.DESCENDING.name]="DESCENDING",t}(),jn=function(){var t={};return t[Ze.LESS_THAN.name]="LESS_THAN",t[Ze.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Ze.GREATER_THAN.name]="GREATER_THAN",t[Ze.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Ze.EQUAL.name]="EQUAL",t[Ze.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",t}(),Wn=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),Kn=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?ce.UNKNOWN:Z(t.code);return new he(e,t.message||"")},t.prototype.toInt32Value=function(t){return z(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return e="object"===(void 0===t?"undefined":te(t))?t.value:t,z(e)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);c(!!t,"Cannot deserialize null or undefined timestamp.");var e=ct(t.seconds||"0"),n=t.nanos||0;return new me(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=Wn.exec(t);if(c(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new me(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(c(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),fe.fromBase64String(t)):(c(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),fe.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return c(!!t,"Trying to deserialize version that isn't set"),cn.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=we.fromString(t);return c(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return c(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),c(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Ie(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?we.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new we(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new we(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return c(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Pe)return{nullValue:"NULL_VALUE"};if(t instanceof Me)return{booleanValue:t.value()};if(t instanceof Ue)return{integerValue:""+t.value()};if(t instanceof Fe){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Ve?{stringValue:t.value()}:t instanceof Ge?{mapValue:this.toMapValue(t)}:t instanceof Qe?{arrayValue:this.toArrayValue(t)}:t instanceof qe?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof He?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof We?{bytesValue:this.toBytes(t.value())}:t instanceof Ke?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:u("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(ht(t,n,"nullValue"))return Pe.INSTANCE;if(ht(t,n,"booleanValue"))return Me.of(t.booleanValue);if(ht(t,n,"integerValue"))return new Ue(ct(t.integerValue));if(ht(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Fe.NAN;if("Infinity"===t.doubleValue)return Fe.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Fe.NEGATIVE_INFINITY}return new Fe(t.doubleValue)}if(ht(t,n,"stringValue"))return new Ve(t.stringValue);if(ht(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(ht(t,n,"arrayValue")){ut(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new Qe(r.map(function(t){return e.fromValue(t)}))}if(ht(t,n,"timestampValue"))return ut(t.timestampValue,"timestampValue"),new qe(this.fromTimestamp(t.timestampValue));if(ht(t,n,"geoPointValue")){ut(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new He(new pe(i,o))}if(ht(t,n,"bytesValue")){ut(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new We(a)}if(ht(t,n,"referenceValue")){ut(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),c=new ve(s.get(1),s.get(3)),h=new Ie(this.extractLocalPathFromResourceName(s));return new Ke(c,h)}return u("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return c(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t){return new Se(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasLocalMutations:!1})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=Ge.EMPTY;return m(n,function(t,n){r=r.set(new Te([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){c(!!t.found,"Tried to deserialize a found document from a missing document."),ut(t.found.name,"doc.found.name"),ut(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new Se(e,n,r,{hasLocalMutations:!1})},t.prototype.fromMissing=function(t){c(!!t.missing,"Tried to deserialize a missing document from a found document."),c(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Ae(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result;return ht(t,e,"found")?this.fromFound(t):ht(t,e,"missing")?this.fromMissing(t):u("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Dn.Added:return"ADD";case Dn.Current:return"CURRENT";case Dn.NoChange:return"NO_CHANGE";case Dn.Removed:return"REMOVE";case Dn.Reset:return"RESET";default:return u("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof Pn)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Ln){if(t.newDoc instanceof Se){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Ae){var e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Mn){var n=void 0;return t.cause&&(n={code:tt(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return u("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.response_type;if(ht(t,n,"targetChange")){ut(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new Mn(r,i,o,s||null)}else if(ht(t,n,"documentChange")){ut(t.documentChange,"documentChange"),ut(t.documentChange.document,"documentChange.name"),ut(t.documentChange.document.name,"documentChange.document.name"),ut(t.documentChange.document.updateTime,"documentChange.document.updateTime");var c=t.documentChange,h=this.fromName(c.document.name),l=this.fromVersion(c.document.updateTime),f=this.fromFields(c.document.fields||{}),d=new Se(h,l,f,{hasLocalMutations:!1}),p=c.targetIds||[],m=c.removedTargetIds||[];e=new Ln(p,m,d.key,d)}else if(ht(t,n,"documentDelete")){ut(t.documentDelete,"documentDelete"),ut(t.documentDelete.document,"documentDelete.document");var y=t.documentDelete,h=this.fromName(y.document),l=y.readTime?this.fromVersion(y.readTime):cn.forDeletedDoc(),d=new Ae(h,l),m=y.removedTargetIds||[];e=new Ln([],m,d.key,d)}else if(ht(t,n,"documentRemove")){ut(t.documentRemove,"documentRemove"),ut(t.documentRemove.document,"documentRemove");var g=t.documentRemove,h=this.fromName(g.document),m=g.removedTargetIds||[];e=new Ln([],m,h,null)}else{if(!ht(t,n,"filter"))return u("Unknown change type "+JSON.stringify(t));ut(t.filter,"filter"),ut(t.filter.targetId,"filter.targetId");var v=t.filter,b=v.count||0,w=new Tn(b),E=v.targetId;e=new Pn(E,w)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Dn.NoChange:"ADD"===t?Dn.Added:"REMOVE"===t?Dn.Removed:"CURRENT"===t?Dn.Current:"RESET"===t?Dn.Reset:u("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!ht(t,t.response_type,"targetChange"))return cn.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?cn.MIN:e.readTime?this.fromVersion(e.readTime):cn.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof vn)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof En)e={delete:this.toName(t.key)};else if(t instanceof bn)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof wn))return u("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):yn.NONE;if(t.update){ut(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new bn(r,i,o,n)}return new vn(r,i,n)}if(t.delete){var r=this.fromName(t.delete);return new En(r,n)}if(t.transform){var r=this.fromName(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return c(!0===n.exists,'Transforms only support precondition "exists == true"'),new wn(r,a)}return u("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return c(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:u("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?yn.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?yn.exists(t.exists):yn.NONE},t.prototype.fromWriteResult=function(t){var e=this,n=t.updateTime?this.fromVersion(t.updateTime):null,r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults.map(function(t){return e.fromValue(t)})),new pn(n,r)},t.prototype.fromWriteResults=function(t){var e=this;return(t||[]).map(function(t){return e.fromWriteResult(t)})},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;return n instanceof Un?{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"}:n instanceof Fn?{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}}:n instanceof Vn?{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}}:void u("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=t.transform_type,r=null;if(ht(t,n,"setToServerValue"))c("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),r=Un.instance;else if(ht(t,n,"appendMissingElements")){var i=t.appendMissingElements.values||[];r=new Fn(i.map(function(t){return e.fromValue(t)}))}else if(ht(t,n,"removeAllFromArray")){var i=t.removeAllFromArray.values||[];r=new Vn(i.map(function(t){return e.fromValue(t)}))}else u("Unknown transform proto: "+JSON.stringify(t));var o=Te.fromServerFormat(t.fieldPath);return new dn(o,r)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;c(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return $e.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(we.EMPTY_PATH);else{var n=t.path;c(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){c(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var h=null;return n.endAt&&(h=this.fromCursor(n.endAt)),new $e(e,a,o,s,u,h)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Re.Listen:return null;case Re.ExistenceFilterMismatch:return"existence-filter-mismatch";case Re.LimboResolution:return"limbo-document";default:return u("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof tn?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):u("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new on(r,n)},t.prototype.toDirection=function(t){return qn[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return rn.ASCENDING;case"DESCENDING":return rn.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return jn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Ze.EQUAL;case"GREATER_THAN":return Ze.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Ze.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Ze.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Ze.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Ze.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return u("Unspecified relation");default:return u("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return Te.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new an(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof tn?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new tn(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof nn?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof en?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new nn(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new en(n);case"OPERATOR_UNSPECIFIED":return u("Unspecified filter");default:return u("Unknown filter")}},t.prototype.toDocumentMask=function(t){return{fieldPaths:t.fields.map(function(t){return t.canonicalString()})}},t.prototype.fromDocumentMask=function(t){var e=t.fieldPaths||[],n=e.map(function(t){return Te.fromServerFormat(t)});return new fn(n)},t}(),Hn=function(){return"object"===("undefined"==typeof navigator?"undefined":te(navigator))&&"ReactNative"===navigator.product},Gn="FirebaseError",Qn=Error.captureStackTrace,zn=function(){function t(t,e){if(this.code=t,this.message=e,Qn)Qn(this,Xn.prototype.create);else try{throw Error.apply(this,arguments)}catch(t){this.name=Gn,Object.defineProperty(this,"stack",{get:function(){return t.stack}})}}return t}();zn.prototype=Object.create(Error.prototype),zn.prototype.constructor=zn,zn.prototype.name=Gn;var Xn=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new zn(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}(),Yn=function(){function t(){this.blockSize=-1}return t}(),Jn=(function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}ie.__extends(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(var r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4],r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782);var i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}(Yn),function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){c(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){c(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){c(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){c(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){c(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){c(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}()),$n="Connection",Zn={BatchGetDocuments:"batchGet",Commit:"commit"},tr="gl-js/ fire/"+ae,er=function(){function t(t){this.databaseId=t.databaseId,this.pool=new oe.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=tr},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(a,s){r.pool.getObject(function(c){c.listenOnce(oe.EventType.COMPLETE,function(){try{switch(c.getLastErrorCode()){case oe.ErrorCode.NO_ERROR:var e=c.getResponseJson();o($n,"XHR received:",JSON.stringify(e)),a(e);break;case oe.ErrorCode.TIMEOUT:o($n,'RPC "'+t+'" timed out'),s(new he(ce.DEADLINE_EXCEEDED,"Request time out"));break;case oe.ErrorCode.HTTP_ERROR:var n=c.getStatus();o($n,'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0?s(new he(et(n),"Server responded with status "+c.getStatusText())):(o($n,'RPC "'+t+'" failed'),s(new he(ce.UNAVAILABLE,"Connection failed.")));break;default:u('RPC "'+t+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{o($n,'RPC "'+t+'" completed.'),r.pool.releaseObject(c)}});var h=JSON.stringify(e);o($n,"XHR sending: ",i+" "+h);var l={"Content-Type":"text/plain"};r.modifyHeadersForRequest(l,n),c.send(i,"POST",h,l,15)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1beta1.Firestore","/",t,"/channel"],r=oe.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e),Hn()||(i.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");o($n,"Creating WebChannel: "+a+" "+i);var s=r.createWebChannel(a,i),u=!1,h=!1,l=new Jn({sendFn:function(t){h?o($n,"Not sending because WebChannel is closed:",t):(u||(o($n,"Opening WebChannel transport."),s.open(),u=!0),o($n,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(oe.WebChannel.EventType.OPEN,function(){h||o($n,"WebChannel transport opened.")}),f(oe.WebChannel.EventType.CLOSE,function(){h||(h=!0,o($n,"WebChannel transport closed"),l.callOnClose())}),f(oe.WebChannel.EventType.ERROR,function(t){h||(h=!0,o($n,"WebChannel transport errored:",t),l.callOnClose(new he(ce.UNAVAILABLE,"The operation could not be completed")))}),f(oe.WebChannel.EventType.MESSAGE,function(t){if(!h){var e=t.data[0];c(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){o($n,"WebChannel received error:",n);var r=n.status,i=$(r),a=n.message;void 0===i&&(i=ce.INTERNAL,a="Unknown error status: "+r+" with message "+n.message),h=!0,l.callOnClose(new he(i,a)),s.close()}else o($n,"WebChannel received:",e),l.callOnMessage(e)}}),setTimeout(function(){l.callOnOpen()},0),l},t.prototype.makeUrl=function(t){var e=Zn[t];c(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1beta1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),nr=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return t.prototype.loadConnection=function(t){return Promise.resolve(new er(t))},t.prototype.newSerializer=function(t){return new Kn(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();ue.setPlatform(new nr);var rr,ir=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];E("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(T("FieldPath","string",n,t[n]),0===t[n].length)throw new he(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Te(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(Te.keyField().canonicalString()),t}(),or=new RegExp("[~\\*/\\[\\]]");!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(rr||(rr={}));var ar;!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(ar||(ar={}));var sr;!function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(sr||(sr={}));var ur,cr=function(){function t(){this.changeMap=new _e(Ie.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);if(!n)return void(this.changeMap=this.changeMap.insert(e,t));t.type!==ar.Added&&n.type===ar.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===ar.Metadata&&n.type!==ar.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===ar.Modified&&n.type===ar.Modified?this.changeMap=this.changeMap.insert(e,{type:ar.Modified,doc:t.doc}):t.type===ar.Modified&&n.type===ar.Added?this.changeMap=this.changeMap.insert(e,{type:ar.Added,doc:t.doc}):t.type===ar.Removed&&n.type===ar.Added?this.changeMap=this.changeMap.remove(e):t.type===ar.Removed&&n.type===ar.Modified?this.changeMap=this.changeMap.insert(e,{type:ar.Removed,doc:n.doc}):t.type===ar.Added&&n.type===ar.Removed?this.changeMap=this.changeMap.insert(e,{type:ar.Modified,doc:t.doc}):u("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),hr=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.fromCache=i,this.hasPendingWrites=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.hasPendingWrites!==t.hasPendingWrites||this.syncStateChanged!==t.syncStateChanged||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),lr=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ie.comparator(e.key,n.key)}:function(t,e){return Ie.comparator(t.key,e.key)},this.keyedMap=rt(),this.sortedSet=new _e(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),fr=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return void(this.inner[n]=[[t,e]]);for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){m(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return y(this.inner)},t}(),dr=function(){function t(){this.listeners=[]}return t}(),pr=function(){function t(t){this.syncEngine=t,this.queries=new fr(function(t){return t.canonicalId()}),this.onlineState=rr.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new dr,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return ie.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return ie.__generator(this,function(o){return e=t.query,n=!1,r=this.queries.get(e),r&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++){s[a].onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.onError(e)}this.queries.delete(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){i[r].applyOnlineStateChange(t)}})},t}(),mr=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=rr.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(c(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==ar.Metadata&&e.push(i)}t=new hr(t.query,t.docs,t.oldDocs,e,t.fromCache,t.hasPendingWrites,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(c(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==rr.Offline;return this.options.waitForSyncWhenOnline&&n?(c(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===rr.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(e){c(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=new hr(e.query,e.docs,lr.emptySet(e.docs),t.getInitialViewChanges(e),e.fromCache,e.hasPendingWrites,!0,!1),this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(t){var e=[];return t.docs.forEach(function(t){e.push({type:ar.Added,doc:t})}),e},t}(),yr=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&u("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){var n=e.length;if(0===n)return t.resolve();var r=0;return new t(function(t,i){for(var o=0,a=e;o<a.length;o++){a[o].next(function(){++r===n&&t()},function(t){return i(t)})}})},t.map=function(e){for(var n=[],r=[],i=0;i<e.length;++i)!function(t){r[t]=e[t].next(function(e){n[t]=e})}(i);return t.waitFor(r).next(function(){return n})},t}(),gr=function(){function t(){this.isEager=!0,this.sources=[],this.potentialGarbage=ot()}return t.prototype.addGarbageSource=function(t){this.sources.push(t),t.setGarbageCollector(this)},t.prototype.removeGarbageSource=function(t){this.sources.splice(this.sources.indexOf(t),1),t.setGarbageCollector(null)},t.prototype.addPotentialGarbageKey=function(t){this.potentialGarbage=this.potentialGarbage.add(t)},t.prototype.collectGarbage=function(t){var e=this,n=[],r=ot();return this.potentialGarbage.forEach(function(i){var o=e.documentHasAnyReferences(t,i);n.push(o.next(function(t){return t||(r=r.add(i)),yr.resolve()}))}),this.potentialGarbage=ot(),yr.waitFor(n).next(function(){return r})},t.prototype.documentHasAnyReferences=function(t,e){var n=yr.resolve(!1);return this.sources.map(function(n){return function(){return n.containsKey(t,e)}}).reduce(function(t,e){return t.next(function(t){return t?yr.resolve(!0):e()})},n)},t}(),vr=function(){function t(t,e,n){this.query=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e){for(var n=ot(),r=ot(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case ar.Added:n=n.add(a.doc.key);break;case ar.Removed:r=r.add(a.doc.key)}}return new t(e.query,n,r)},t}(),br=function(){function t(){this.refsByKey=new Sn(wr.compareByKey),this.refsByTarget=new Sn(wr.compareByTargetId),this.garbageCollector=null}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new wr(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new wr(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=Ie.EMPTY,r=new wr(n,t),i=new wr(n,t+1);this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t)})},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(t.key)},t.prototype.referencesForId=function(t){var e=Ie.EMPTY,n=new wr(e,t),r=new wr(e,t+1),i=ot();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new wr(e,0),r=this.refsByKey.firstAfterOrEqual(n);return yr.resolve(null!==r&&e.isEqual(r.key))},t}(),wr=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return Ie.comparator(t.key,e.key)||F(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return F(t.targetOrBatchId,e.targetOrBatchId)||Ie.comparator(t.key,e.key)},t}(),Er=1;!function(t){t[t.LocalStore=0]="LocalStore",t[t.SyncEngine=1]="SyncEngine"}(ur||(ur={}));var Tr,Ir=function(){function t(t,e){void 0===e&&(e=0),this.generatorId=t;var n=e>>Er<<Er,r=e-n;this.previousId=r>=t?n|this.generatorId:(n|this.generatorId)-(1<<Er)}return t.prototype.next=function(){return this.previousId+=1<<Er,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(ur.LocalStore,e)},t.forSyncEngine=function(){return new t(ur.SyncEngine)},t}(),Sr=function(){function t(t){this.key=t}return t}(),Ar=function(){function t(t){this.key=t}return t}(),_r=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=ot(),this.mutatedKeys=ot(),this.documentSet=new lr(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new cr,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=e instanceof Se?e:null;if(l&&(c(t.isEqual(l.key),"Mismatching keys found in document changes: "+t+" != "+l.key),l=n.query.matches(l)?l:null),l?(a=a.add(l),o=l.hasLocalMutations?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)),h&&l){var f=h.data.isEqual(l.data);f&&h.hasLocalMutations===l.hasLocalMutations||(f?r.track({type:ar.Metadata,doc:l}):r.track({type:ar.Modified,doc:l}),u&&n.query.docComparator(l,u)>0&&(s=!0))}else!h&&l?r.track({type:ar.Added,doc:l}):h&&!l&&(r.track({type:ar.Removed,doc:h}),u&&(s=!0))}),this.query.hasLimit())for(;a.size>this.query.limit;){var h=a.last();a=a.delete(h.key),r.track({type:ar.Removed,doc:h})}return c(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.applyChanges=function(t,e){var n=this;c(!t.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var i=t.changeSet.getChanges();i.sort(function(t,e){return ft(t.type,e.type)||n.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(e);var o=this.updateLimboDocuments(),a=0===this.limboDocuments.size&&this.current,s=a?sr.Synced:sr.Local,u=s!==this.syncState;if(this.syncState=s,0!==i.length||u){return{snapshot:new hr(this.query,t.documentSet,r,i,s===sr.Local,!t.mutatedKeys.isEmpty(),u,!1),limboChanges:o}}return{limboChanges:o}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===rr.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new cr,mutatedKeys:this.mutatedKeys,needsRefill:!1})):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){if(t){var e=t.mapping;switch(e instanceof Rn?this._syncedDocuments=e.documents:e instanceof xn&&(this._syncedDocuments=e.applyToKeySet(this._syncedDocuments)),t.currentStatusUpdate){case In.MarkCurrent:this.current=!0;break;case In.MarkNotCurrent:this.current=!1;break;case In.None:break;default:u("Unknown current status update: "+t.currentStatusUpdate)}}},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=ot(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Ar(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Sr(t))}),n},t}(),kr=function(){function t(t,e,n,r){this.query=t,this.targetId=e,this.resumeToken=n,this.view=r}return t}(),Nr=function(){function t(t,e,n){this.localStore=t,this.remoteStore=e,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new fr(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new _e(Ie.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new br,this.limboCollector=new gr,this.mutationUserCallbacks={},this.targetIdGenerator=Ir.forSyncEngine()}return t.prototype.subscribe=function(t,e){c(null!==t&&null!==e,"View and error handlers cannot be null"),c(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=t,this.errorHandler=e,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},t.prototype.listen=function(t){var e=this;return this.assertSubscribed("listen()"),c(!this.queryViewsByQuery.has(t),"We already listen to the query: "+t),this.localStore.allocateQuery(t).then(function(n){return e.localStore.executeQuery(t).then(function(r){return e.localStore.remoteDocumentKeys(n.targetId).then(function(i){var o=new _r(t,i),a=o.computeDocChanges(r),s=o.applyChanges(a);c(0===s.limboChanges.length,"View returned limbo docs before target ack from the server."),c(!!s.snapshot,"applyChanges for new view should always return a snapshot");var u=new kr(t,n.targetId,n.resumeToken,o);e.queryViewsByQuery.set(t,u),e.queryViewsByTarget[n.targetId]=u,e.viewHandler([s.snapshot]),e.remoteStore.listen(n)})}).then(function(){return n.targetId})})},t.prototype.unlisten=function(t){var e=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(t);return c(!!n,"Trying to unlisten on query not found:"+t),this.localStore.releaseQuery(t).then(function(){return e.remoteStore.unlisten(n.targetId),e.removeAndCleanupQuery(n).then(function(){return e.localStore.collectGarbage()})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),c(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!z(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),p(t.targetChanges,function(n,r){var i=e.limboKeysByTarget[n];if(i)t.synthesizeDeleteForLimboTargetChange(r,i);else{var o=e.queryViewsByTarget[n];c(!!o,"Missing QueryView for non-limbo query: "+n),r.mapping.filterUpdates(o.view.syncedDocuments)}}),this.localStore.applyRemoteEvent(t).then(function(n){return e.emitNewSnapsAndNotifyLocalStore(n,t)})},t.prototype.applyOnlineStateChange=function(t){var e=[];this.queryViewsByQuery.forEach(function(n,r){var i=r.view.applyOnlineStateChange(t);c(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&e.push(i.snapshot)}),this.viewHandler(e)},t.prototype.rejectListen=function(t,e){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[t];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[t];var i=new _e(Ie.comparator);i=i.insert(r,new Ae(r,cn.forDeletedDoc()));var o=ot().add(r),a=new Cn(cn.MIN,{},i,o);return this.applyRemoteEvent(a)}var s=this.queryViewsByTarget[t];return c(!!s,"Unknown targetId: "+t),this.localStore.releaseQuery(s.query).then(function(){return n.removeAndCleanupQuery(s).then(function(){n.errorHandler(s.query,e)})})},t.prototype.applySuccessfulWrite=function(t){var e=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t.batch.batchId,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(t){return n.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new _e(F)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(c(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){return this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.limboDocumentRefs.removeReferencesForId(t.targetId),this.gcLimboDocuments()},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Sr?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof Ar?(o("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t)):u("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){o("SyncEngine","New document in limbo: "+e);var n=this.targetIdGenerator.next(),r=$e.atPath(e.path);this.limboKeysByTarget[n]=e,this.remoteStore.listen(new ln(r,n,Re.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.gcLimboDocuments=function(){var t=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var n=t.limboTargetsByKey.get(e);null!==n&&(t.remoteStore.unlisten(n),t.limboTargetsByKey=t.limboTargetsByKey.remove(e),delete t.limboKeysByTarget[n])})}).toPromise()},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){var n=this,r=[],i=[],o=[];return this.queryViewsByQuery.forEach(function(a,s){o.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?n.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var o=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,o);return n.updateTrackedLimbos(s.targetId,a.limboChanges).then(function(){if(a.snapshot){r.push(a.snapshot);var t=vr.fromSnapshot(a.snapshot);i.push(t)}})}))}),Promise.all(o).then(function(){return n.viewHandler(r),n.localStore.notifyLocalViewChanges(i)}).then(function(){return n.localStore.collectGarbage()})},t.prototype.assertSubscribed=function(t){c(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleUserChange=function(t){var e=this;return this.currentUser=t,this.localStore.handleUserChange(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)}).then(function(){return e.remoteStore.handleUserChange(t)})},t}(),Cr=-1,Dr=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&c(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;c(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&c(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=e,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t)&&(e=i.applyToLocalView(e,n,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=ot(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&q(this.mutations,t.mutations)},t.prototype.isTombstone=function(){return 0===this.mutations.length},t.prototype.toTombstone=function(){return new t(this.batchId,this.localWriteTime,[])},t}(),Or=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){c(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=it(),a=e.mutations,s=0;s<a.length;s++){var u=r[s].version;null===u&&(u=n),o=o.insert(a[s].key,u)}return new t(e,n,r,i,o)},t}(),Rr="",xr="",Lr="",Pr="",Mr=function(){function t(t,e){this.seconds=t,this.nanoseconds=e}return t}(),Br=function(){function t(t,e){this.ownerId=t,this.leaseTimestampMs=e}return t.store="owner",t}(),Ur=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Fr=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath=["userId","batchId"],t}(),Vr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,dt(e)]},t.key=function(t,e,n){return[t,dt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),qr=function(){function t(t,e){this.path=t,this.readTime=e}return t}(),jr=function(){function t(t,e){this.noDocument=t,this.document=e}return t.store="remoteDocuments",t}(),Wr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),Kr=function(){function t(t,e){this.targetId=t,this.path=e}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Hr=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Gr=[Ur.store,Fr.store,Vr.store,jr.store,Wr.store,Br.store,Hr.store,Kr.store],Qr=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t}(),zr=function(){function e(t){this.db=t}return e.openOrCreate=function(t,n,r){return c(e.isAvailable(),"IndexedDB not supported in current environment."),o("SimpleDb","Opening database:",t),new yr(function(i,a){var s=window.indexedDB.open(t,n);s.onsuccess=function(t){var n=t.target.result;i(new e(n))},s.onerror=function(t){a(t.target.error)},s.onupgradeneeded=function(e){o("SimpleDb",'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result,i=new Yr(s.transaction);r(n,i,e.oldVersion,2).next(function(){o("SimpleDb","Database upgrade to version 2 complete")})}}).toPromise()},e.delete=function(t){return o("SimpleDb","Removing database:",t),St(window.indexedDB.deleteDatabase(t)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===t.env.USE_MOCK_PERSISTENCE;var e=window.navigator.userAgent;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0)},e.prototype.runTransaction=function(t,e,n){var r=Yr.open(this.db,t,e),i=n(r).catch(function(t){r.abort(t)}).toPromise();return r.completionPromise.then(function(){return i})},e.prototype.close=function(){this.db.close()},e}(),Xr=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return St(this.dbCursor.delete())},t}(),Yr=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Qr,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){e.completionDeferred.reject(t.target.error)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(o("SimpleDb","Aborting transaction: %s",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return c(!!e,"Object store not part of transaction: "+t),new Jr(e)},t}(),Jr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),St(n)},t.prototype.get=function(t){var e=this;return St(this.store.get(t)).next(function(n){return void 0===n&&(n=null),o("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return o("SimpleDb","DELETE",this.store.name,t),St(this.store.delete(t))},t.prototype.count=function(){return o("SimpleDb","COUNT",this.store.name),St(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateCursor=function(t,e){var n=[];return new yr(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(!i)return void r();var o=new Xr(i),a=e(i.primaryKey,i.value,o);a instanceof yr&&n.push(a),o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}}).next(function(){return yr.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(c(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),$r=function(){function t(t,e){this.userId=t,this.serializer=e,this.garbageCollector=null}return t.forUser=function(e,n){return c(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n)},t.prototype.start=function(e){var n=this;return t.loadNextBatchIdFromDb(e).next(function(t){return n.nextBatchId=t,Nt(e).get(n.userId)}).next(function(t){return t||(t=new Ur(n.userId,Cr,"")),n.metadata=t,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(e).next(function(t){return c(t,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=Cr,Nt(e).put(n.metadata)}):yr.resolve()})},t.loadNextBatchIdFromDb=function(t){var e=Cr;return _t(t).iterate({reverse:!0},function(t,n,r){var i=t[0];if(t[1]>e&&(e=n.batchId),""===i)r.done();else{var o=j(i);r.skip([o])}}).next(function(){return e+1})},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return _t(t).iterate({range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.getNextBatchId=function(t){return yr.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return yr.resolve(this.metadata.lastAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;return c(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=At(n),Nt(t).put(this.metadata)},t.prototype.getLastStreamToken=function(t){return yr.resolve(this.metadata.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.metadata.lastStreamToken=At(e),Nt(t).put(this.metadata)},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=this.nextBatchId;this.nextBatchId++;var o=new Dr(i,e,n),a=this.serializer.toDbMutationBatch(this.userId,o);return _t(t).put(a).next(function(){for(var e=[],o=0,a=n;o<a.length;o++){var s=a[o],u=Vr.key(r.userId,s.key.path,i);e.push(kt(t).put(u,Vr.PLACEHOLDER))}return yr.waitFor(e)}).next(function(){return o})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return _t(t).get(this.keyForBatchId(e)).next(function(t){return t?n.serializer.fromDbMutationBatch(t):null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=Math.max(e,this.metadata.lastAcknowledgedBatchId)+1,i=IDBKeyRange.lowerBound(this.keyForBatchId(r)),o=null;return _t(t).iterate({range:i},function(t,e,i){e.userId===n.userId&&(c(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound(this.keyForBatchId(Cr),this.keyForBatchId(Number.POSITIVE_INFINITY));return _t(t).loadAll(n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(Cr),this.keyForBatchId(e));return _t(t).loadAll(r).next(function(t){return t.map(function(t){return n.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Vr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return kt(t).iterate({range:i},function(r,i,a){var s=r[0],c=r[1],h=r[2],l=yt(c);if(s!==n.userId||!e.path.isEqual(l))return void a.done();var f=n.keyForBatchId(h);return _t(t).get(f).next(function(t){null===t&&u("Dangling document-mutation reference found: "+r+" which points to "+f),o.push(n.serializer.fromDbMutationBatch(t))})}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;c(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=Vr.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Sn(F);return kt(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=yt(u);if(a!==n.userId||!r.isPrefixOf(h))return void o.done();h.length===i&&(s=s.add(c))}).next(function(){var e=[],r=[];return s.forEach(function(i){var o=n.keyForBatchId(i);r.push(_t(t).get(o).next(function(t){null===t&&u("Dangling document-mutation reference found, which points to "+o),e.push(n.serializer.fromDbMutationBatch(t))}))}),yr.waitFor(r).next(function(){return e})})},t.prototype.removeMutationBatches=function(t,e){for(var n=_t(t),r=kt(t),i=[],o=this,a=0,s=e;a<s.length;a++){var u=s[a];!function(t){var e=IDBKeyRange.only(o.keyForBatchId(t.batchId)),a=0,s=n.iterate({range:e},function(t,e,n){return a++,n.delete()});i.push(s.next(function(){c(1===a,"Dangling document-mutation reference found: Missing batch "+t.batchId)}));for(var u=0,h=t.mutations;u<h.length;u++){var l=h[u],f=Vr.key(o.userId,l.key.path,t.batchId);i.push(r.delete(f)),null!==o.garbageCollector&&o.garbageCollector.addPotentialGarbageKey(l.key)}}(u)}return yr.waitFor(i)},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return yr.resolve();var r=IDBKeyRange.lowerBound(Vr.prefixForUser(e.userId)),i=[];return kt(t).iterate({range:r},function(t,n,r){if(t[0]!==e.userId)return void r.done();var o=yt(t[1]);i.push(o)}).next(function(){c(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=this,r=Vr.prefixForPath(this.userId,e.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return kt(t).iterate({range:o,keysOnly:!0},function(t,e,r){var o=t[0],s=t[1];t[2];o===n.userId&&s===i&&(a=!0),r.done()}).next(function(){return a})},t.prototype.keyForBatchId=function(t){return[this.userId,t]},t}(),Zr=function(){function t(t){this.serializer=t,this.lastRemoteSnapshotVersion=cn.MIN,this.metadata=null,this.garbageCollector=null}return t.prototype.start=function(t){var e=this;return Ot(t).get(Hr.key).next(function(t){c(null!==t,"Missing metadata row that should be added by schema migration."),e.metadata=t;var n=t.lastRemoteSnapshotVersion;return e.lastRemoteSnapshotVersion=cn.fromTimestamp(new me(n.seconds,n.nanoseconds)),yr.resolve()})},t.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,this.metadata.lastRemoteSnapshotVersion=e.toTimestamp(),Ot(t).put(Hr.key,this.metadata)},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.metadata.targetCount+=1,n.updateMetadataFromQueryData(e),n.saveMetadata(t)})},t.prototype.updateQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.updateMetadataFromQueryData(e)?n.saveMetadata(t):yr.resolve()})},t.prototype.removeQueryData=function(t,e){var n=this;return c(this.metadata.targetCount>0,"Removing from an empty query cache"),this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Dt(t).delete(e.targetId)}).next(function(){return n.metadata.targetCount-=1,n.saveMetadata(t)})},t.prototype.saveMetadata=function(t){return Ot(t).put(Hr.key,this.metadata)},t.prototype.saveQueryData=function(t,e){return Dt(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t){var e=!1;return t.targetId>this.metadata.highestTargetId&&(this.metadata.highestTargetId=t.targetId,e=!0),e},Object.defineProperty(t.prototype,"count",{get:function(){return this.metadata.targetCount},enumerable:!0,configurable:!0}),t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Dt(t).iterate({range:i,index:Wr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=[],i=Rt(t);return e.forEach(function(t){var e=dt(t.path);r.push(i.put(new Kr(n,e)))}),yr.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=[],o=Rt(t);return e.forEach(function(t){var e=dt(t.path);i.push(o.delete([n,e])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(t)}),yr.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Rt(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return this.notifyGCForRemovedKeys(t,r).next(function(){return n.delete(r)})},t.prototype.notifyGCForRemovedKeys=function(t,e){var n=this,r=Rt(t);return null!==this.garbageCollector&&this.garbageCollector.isEager?r.iterate({range:e,keysOnly:!0},function(t,e,r){var i=yt(t[1]),o=new Ie(i);c(null!==n.garbageCollector,"GarbageCollector for query cache set to null during key removal."),n.garbageCollector.addPotentialGarbageKey(o)}):yr.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Rt(t),i=ot();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=yt(t[1]),o=new Ie(r);i=i.add(o)}).next(function(){return i})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){c(null!==t,"Persistence Transaction cannot be null for query cache containsKey");var n=dt(e.path),r=IDBKeyRange.bound([n],[W(n)],!1,!0),i=0;return Rt(t).iterate({index:Kr.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){i++,n.done()}).next(function(){return i>0})},t}(),ti=function(){function t(t){this.serializer=t}return t.prototype.addEntry=function(t,e){return Lt(t).put(Pt(e.key),this.serializer.toDbRemoteDocument(e))},t.prototype.removeEntry=function(t,e){return Lt(t).delete(Pt(e))},t.prototype.getEntry=function(t,e){var n=this;return Lt(t).get(Pt(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=rt(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return Lt(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof Se&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t}(),ei=function(){function e(t){this.remoteSerializer=t}return e.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document);if(t.noDocument){var e=Ie.fromSegments(t.noDocument.path),n=t.noDocument.readTime,r=new me(n.seconds,n.nanoseconds);return new Ae(e,cn.fromTimestamp(r))}return u("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(t){if(t instanceof Se){var e=this.remoteSerializer.toDocument(t);return new jr(null,e)}var n=t.key.path.toArray(),r=t.version.toTimestamp(),i=new Mr(r.seconds,r.nanoseconds);return new jr(new qr(n,i),null)},e.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Fr(t,e.batchId,e.localWriteTime.toMillis(),r)},e.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=me.fromMillis(t.localWriteTimeMs);return new Dr(t.batchId,r,n)},e.prototype.fromDbTarget=function(t){var e,n=new me(t.readTime.seconds,t.readTime.nanoseconds),r=cn.fromTimestamp(n);return e=Mt(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new ln(e,t.targetId,Re.Listen,r,t.resumeToken)},e.prototype.toDbTarget=function(e){c(Re.Listen===e.purpose,"Only queries with purpose "+Re.Listen+" may be stored, got "+e.purpose);var n,r=e.snapshotVersion.toTimestamp(),i=new Mr(r.seconds,r.nanoseconds);n=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query);var o;return e.resumeToken instanceof Uint8Array?(c("YES"===t.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),o=e.resumeToken.toString()):o=e.resumeToken,new Wr(e.targetId,e.query.canonicalId(),i,o,0,n)},e}(),ni="IndexedDbPersistence",ri="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",ii=function(){function t(e,n){this.ownerId=this.generateOwnerId(),this.dbName=e+t.MAIN_DATABASE,this.serializer=new ei(n),this.localStoragePrefix=e}return t.prototype.start=function(){var e=this;return t.isAvailable()?(c(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,zr.openOrCreate(this.dbName,2,gt).then(function(t){e.simpleDb=t}).then(function(){return e.tryAcquireOwnerLease()}).then(function(){e.scheduleOwnerLeaseRefreshes(),e.attachWindowUnloadHook()})):(this.persistenceError=new he(ce.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled."),Promise.reject(this.persistenceError))},t.prototype.shutdown=function(t){var e=this;return c(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){if(e.simpleDb.close(),t)return zr.delete(e.dbName)})},t.prototype.getMutationQueue=function(t){return $r.forUser(t,this.serializer)},t.prototype.getQueryCache=function(){return new Zr(this.serializer)},t.prototype.getRemoteDocumentCache=function(){return new ti(this.serializer)},t.prototype.runTransaction=function(t,e){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(o(ni,"Starting transaction:",t),this.simpleDb.runTransaction("readwrite",Gr,function(t){return n.ensureOwnerLease(t).next(function(){return e(t)})}))},t.isAvailable=function(){return zr.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.tryAcquireOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[Br.store],function(e){var n=e.store(Br.store);return n.get("owner").next(function(e){if(t.validOwner(e))return o(ni,"Valid owner already. Failing. Current owner:",e),t.persistenceError=new he(ce.FAILED_PRECONDITION,ri),yr.reject(t.persistenceError);var r=new Br(t.ownerId,Date.now());return o(ni,"No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",r),n.put("owner",r)})})},t.prototype.releaseOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[Br.store],function(e){var n=e.store(Br.store);return n.get("owner").next(function(e){return null!==e&&e.ownerId===t.ownerId?(o(ni,"Releasing owner lease."),n.delete("owner")):yr.resolve()})})},t.prototype.ensureOwnerLease=function(t){var e=this;return t.store(Br.store).get("owner").next(function(t){return null===t||t.ownerId!==e.ownerId?(e.persistenceError=new he(ce.FAILED_PRECONDITION,ri),yr.reject(e.persistenceError)):yr.resolve()})},t.prototype.validOwner=function(t){var e=Date.now(),n=e-5e3,r=e;return null!==t&&(!(t.leaseTimestampMs<n)&&(t.leaseTimestampMs>r?(a("Persistence owner-lease is in the future. Discarding.",t),!1):t.ownerId!==this.getZombiedOwnerId()))},t.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(Br.store).put("owner",new Br(t.ownerId,Date.now()))}).catch(function(e){a(e),t.stopOwnerLeaseRefreshes()})},4e3)},t.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"object"===("undefined"==typeof window?"undefined":te(window))&&"function"==typeof window.addEventListener&&(this.windowUnloadHandler=function(){t.setZombiedOwnerId(t.ownerId),t.shutdown()},window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(c("object"===("undefined"==typeof window?"undefined":te(window))&&"function"==typeof window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.getZombiedOwnerId=function(){try{var t=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return o(ni,"Zombied ownerID from LocalStorage:",t),t}catch(t){return a("Failed to get zombie owner id.",t),null}},t.prototype.setZombiedOwnerId=function(t){try{null===t?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),t)}catch(t){a("Failed to set zombie owner id.",t)}},t.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+"zombiedOwnerId"},t.prototype.generateOwnerId=function(){return le.newId()},t.MAIN_DATABASE="main",t}(),oi=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.remoteDocumentCache.getEntry(t,e).next(function(r){return n.computeLocalDocument(t,e,r)})},t.prototype.getDocuments=function(t,e){var n=this,r=[],i=nt();return e.forEach(function(e){r.push(n.getDocument(t,e).next(function(t){t||(t=new Ae(e,cn.forDeletedDoc())),i=i.insert(e,t)}))}),yr.waitFor(r).next(function(){return i})},t.prototype.getDocumentsMatchingQuery=function(t,e){return Ie.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Ie(e)).next(function(t){var e=rt();return t instanceof Se&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(e){return r.computeLocalDocuments(t,e)}).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){for(var i=ot(),o=0,a=e;o<a.length;o++)for(var s=a[o],u=0,c=s.mutations;u<c.length;u++){var h=c[u];n.get(h.key)||(i=i.add(h.key))}var l=[];return i.forEach(function(e){l.push(r.getDocument(t,e).next(function(t){t instanceof Se&&(n=n.insert(t.key,t))}))}),yr.waitFor(l)}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.computeLocalDocument=function(t,e,n){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];n=o.applyToLocalView(e,n)}return n})},t.prototype.computeLocalDocuments=function(t,e){var n=this,r=[];return e.forEach(function(i,o){r.push(n.computeLocalDocument(t,i,o).next(function(t){t instanceof Se?e=e.insert(t.key,t):t instanceof Ae?e=e.remove(t.key):u("Unknown MaybeDocument: "+t)}))}),yr.waitFor(r).next(function(){return e})},t}(),ai=function(){function t(t){this.remoteDocumentCache=t,this.changes=nt()}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this.assertChanges(),r=n.get(e);return r?yr.resolve(r):this.remoteDocumentCache.getEntry(t,e)},t.prototype.apply=function(t){var e=this,n=this.assertChanges(),r=[];return n.forEach(function(n,i){r.push(e.remoteDocumentCache.addEntry(t,i))}),this.changes=null,yr.waitFor(r)},t.prototype.assertChanges=function(){return c(null!==this.changes,"Changes have already been applied."),this.changes},t}(),si=function(){function t(t,e,n){this.persistence=t,this.garbageCollector=n,this.localViewReferences=new br,this.targetIds={},this.targetIdGenerator=Ir.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new oi(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return t.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.garbageCollector.removeGarbageSource(e.mutationQueue),e.mutationQueue=e.persistence.getMutationQueue(t),e.garbageCollector.addGarbageSource(e.mutationQueue),e.startMutationQueue(n)}).next(function(){return e.localDocuments=new oi(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=ot(),o=0,a=[r,t];o<a.length;o++)for(var s=a[o],u=0,c=s;u<c.length;u++)for(var h=c[u],l=0,f=h.mutations;l<f.length;l++){var d=f[l];i=i.add(d.key)}return e.localDocuments.getDocuments(n,i)})})},t.prototype.startQueryCache=function(t){var e=this;return this.queryCache.start(t).next(function(){var t=e.queryCache.getHighestTargetId();e.targetIdGenerator=Ir.forLocalStore(t)})},t.prototype.startMutationQueue=function(t){var e=this;return this.mutationQueue.start(t).next(function(){return e.heldBatchResults=[],e.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(n){return n!==Cr?e.mutationQueue.getAllMutationBatchesThroughBatchId(t,n):yr.resolve([])}).next(function(n){return n.length>0?e.mutationQueue.removeMutationBatches(t,n):yr.resolve()})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,i=me.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){r=t;var i=r.keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){if(e.shouldHoldBatchResult(t.commitVersion))return e.heldBatchResults.push(t),r=ot(),yr.resolve();var i=new ai(e.remoteDocuments);return e.releaseBatchResults(n,[t],i).next(function(t){return r=t,i.apply(n)})}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch",function(n){var r,i;return e.mutationQueue.lookupMutationBatch(n,t).next(function(i){return c(null!=i,"Attempt to reject nonexistent batch!"),r=i,e.mutationQueue.getHighestAcknowledgedBatchId(n).next(function(e){return c(t>e,"Acknowledged batches can't be rejected."),r})}).next(function(){return e.removeMutationBatch(n,r)}).next(function(t){return i=t,e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,i)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},t.prototype.applyRemoteEvent=function(t){var e=this,n=new ai(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(r){var i=[];p(t.targetChanges,function(t,n){var o=e.targetIds[t];if(o){var a=n.mapping;if(a)if(a instanceof Rn)i.push(e.queryCache.removeMatchingKeysForTargetId(r,t).next(function(){return e.queryCache.addMatchingKeys(r,a.documents,t)}));else{if(!(a instanceof xn))return u("Unknown mapping type: "+JSON.stringify(a));i.push(e.queryCache.removeMatchingKeys(r,a.removedDocuments,t).next(function(){return e.queryCache.addMatchingKeys(r,a.addedDocuments,t)}))}var s=n.resumeToken;s.length>0&&(o=o.update({resumeToken:s,snapshotVersion:n.snapshotVersion}),e.targetIds[t]=o,i.push(e.queryCache.updateQueryData(r,o)))}});var a=ot();t.documentUpdates.forEach(function(t,s){a=a.add(t),i.push(n.getEntry(r,t).next(function(r){null==r||s.version.isEqual(cn.MIN)||s.version.compareTo(r.version)>=0?n.addEntry(s):o("LocalStore","Ignoring outdated watch update for ",t,". Current version:",r.version," Watch version:",s.version),e.garbageCollector.addPotentialGarbageKey(t)}))});var s=e.queryCache.getLastRemoteSnapshotVersion(),h=t.snapshotVersion;h.isEqual(cn.MIN)||(c(h.compareTo(s)>=0,"Watch stream reverted to previous snapshot?? "+h+" < "+s),i.push(e.queryCache.setLastRemoteSnapshotVersion(r,h)));var l;return yr.waitFor(i).next(function(){return e.releaseHeldBatchResults(r,n)}).next(function(t){return l=t,n.apply(r)}).next(function(){return e.localDocuments.getDocuments(r,a.unionWith(l))})})},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("Notify local view changes",function(n){for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];!function(t){r.push(e.queryCache.getQueryData(n,t.query).next(function(n){c(null!==n,"Local view changes contain unallocated query.");var r=n.targetId;e.localViewReferences.addReferences(t.addedKeys,r),e.localViewReferences.removeReferences(t.removedKeys,r)}))}(a)}return yr.waitFor(r)})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch",function(n){return void 0===t&&(t=Cr),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){if(i)return r=i,yr.resolve();var o=e.targetIdGenerator.next();return r=new ln(t,o,Re.Listen),e.queryCache.addQueryData(n,r)}).next(function(){return c(!e.targetIds[r.targetId],"Tried to allocate an already allocated query: "+t),e.targetIds[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t){var e=this;return this.persistence.runTransaction("Release query",function(n){return e.queryCache.getQueryData(n,t).next(function(r){return c(null!=r,"Tried to release nonexistent query: "+t),e.localViewReferences.removeReferencesForId(r.targetId),delete e.targetIds[r.targetId],e.garbageCollector.isEager?e.queryCache.removeQueryData(n,r):yr.resolve()}).next(function(){if(y(e.targetIds)){var t=new ai(e.remoteDocuments);return e.releaseHeldBatchResults(n,t).next(function(){t.apply(n)})}return yr.resolve()})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.collectGarbage=function(){var t=this;return this.persistence.runTransaction("Garbage collection",function(e){return t.garbageCollector.collectGarbage(e).next(function(n){var r=[];return n.forEach(function(n){r.push(t.remoteDocuments.removeEntry(e,n))}),yr.waitFor(r)})})},t.prototype.releaseHeldBatchResults=function(t,e){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?yr.resolve(ot()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(t,n,e))},t.prototype.isRemoteUpToVersion=function(t){var e=this.queryCache.getLastRemoteSnapshotVersion();return t.compareTo(e)<=0||y(this.targetIds)},t.prototype.shouldHoldBatchResult=function(t){return!this.isRemoteUpToVersion(t)||this.heldBatchResults.length>0},t.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=yr.resolve(),o=0,a=e;o<a.length;o++){var s=a[o];!function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})}(s)}return i.next(function(){return r.removeMutationBatches(t,e.map(function(t){return t.batch}))})},t.prototype.removeMutationBatch=function(t,e){return this.removeMutationBatches(t,[e])},t.prototype.removeMutationBatches=function(t,e){for(var n=ot(),r=0,i=e;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;n=n.add(c)}return this.mutationQueue.removeMutationBatches(t,e).next(function(){return n})},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=e.batch,i=r.keys(),o=yr.resolve();return i.forEach(function(i){o=o.next(function(){return n.getEntry(t,i)}).next(function(t){var o=t,a=e.docVersions.get(i);c(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&(o=r.applyToRemoteDocument(i,o,e),o?n.addEntry(o):c(!t,"Mutation batch "+r+" applied to document "+t+" resulted in null"))})}),o},t}(),ui=function(){function t(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=Cr,this.lastStreamToken=h(),this.garbageCollector=null,this.batchesByDocumentKey=new Sn(wr.compareByKey)}return t.prototype.start=function(t){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=Cr),c(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),yr.resolve()},t.prototype.checkEmpty=function(t){return yr.resolve(0===this.mutationQueue.length)},t.prototype.getNextBatchId=function(t){return yr.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return yr.resolve(this.highestAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;c(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return c(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),c(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,yr.resolve()},t.prototype.getLastStreamToken=function(t){return yr.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,yr.resolve()},t.prototype.addMutationBatch=function(t,e,n){c(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;if(this.nextBatchId++,this.mutationQueue.length>0){c(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order")}var i=new Dr(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new wr(s.key,r))}return yr.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return yr.resolve(this.findMutationBatch(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){for(var n=this.mutationQueue.length,r=Math.max(e,this.highestAcknowledgedBatchId)+1,i=this.indexOfBatchId(r),o=i<0?0:i;o<n;o++){var a=this.mutationQueue[o];if(!a.isTombstone())return yr.resolve(a)}return yr.resolve(null)},t.prototype.getAllMutationBatches=function(t){return yr.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this.mutationQueue.length,r=this.indexOfBatchId(e);return r<0?r=0:r>=n?r=n:r++,yr.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new wr(e,0),i=new wr(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){c(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);c(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),yr.resolve(o)},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=r;Ie.isDocumentKey(o)||(o=o.child(""));var a=new wr(new Ie(o),0),s=new Sn(F);this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(t){var e=n.findMutationBatch(t);null!==e&&u.push(e)}),yr.resolve(u)},t.prototype.removeMutationBatches=function(t,e){var n=e.length;c(n>0,"Should not remove mutations when none exist.");var r=e[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");c(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;){var u=this.mutationQueue[s];u.isTombstone()?s++:(c(u.batchId===e[a].batchId,"Removed batches must be contiguous in the queue"),a++,s++)}if(0===o){for(;s<i;s++){var u=this.mutationQueue[s];if(!u.isTombstone())break}var h=s-o;this.mutationQueue.splice(o,h)}else for(var l=o;l<s;l++)this.mutationQueue[l]=this.mutationQueue[l].toTombstone();for(var f=this.batchesByDocumentKey,d=0,p=e;d<p.length;d++)for(var u=p[d],m=u.batchId,y=0,g=u.mutations;y<g.length;y++){var v=g[y],b=v.key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(b);var w=new wr(b,m);f=f.delete(w)}return this.batchesByDocumentKey=f,yr.resolve()},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new wr(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return yr.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&c(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),yr.resolve()},t.prototype.getAllLiveMutationBatchesBeforeIndex=function(t){for(var e=[],n=0;n<t;n++){var r=this.mutationQueue[n];r.isTombstone()||e.push(r)}return e},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return c(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return c(n.batchId===t,"If found batch must match"),n.isTombstone()?null:n},t}(),ci=function(){function t(){this.queries=new fr(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=cn.MIN,this.highestTargetId=0,this.references=new br,this.targetCount=0}return t.prototype.start=function(t){return yr.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.getHighestTargetId=function(){return this.highestTargetId},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,yr.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e)},t.prototype.addQueryData=function(t,e){return c(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,yr.resolve()},t.prototype.updateQueryData=function(t,e){return c(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),yr.resolve()},t.prototype.removeQueryData=function(t,e){return c(this.targetCount>0,"Removing a target from an empty cache"),c(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,yr.resolve()},Object.defineProperty(t.prototype,"count",{get:function(){return this.targetCount},enumerable:!0,configurable:!0}),t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return yr.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.references.addReferences(e,n),yr.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){return this.references.removeReferences(e,n),yr.resolve()},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),yr.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return yr.resolve(n)},t.prototype.setGarbageCollector=function(t){this.references.setGarbageCollector(t)},t.prototype.containsKey=function(t,e){return this.references.containsKey(t,e)},t}(),hi=function(){function t(){this.docs=nt()}return t.prototype.addEntry=function(t,e){return this.docs=this.docs.insert(e.key,e),yr.resolve()},t.prototype.removeEntry=function(t,e){return this.docs=this.docs.remove(e),yr.resolve()},t.prototype.getEntry=function(t,e){return yr.resolve(this.docs.get(e))},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=rt(),r=new Ie(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!e.path.isPrefixOf(a.path))break;s instanceof Se&&e.matches(s)&&(n=n.insert(s.key,s))}return yr.resolve(n)},t}(),li=function(){function t(){this.mutationQueues={},this.remoteDocumentCache=new hi,this.queryCache=new ci,this.started=!1}return t.prototype.start=function(){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return c(!this.started,"MemoryPersistence double-started!"),this.started=!0,[2]})})},t.prototype.shutdown=function(t){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return c(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,[2]})})},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new ui,this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e){return o("MemoryPersistence","Starting transaction:",t),e(new fi).toPromise()},t}(),fi=function(){function t(){}return t}(),di=function(){function t(){this.isEager=!1}return t.prototype.addGarbageSource=function(t){},t.prototype.removeGarbageSource=function(t){},t.prototype.addPotentialGarbageKey=function(t){},t.prototype.collectGarbage=function(t){return yr.resolve(ot())},t}();!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout"}(Tr||(Tr={}));var pi,mi=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Qr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=Date.now()+r,s=new t(e,n,a,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new he(ce.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueue(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),yi=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw a("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),c(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=mi.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&u("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){c(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){return this.delayedOperations.findIndex(function(e){return e.timerId===t})>=0},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){c(t===Tr.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==Tr.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);c(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),gi=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){this.cancel();var e=this.currentBaseMs+this.jitterDelayMs();this.currentBaseMs>0&&o("ExponentialBackoff","Backing off for "+e+" ms (base delay: "+this.currentBaseMs+" ms)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,e,t),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Auth=1]="Auth",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t[t.Stopped=5]="Stopped"}(pi||(pi={}));var vi,bi=1e3,wi=6e4,Ei=1.5,Ti=function(){function t(t,e,n,r,i){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.inactivityTimerPromise=null,this.stream=null,this.listener=null,this.backoff=new gi(t,e,bi,Ei,wi),this.state=pi.Initial}return t.prototype.isStarted=function(){return this.state===pi.Backoff||this.state===pi.Auth||this.state===pi.Open},t.prototype.isOpen=function(){return this.state===pi.Open},t.prototype.start=function(t){if(this.state===pi.Error)return void this.performBackoff(t);c(this.state===pi.Initial,"Already started"),this.listener=t,this.auth()},t.prototype.stop=function(){this.isStarted()&&this.close(pi.Stopped)},t.prototype.inhibitBackoff=function(){c(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=pi.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.inactivityTimerPromise&&(this.inactivityTimerPromise=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return this.isOpen()?[2,this.close(pi.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.inactivityTimerPromise&&(this.inactivityTimerPromise.cancel(),this.inactivityTimerPromise=null)},t.prototype.close=function(t,e){return ie.__awaiter(this,void 0,void 0,function(){var n;return ie.__generator(this,function(r){return c(t===pi.Error||z(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),t!==pi.Error?this.backoff.reset():e&&e.code===ce.RESOURCE_EXHAUSTED&&(a(e.toString()),a("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,n=this.listener,this.listener=null,t!==pi.Stopped?[2,n.onClose(e)]:[2]})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;c(this.state===pi.Initial,"Must be in initial state to auth"),this.state=pi.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(e){t.queue.enqueue(function(){return ie.__awaiter(t,void 0,void 0,function(){var t;return ie.__generator(this,function(n){return this.state!==pi.Stopped?(t=new he(ce.UNKNOWN,"Fetching auth token failed: "+e.message),[2,this.handleStreamClose(t)]):[2]})})})})},t.prototype.startStream=function(t){var e=this;if(this.state!==pi.Stopped){c(this.state===pi.Auth,"Trying to start stream in a non-auth state");var n=function(t,n){e.queue.enqueue(function(){return ie.__awaiter(e,void 0,void 0,function(){return ie.__generator(this,function(e){return this.stream===t?[2,n()]:[2]})})})};if(null!==this.listener){var r=this.startRpc(t);this.stream=r,this.stream.onOpen(function(){n(r,function(){return c(e.state===pi.Auth,"Expected stream to be in state auth, but was "+e.state),e.state=pi.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(r,function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(r,function(){return e.onMessage(t)})})}}},t.prototype.performBackoff=function(t){var e=this;c(this.state===pi.Error,"Should only perform backoff in an error case"),this.state=pi.Backoff,this.backoff.backoffAndRun(function(){return ie.__awaiter(e,void 0,void 0,function(){return ie.__generator(this,function(e){return this.state===pi.Stopped?[2]:(this.state=pi.Initial,this.start(t),c(this.isStarted(),"PersistentStream should have started"),[2])})})})},t.prototype.handleStreamClose=function(t){return c(this.isStarted(),"Can't handle server close on non-started stream"),o("PersistentStream","close with error: "+t),this.stream=null,this.close(pi.Error,t)},t}(),Ii=function(t){function e(e,n,r,i){var o=t.call(this,e,Tr.ListenStreamConnectionBackoff,Tr.ListenStreamIdle,n,r)||this;return o.serializer=i,o}return ie.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Ti),Si=function(t){function e(e,n,r,i){var o=t.call(this,e,Tr.WriteStreamConnectionBackoff,Tr.WriteStreamIdle,n,r)||this;return o.serializer=i,o.handshakeComplete_=!1,o}return ie.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.handshakeComplete_=!1,t.prototype.start.call(this,e)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(c(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return c(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){c(this.isOpen(),"Writing handshake requires an opened stream"),c(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;c(this.isOpen(),"Writing mutations requires an opened stream"),c(this.handshakeComplete_,"Handshake must be complete before writing mutations"),c(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Ti),Ai=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(){return new Si(this.queue,this.connection,this.credentials,this.serializer)},t.prototype.newPersistentWatchStream=function(){return new Ii(this.queue,this.connection,this.credentials,this.serializer)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=nt();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);c(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeRPC(t,e,r)})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeStreamingRPC(t,e,r)})},t}(),_i=function(){function t(t){this.datastore=t,this.readVersions=it(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e=t.version;t instanceof Ae&&(e=cn.forDeletedDoc());var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new he(ce.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){return e.recordVersion(t)}),t})},t.prototype.write=function(t){if(this.committed)throw new he(ce.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?yn.updateTime(e):yn.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(cn.forDeletedDoc()))throw new he(ce.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?yn.updateTime(e):yn.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new En(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,cn.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}(),ki=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=rr.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(rr.Unknown),c(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(Tr.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,c(t.state===rr.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(rr.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===rr.Online?(this.setAndBroadcast(rr.Unknown),c(0===this.watchStreamFailures,"watchStreamFailures must be 0"),c(null===this.onlineStateTimer,"onlineStateTimer must be null")):++this.watchStreamFailures>=2&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 2 times. Most recent error: "+t.toString()),this.setAndBroadcast(rr.Offline))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===rr.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(a(e),this.shouldWarnClientIsOffline=!1):o("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),Ni=function(){function t(t,e,n,r){this.localStore=t,this.datastore=e,this.pendingWrites=[],this.lastBatchSeen=Cr,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.onlineStateTracker=new ki(n,r)}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.isNetworkEnabled=function(){return c(null==this.watchStream==(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},t.prototype.enableNetwork=function(){var t=this;return this.isNetworkEnabled()?Promise.resolve():(this.watchStream=this.datastore.newPersistentWatchStream(),this.writeStream=this.datastore.newPersistentWriteStream(),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()?t.startWatchStream():t.onlineStateTracker.set(rr.Unknown),t.fillWritePipeline()}))},t.prototype.disableNetwork=function(){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return this.disableNetworkInternal(),this.onlineStateTracker.set(rr.Offline),[2]})})},t.prototype.disableNetworkInternal=function(){this.isNetworkEnabled()&&(this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null)},t.prototype.shutdown=function(){return o("RemoteStore","RemoteStore shutting down."),this.disableNetworkInternal(),this.onlineStateTracker.set(rr.Unknown),Promise.resolve()},t.prototype.listen=function(t){c(!f(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){c(f(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.isNetworkEnabled()&&this.watchStream.isOpen()&&(this.sendUnwatchRequest(t),y(this.listenTargets)&&this.watchStream.markIdle())},t.prototype.sendWatchRequest=function(t){this.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.recordPendingTargetRequest=function(t){this.pendingTargetResponses[t]=(this.pendingTargetResponses[t]||0)+1},t.prototype.startWatchStream=function(){c(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!y(this.listenTargets)},t.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},t.prototype.onWatchStreamOpen=function(){return ie.__awaiter(this,void 0,void 0,function(){var t=this;return ie.__generator(this,function(e){return p(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(e){return c(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(t&&this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(rr.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return ie.__awaiter(this,void 0,void 0,function(){var n;return ie.__generator(this,function(r){return this.onlineStateTracker.set(rr.Online),t instanceof Mn&&t.state===Dn.Removed&&t.cause?[2,this.handleTargetError(t)]:(this.accumulatedWatchChanges.push(t),!e.isEqual(cn.MIN)&&e.compareTo(this.localStore.getLastRemoteSnapshotVersion())>=0?(n=this.accumulatedWatchChanges,this.accumulatedWatchChanges=[],[2,this.handleWatchChangeBatch(e,n)]):[2])})})},t.prototype.handleWatchChangeBatch=function(t,e){var n=this,r=new Bn(t,this.listenTargets,this.pendingTargetResponses);r.addChanges(e);var i=r.createRemoteEvent();this.pendingTargetResponses=r.pendingTargetResponses;var o=[];return p(r.existenceFilters,function(e,r){var a=n.listenTargets[e];if(a){var s=a.query;if(s.isDocumentQuery())if(0===r.count){var u=new Ie(s.path),h=new Ae(u,t);i.addDocumentUpdate(h)}else c(1===r.count,"Single document existence filter with count: "+r.count);else{var l=n.localStore.remoteDocumentKeys(e).then(function(t){if(i.targetChanges[e]){var o=i.targetChanges[e].mapping;null!==o&&(o instanceof xn?t=o.applyToKeySet(t):(c(o instanceof Rn,"Expected either reset or update mapping but got something else: "+o),t=o.documents))}if(t.size!==r.count){i.handleExistenceFilterMismatch(e);var u=new ln(s,e,a.purpose);n.listenTargets[e]=u,n.sendUnwatchRequest(e);var h=new ln(s,e,Re.ExistenceFilterMismatch);n.sendWatchRequest(h)}});o.push(l)}}}),Promise.all(o).then(function(){return p(i.targetChanges,function(t,e){if(e.resumeToken.length>0){var r=n.listenTargets[t];r&&(n.listenTargets[t]=r.update({resumeToken:e.resumeToken,snapshotVersion:e.snapshotVersion}))}}),n.syncEngine.applyRemoteEvent(i)})},t.prototype.handleTargetError=function(t){var e=this;c(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return ie.__awaiter(e,void 0,void 0,function(){return ie.__generator(this,function(e){return f(this.listenTargets,t)?(delete this.listenTargets[t],[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=Cr,o("RemoteStore","Stopping write stream with "+this.pendingWrites.length+" pending writes"),this.pendingWrites=[]},t.prototype.fillWritePipeline=function(){return ie.__awaiter(this,void 0,void 0,function(){var t=this;return ie.__generator(this,function(e){return this.canWriteMutations()?[2,this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){if(null!==e)return t.commit(e),t.fillWritePipeline();0===t.pendingWrites.length&&t.writeStream.markIdle()})]:[2]})})},t.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<10},t.prototype.outstandingWrites=function(){return this.pendingWrites.length},t.prototype.commit=function(t){c(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=t.batchId,this.pendingWrites.push(t),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&this.pendingWrites.length>0},t.prototype.startWriteStream=function(){c(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})},t.prototype.onWriteStreamOpen=function(){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.pendingWrites;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})},t.prototype.onMutationResult=function(t,e){var n=this;c(this.pendingWrites.length>0,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=Or.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return ie.__awaiter(this,void 0,void 0,function(){var e,n=this;return ie.__generator(this,function(r){return c(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),t&&this.pendingWrites.length>0?(c(!!t,"We have pending writes, but the write stream closed without an error"),e=void 0,e=this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t),[2,e.then(function(){n.shouldStartWriteStream()&&n.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(e){return J(t.code)||t.code===ce.ABORTED?(o("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=h(),[2,this.localStore.setLastStreamToken(h())]):[2]})})},t.prototype.handleWriteError=function(t){return ie.__awaiter(this,void 0,void 0,function(){var e,n=this;return ie.__generator(this,function(r){return J(t.code)?(e=this.pendingWrites.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2]})})},t.prototype.createTransaction=function(){return new _i(this.datastore)},t.prototype.handleUserChange=function(t){if(o("RemoteStore","RemoteStore changing users: uid=",t.uid),this.isNetworkEnabled())return this.disableNetworkInternal(),this.onlineStateTracker.set(rr.Unknown),this.enableNetwork()},t}(),Ci=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r}return t.prototype.start=function(t){var e=this,n=new Qr,r=new Qr,i=!1;return this.credentials.setUserChangeListener(function(o){i?e.asyncQueue.enqueue(function(){return e.handleUserChange(o)}):(i=!0,e.initializePersistence(t,r).then(function(){return e.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueue(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.remoteStore.enableNetwork()})},t.prototype.initializePersistence=function(t,e){var n=this;return t?this.startIndexedDbPersistence().then(e.resolve).catch(function(t){return e.reject(t),n.canFallback(t)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),n.startMemoryPersistence()):Promise.reject(t)}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof he?t.code===ce.FAILED_PRECONDITION||t.code===ce.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code)},t.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new di;var t=ii.buildStoragePrefix(this.databaseInfo),e=new Kn(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new ii(t,e),this.persistence.start()},t.prototype.startMemoryPersistence=function(){return this.garbageCollector=new gr,this.persistence=new li,this.persistence.start()},t.prototype.initializeRest=function(t){var e=this;return this.platform.loadConnection(this.databaseInfo).then(function(n){e.localStore=new si(e.persistence,t,e.garbageCollector);var r=e.platform.newSerializer(e.databaseInfo.databaseId),i=new Ai(e.asyncQueue,n,e.credentials,r),o=function(t){e.syncEngine.applyOnlineStateChange(t),e.eventMgr.applyOnlineStateChange(t)};return e.remoteStore=new Ni(e.localStore,i,e.asyncQueue,o),e.syncEngine=new Nr(e.localStore,e.remoteStore,t),e.remoteStore.syncEngine=e.syncEngine,e.eventMgr=new pr(e.syncEngine),e.localStore.start()}).then(function(){return e.remoteStore.start()})},t.prototype.handleUserChange=function(t){return this.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","User Changed: "+t.uid),this.syncEngine.handleUserChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.remoteStore.disableNetwork()})},t.prototype.shutdown=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.credentials.removeUserChangeListener(),e.remoteStore.shutdown()}).then(function(){return e.persistence.shutdown(t&&t.purgePersistenceWithDataLoss)})},t.prototype.listen=function(t,e,n){var r=this,i=new mr(t,e,n);return this.asyncQueue.enqueue(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.enqueue(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof Se)return t;throw new he(ce.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=ot(),r=new _r(t,n),i=r.computeDocChanges(e);return r.applyChanges(i).snapshot})},t.prototype.write=function(t){var e=this,n=new Qr;return this.asyncQueue.enqueue(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.enqueue(function(){return ie.__awaiter(e,void 0,void 0,function(){return ie.__generator(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Di=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Oi=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Ri=function(){function t(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}return t}(),xi=function(){function t(){this.userListener=null}return t.prototype.getToken=function(t){return Promise.resolve(null)},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,t(Oi.UNAUTHENTICATED)},t.prototype.removeUserChangeListener=function(){c(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},t}(),Li=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var t=e.getUser();e.currentUser&&t.isEqual(e.currentUser)||(e.currentUser=t,e.userCounter++,e.userListener&&e.userListener(e.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(t){var e=this;c(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(t).then(function(t){if(e.userCounter!==n)throw new he(ce.ABORTED,"getToken aborted due to uid change.");return t?(c("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Ri(t.accessToken,e.currentUser)):null})},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeUserChangeListener=function(){c(null!=this.tokenListener,"removeUserChangeListener() called twice"),c(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},t.prototype.getUser=function(){"function"!=typeof this.app.INTERNAL.getUid&&u("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var t=this.app.INTERNAL.getUid();return c(null===t||"string"==typeof t,"Received invalid UID: "+t),new Oi(t)},t}(),Pi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Oi.FIRST_PARTY,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),Mi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(t){return Promise.resolve(new Pi(this.gapi,this.sessionIndex))},t.prototype.setUserChangeListener=function(t){t(Oi.FIRST_PARTY)},t.prototype.removeUserChangeListener=function(){},t}(),Bi=function(){function t(t){this.methodName=t}return t.delete=function(){return Ui.instance},t.serverTimestamp=function(){return Fi.instance},t._arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return b("FieldValue.arrayUnion",arguments,1),new Vi(t)},t._arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return b("FieldValue.arrayRemove",arguments,1),new qi(t)},t.prototype.isEqual=function(t){return this===t},t}(),Ui=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return ie.__extends(e,t),e.instance=new e,e}(Bi),Fi=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return ie.__extends(e,t),e.instance=new e,e}(Bi),Vi=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return ie.__extends(e,t),e}(Bi),qi=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return ie.__extends(e,t),e}(Bi),ji=l(Bi,"Use FieldValue.<field>() instead."),Wi=/^__.*__$/,Ki=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new bn(t,this.data,this.fieldMask,e)):n.push(new vn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new wn(t,this.fieldTransforms)),n},t}(),Hi=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new bn(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new wn(t,this.fieldTransforms)),n},t}();!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument"}(vi||(vi={}));var Gi=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new he(ce.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(Vt(this.dataSource)&&Wi.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),Qi=function(){function t(t,e){this.databaseId=t,this.key=e}return t}(),zi=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new Gi(vi.Set,t,Te.EMPTY_PATH);jt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Ki(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new Gi(vi.MergeSet,t,Te.EMPTY_PATH);jt("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=[],c=0,h=n;c<h.length;c++){var l=h[c],f=void 0;if(l instanceof ir?f=l:"string"==typeof l?f=Kt(t,l):u("Expected stringOrFieldPath to be a string or a FieldPath"),!a.contains(f))throw new he(ce.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");s.push(f)}i=new fn(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=new fn(r.fieldMask),o=r.fieldTransforms;return new Ki(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new Gi(vi.Update,t,Te.EMPTY_PATH);jt("Data must be an object, but it was:",r,e);var i=[],o=Ge.EMPTY;m(e,function(e,a){var s=Kt(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof Ui)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new fn(i);return new Hi(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Gi(vi.Update,t,Te.EMPTY_PATH),o=[Wt(t,e)],a=[n];if(r.length%2!=0)throw new he(ce.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Wt(t,r[s])),a.push(r[s+1]);for(var u=[],c=Ge.EMPTY,s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof Ui)u.push(h);else{var d=this.parseData(f,l);null!=d&&(u.push(h),c=c.set(h,d))}}var p=new fn(u);return new Hi(c,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new Gi(vi.Argument,t,Te.EMPTY_PATH),r=this.parseData(e,n);return c(null!=r,"Parsed data should not be null."),c(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Ht(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(t=this.runPreConverter(t,e),qt(t))return jt("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof Bi)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new _e(F);return m(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new Ge(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Pe.INSTANCE),n.push(s),r++}return new Qe(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Vt(e.dataSource))throw e.createError(t.methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t.methodName+"() is not currently supported inside arrays");if(t instanceof Ui){if(e.dataSource!==vi.MergeSet)throw e.dataSource===vi.Update?(c(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof Fi)e.fieldTransforms.push(new dn(e.path,Un.instance));else if(t instanceof Vi){var n=this.parseArrayTransformElements(t.methodName,t._elements),r=new Fn(n);e.fieldTransforms.push(new dn(e.path,r))}else if(t instanceof qi){var n=this.parseArrayTransformElements(t.methodName,t._elements),i=new Vn(n);e.fieldTransforms.push(new dn(e.path,i))}else u("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Pe.INSTANCE;if("number"==typeof t)return X(t)?new Ue(t):new Fe(t);if("boolean"==typeof t)return Me.of(t);if("string"==typeof t)return new Ve(t);if(t instanceof Date)return new qe(me.fromDate(t));if(t instanceof me)return new qe(new me(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof pe)return new He(t);if(t instanceof fe)return new We(t);if(t instanceof Qi)return new Ke(t.databaseId,t.key);throw e.createError("Unsupported field value: "+R(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new Gi(vi.Argument,t,Te.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}(),Xi="firestore.googleapis.com",Yi=!0,Ji=!1,$i=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new he(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Xi,this.ssl=Yi}else S("settings","string","host",t.host),this.host=t.host,A("settings","boolean","ssl",t.ssl),this.ssl=d(t.ssl,Yi);P("settings",t,["host","ssl","credentials","timestampsInSnapshots"]),A("settings","object","credentials",t.credentials),this.credentials=t.credentials,A("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),this.timestampsInSnapshots=d(t.timestampsInSnapshots,Ji)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials},t}(),Zi=function(){function t(){}return t}(),to=function(){function t(e){var n=this;this._queue=new yi,this.INTERNAL={delete:function(t){return ie.__awaiter(n,void 0,void 0,function(){return ie.__generator(this,function(e){return this._firestoreClient?[2,this._firestoreClient.shutdown(t)]:[2]})})}};var r=new Zi;if("object"===te(e.options)){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Li(i)}else{var o=e;if(!o.projectId)throw new he(ce.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new ve(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new xi}r.settings=new $i({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(v("Firestore.settings",arguments,1),T("Firestore.settings","object",1,t),f(t,"persistence"))throw new he(ce.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new $i(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new he(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=Bt(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(){if(this._firestoreClient)throw new he(ce.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(!1),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;c(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),this._config.settings.timestampsInSnapshots||a("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),c(!this._firestoreClient,"configureClient() called multiple times");var n=new ye(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl),r=function(t){if(t instanceof ro){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new he(ce.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Qi(e._config.databaseId,t._key)}return t};return this._dataConverter=new zi(r),this._firestoreClient=new Ci(ue.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!f(e,"projectId")){if(f(e,"firestoreId"))throw new he(ce.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new he(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(f(e,"firestoreOptions"))throw new he(ce.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=e.projectId;if(!n||"string"!=typeof n)throw new he(ce.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ve(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new he(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("Firestore.collection",arguments,1),T("Firestore.collection","string",1,t),!t)throw new he(ce.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new co(we.fromString(t),this)},t.prototype.doc=function(t){if(v("Firestore.doc",arguments,1),T("Firestore.doc","string",1,t),!t)throw new he(ce.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),ro.forPath(we.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return v("Firestore.runTransaction",arguments,1),T("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new eo(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new no(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(r()){case ee.DEBUG:return"debug";case ee.ERROR:return"error";case ee.SILENT:return"silent";default:return u("Unknown log level: "+r())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(v("Firestore.setLogLevel",arguments,1),T("Firestore.setLogLevel","string",1,t),t){case"debug":i(ee.DEBUG);break;case"error":i(ee.ERROR);break;case"silent":i(ee.SILENT);break;default:throw new he(ce.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),eo=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;v("Transaction.get",arguments,1);var n=Xt("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return u("Mismatch in docs returned from document lookup.");var r=t[0];return r instanceof Ae?new oo(e._firestore,n._key,null,!1):new oo(e._firestore,n._key,r,!1)})},t.prototype.set=function(t,e,n){w("Transaction.set",arguments,2,3);var r=Xt("Transaction.set",t,this._firestore);n=Qt("Transaction.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"==typeof e||e instanceof ir?(b("Transaction.update",arguments,3),o=Xt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,r)):(v("Transaction.update",arguments,2),o=Xt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(o._key,a),this},t.prototype.delete=function(t){v("Transaction.delete",arguments,1);var e=Xt("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),no=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){w("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Xt("WriteBatch.set",t,this._firestore);n=Qt("WriteBatch.set",n);var i=n.merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,yn.NONE)),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.verifyNotCommitted();var o,a;return"string"==typeof e||e instanceof ir?(b("WriteBatch.update",arguments,3),o=Xt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,r)):(v("WriteBatch.update",arguments,2),o=Xt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(a.toMutations(o._key,yn.exists(!0))),this},t.prototype.delete=function(t){v("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Xt("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new En(e._key,yn.NONE)),this},t.prototype.commit=function(){return ie.__awaiter(this,void 0,void 0,function(){return ie.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new he(ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),ro=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new he(ce.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new Ie(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new co(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(v("DocumentReference.collection",arguments,1),T("DocumentReference.collection","string",1,t),!t)throw new he(ce.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=we.fromString(t);return new co(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){w("DocumentReference.set",arguments,1,2),e=Qt("DocumentReference.set",e);var n=e.merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,yn.NONE))},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"==typeof t||t instanceof ir?(b("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,n)):(v("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(i.toMutations(this._key,yn.exists(!0)))},t.prototype.delete=function(){return v("DocumentReference.delete",arguments,0),this._firestoreClient.write([new En(this._key,yn.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];w("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!==te(t[i])||Ut(t[i])||(r=t[i],P("DocumentReference.onSnapshot",r,["includeMetadataChanges"]),A("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return Ut(t[i])?n=t[i]:(T("DocumentReference.onSnapshot","function",i,t[i]),I("DocumentReference.onSnapshot","function",i+1,t[i+1]),I("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Di({next:function(t){if(e.next){c(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new oo(n.firestore,n._key,r,t.fromCache))}},error:r}),o=this._firestoreClient.listen($e.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return P("DocumentReference.get",t,["source"]),t&&C("DocumentReference.get","options","source",t.source,["default","server","cache"]),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new oo(e.firestore,e._key,t,!0))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new he(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new he(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),io=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),oo=function(){function t(t,e,n,r){this._firestore=t,this._key=e,this._document=n,this._fromCache=r}return t.prototype.data=function(t){return w("DocumentSnapshot.data",arguments,0,1),t=zt("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,xe.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(w("DocumentSnapshot.get",arguments,1,2),e=zt("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Wt("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,xe.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ro(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new io(null!==this._document&&this._document.hasLocalMutations,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof Ge)return this.convertObject(t,e);if(t instanceof Qe)return this.convertArray(t,e);if(t instanceof Ke){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||a("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new ro(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),ao=function(t){function e(e,n,r,i){return t.call(this,e,n,r,i)||this}return ie.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return c("object"===(void 0===n?"undefined":te(n)),"Document in a QueryDocumentSnapshot should exist"),n},e}(oo),so=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){v("Query.where",arguments,3),T("Query.where","string",2,n),L("Query.where",3,r);var i,o=Wt("Query.where",e),a=Ze.fromString(n);if(o.isKeyField()){if(a===Ze.ARRAY_CONTAINS)throw new he(ce.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"==typeof r){if(-1!==r.indexOf("/"))throw new he(ce.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new he(ce.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var s=this._query.path.child(new we([r]));c(s.length%2==0,"Path should be a document key"),i=new Ke(this.firestore._databaseId,new Ie(s))}else{if(!(r instanceof ro))throw new he(ce.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+R(r)+".");var u=r;i=new Ke(this.firestore._databaseId,u._key)}}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var h=Y(o,a,i);return this.validateNewFilter(h),new t(this._query.addFilter(h),this.firestore)},t.prototype.orderBy=function(e,n){w("Query.orderBy",arguments,1,2),I("Query.orderBy","string",2,n);var r;if(void 0===n||"asc"===n)r=rn.ASCENDING;else{if("desc"!==n)throw new he(ce.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=rn.DESCENDING}if(null!==this._query.startAt)throw new he(ce.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new he(ce.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Wt("Query.orderBy",e),o=new an(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(v("Query.limit",arguments,1),T("Query.limit","number",1,e),e<=0)throw new he(ce.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];b("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(L(t,1,e),e instanceof oo){if(n.length>0)throw new he(ce.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new he(ce.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Ke(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new he(ce.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new on(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new he(ce.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new he(ce.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+(void 0===a?"undefined":te(a)));if(-1!==a.indexOf("/"))throw new he(ce.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new Ie(this._query.path.child(a));i.push(new Ke(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new on(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];w("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!==te(t[i])||Ut(t[i])||(r=t[i],P("Query.onSnapshot",r,["includeMetadataChanges"]),A("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),Ut(t[i])?n=t[i]:(T("Query.onSnapshot","function",i,t[i]),I("Query.onSnapshot","function",i+1,t[i+1]),I("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Di({next:function(t){e.next&&e.next(new uo(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return w("Query.get",arguments,0,1),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new uo(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new he(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof tn)if(t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new he(ce.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}else if(t.op===Ze.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new he(ce.INVALID_ARGUMENT,"Invalid query. Queries only support a single array-contains filter.")},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new he(ce.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),uo=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new io(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;w("QuerySnapshot.forEach",arguments,1,2),T("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new so(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){P("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),t&&A("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges);var e=t&&t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new he(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=Yt(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw M("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new ao(this._firestore,t.key,t,this.metadata.fromCache)},t}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(uo.prototype.docChanges,t,{get:function(){return Gt()}})}catch(t){}});var co=function(t){function e(e,n){var r=t.call(this,$e.atPath(e),n)||this;if(e.length%2!=1)throw new he(ce.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return ie.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new ro(new Ie(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(w("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=le.newId()),T("CollectionReference.doc","string",1,t),""===t)throw new he(ce.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=we.fromString(t);return ro.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){v("CollectionReference.add",arguments,1),T("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(so),ho=l(to,"Use firebase.firestore() instead."),lo=l(eo,"Use firebase.firestore().runTransaction() instead."),fo=l(no,"Use firebase.firestore().batch() instead."),po=l(ro,"Use firebase.firestore().doc() instead."),mo=l(oo),yo=l(ao),go=l(so),vo=l(uo),bo=l(co,"Use firebase.firestore().collection() instead."),wo={Firestore:ho,GeoPoint:pe,Timestamp:me,Blob:de,Transaction:lo,WriteBatch:fo,DocumentReference:po,DocumentSnapshot:mo,Query:go,QueryDocumentSnapshot:yo,QuerySnapshot:vo,CollectionReference:bo,FieldPath:ir,FieldValue:ji,setLogLevel:to.setLogLevel};Zt(ne),e.registerFirestore=Zt}).call(e,n(3))},function(t,e,n){"use strict";function r(t){o.forEach(function(e){e.logLevel=t})}Object.defineProperty(e,"__esModule",{value:!0});var i,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(e.LogLevel=i={}));var a=i.INFO,s=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},u=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.ERROR].concat(t))},t}();e.setLogLevel=r,e.Logger=u,e.LogLevel=i},function(module,exports,__webpack_require__){"use strict";(function(global){var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){function l(t){return"string"==typeof t}function n(t,e){t=t.split("."),e=e||k;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function aa(){}function ba(t){var e=void 0===t?"undefined":_typeof(t);if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function p(t){return"array"==ba(t)}function ca(t){var e=ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==ba(t)}function ea(t){var e=void 0===t?"undefined":_typeof(t);return"object"==e&&null!=t||"function"==e}function ha(t,e,n){return t.call.apply(t.bind,arguments)}function ia(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function r(t,e,n){return r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia,r.apply(null,arguments)}function ja(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.H=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Ib=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ka(t){if(Error.captureStackTrace)Error.captureStackTrace(this,ka);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function la(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");ka.call(this,n+t[r])}function ma(t,e){throw new la("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(){0!=na&&(pa[this[q]||(this[q]=++fa)]=this),this.i=this.i,this.m=this.m}function sa(t){t:{for(var e=ta,n=t.length,r=l(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:l(t)?t.charAt(e):t[e]}function ua(t){if(!p(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function va(t){return Array.prototype.concat.apply([],arguments)}function wa(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function xa(t){return/^[\s\xa0]*$/.test(t)}function za(t,e){return t<e?-1:t>e?1:0}function y(t){return-1!=x.indexOf(t)}function Ca(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Da(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Ea(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Fa(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ha(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<Ga.length;o++)n=Ga[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ia(t){return Ia[" "](t),t}function Ja(t,e){var n=Ka;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function Qa(){var t=k.document;return t?t.documentMode:void 0}function Va(t){return Ja(t,function(){for(var e=0,n=ya(String(Ra)).split("."),r=ya(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=za(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||za(0==a[2].length,0==s[2].length)||za(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function A(t,e){this.type=t,this.a=this.target=e,this.Ra=!0}function bb(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Oa){t:{try{Ia(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=l(t.pointerType)?t.pointerType:cb[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}function fb(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ga=i,this.key=++eb,this.Z=this.ba=!1}function gb(t){t.Z=!0,t.listener=null,t.proxy=null,t.src=null,t.ga=null}function hb(t){this.src=t,this.a={},this.b=0}function jb(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=qa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gb(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ib(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Z&&o.listener==e&&o.capture==!!n&&o.ga==r)return i}return-1}function nb(t,e,n,r,i){if(r&&r.once)return ob(t,e,n,r,i);if(p(e)){for(var o=0;o<e.length;o++)nb(t,e[o],n,r,i);return null}return n=pb(n),t&&t[db]?t.Ia(e,n,ea(r)?!!r.capture:!!r,i):qb(t,e,n,!1,r,i)}function qb(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=ea(i)?!!i.capture:!!i,s=rb(t);if(s||(t[kb]=s=new hb(t)),n=s.add(e,n,r,a,o),n.proxy)return n;if(r=sb(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ab||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(tb(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return mb++,n}function sb(){var t=ub,e=Za?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function ob(t,e,n,r,i){if(p(e)){for(var o=0;o<e.length;o++)ob(t,e[o],n,r,i);return null}return n=pb(n),t&&t[db]?t.Ja(e,n,ea(r)?!!r.capture:!!r,i):qb(t,e,n,!0,r,i)}function vb(t,e,n,r,i){if(p(e))for(var o=0;o<e.length;o++)vb(t,e[o],n,r,i);else r=ea(r)?!!r.capture:!!r,n=pb(n),t&&t[db]?(t=t.f,(e=String(e).toString())in t.a&&(o=t.a[e],-1<(n=ib(o,n,r,i))&&(gb(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=rb(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ib(e,n,r,i)),(n=-1<t?e[t]:null)&&wb(n))}function wb(t){if("number"!=typeof t&&t&&!t.Z){var e=t.src;if(e&&e[db])jb(e.f,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(tb(n),r):e.addListener&&e.removeListener&&e.removeListener(r),mb--,(n=rb(e))?(jb(n,t),0==n.b&&(n.src=null,e[kb]=null)):gb(t)}}}function tb(t){return t in lb?lb[t]:lb[t]="on"+t}function xb(t,e,n,r){var i=!0;if((t=rb(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Z&&(o=yb(o,r),i=i&&!1!==o)}return i}function yb(t,e){var n=t.listener,r=t.ga||t.src;return t.ba&&wb(t),n.call(r,e)}function ub(t,e){if(t.Z)return!0;if(!Za){var r=e||n("window.event");e=new bb(r,this);var i=!0;if(!(0>r.keyCode||void 0!=r.returnValue)){t:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){o=!0}(o||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=e.a;o;o=o.parentNode)r.push(o);for(t=t.type,o=r.length-1;0<=o;o--){e.a=r[o];var a=xb(r[o],t,!0,e);i=i&&a}for(o=0;o<r.length;o++)e.a=r[o],a=xb(r[o],t,!1,e),i=i&&a}return i}return yb(t,new bb(e,this))}function rb(t){return t=t[kb],t instanceof hb?t:null}function pb(t){return da(t)?t:(t[zb]||(t[zb]=function(e){return t.handleEvent(e)}),t[zb])}function B(){w.call(this),this.f=new hb(this),this.N=this,this.J=null}function Ab(t,e,n,r){if(!(e=t.f.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Z&&a.capture==n){var s=a.listener,u=a.ga||a.src;a.ba&&jb(t.f,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ra}function Bb(t){return!/^\s*$/.test(t)&&/^[\],:{}\s\u2028\u2029]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Cb(a){if(a=String(a),Bb(a))try{return eval("("+a+")")}catch(t){}throw Error("Invalid JSON string: "+a)}function Db(t){var e=[];return Eb(new Fb,t,e),e.join("")}function Fb(){}function Eb(t,e,n){if(null==e)n.push("null");else{if("object"==(void 0===e?"undefined":_typeof(e))){if(p(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),Eb(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),i="";for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),Gb(r,n),n.push(":"),Eb(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(void 0===e?"undefined":_typeof(e)){case"string":Gb(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+(void 0===e?"undefined":_typeof(e)))}}}function Gb(t,e){e.push('"',t.replace(Ib,function(t){var e=Hb[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Hb[t]=e),e}),'"')}function Jb(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kb(){this.b=this.a=null}function Ob(){var t=Pb,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lb(){this.next=this.b=this.a=null}function Qb(t){k.setTimeout(function(){throw t},0)}function Sb(){var t=k.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=r(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!y("Trident")&&!y("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.za;n.za=null,t()}},function(t){i.next={za:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){k.setTimeout(t,0)}}function Ub(){if(-1!=String(k.Promise).indexOf("[native code]")){var t=k.Promise.resolve(void 0);Tb=function(){t.then(Vb)}}else Tb=function(){var t=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(t)):k.setImmediate(t)}}function Vb(){for(var t;t=Ob();){try{t.a.call(t.b)}catch(t){Qb(t)}var e=Nb;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.c=r(this.qb,this),this.g=t()}function Yb(t){t.ea=!1,t.O&&(t.a.clearTimeout(t.O),t.O=null)}function Zb(t,e,n){if(da(t))n&&(t=r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=r(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}function $b(t,e,n){w.call(this),this.f=null!=n?r(t,n):t,this.c=e,this.b=r(this.kb,this),this.a=[]}function ac(t){t.Y=Zb(t.b,t.c),t.f.apply(null,t.a)}function bc(t){w.call(this),this.b=t,this.a={}}function dc(t,e,n,r){p(n)||(n&&(cc[0]=n.toString()),n=cc);for(var i=0;i<n.length;i++){var o=nb(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ec(t){Ca(t.a,function(t,e){this.a.hasOwnProperty(e)&&wb(t)},t),t.a={}}function fc(t,e,n){this.reset(t,e,n,void 0,void 0)}function hc(t){this.f=t,this.b=this.c=this.a=null}function C(t,e){this.name=t,this.value=e}function nc(t){return t.c?t.c:t.a?nc(t.a):(ma("Root logger has no level set."),null)}function qc(t){pc||(pc=new hc(""),oc[""]=pc,pc.c=lc);var e;if(!(e=oc[t])){e=new hc(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=qc(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,oc[t]=e}return e}function D(t,e){t&&t.log(jc,e,void 0)}function rc(t,e){t&&t.log(kc,e,void 0)}function E(t,e){t&&t.log(mc,e,void 0)}function sc(){this.a=qc("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function tc(t,e,n,r,i,o){F(t,function(){if(t.b)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");a=2<=l.length&&"type"==l[1]?a+(h+"=")+c+"&":a+(h+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a})}function uc(t,e,n,r,i,o,a){F(t,function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a})}function G(t,e,n,r){F(t,function(){return"XMLHTTP TEXT ("+e+"): "+vc(t,n)+(r?" "+r:"")})}function wc(t,e){F(t,function(){return"TIMEOUT: "+e})}function H(t,e){E(t.a,e)}function xc(t,e,n){(t=t.a)&&t.log(ic,n||"Exception",e)}function F(t,e){rc(t.a,e)}function J(t,e){(t=t.a)&&t.log(ic,e,void 0)}function vc(t,e){if(!t.b)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(var r=0;r<n.length;r++)if(p(n[r])){var i=n[r];if(!(2>i.length)){var o=i[1];if(p(o)&&!(1>o.length)){var a=o[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<o.length;s++)o[s]=""}}}return Db(n)}catch(n){return H(t,"Exception parsing expected JS array - probably was not JS"),e}}function zc(t){A.call(this,"serverreachability",t)}function Ac(t){yc.dispatchEvent(new zc(yc,t))}function Bc(t){A.call(this,"statevent",t)}function K(t){yc.dispatchEvent(new Bc(yc,t))}function Cc(t){A.call(this,"timingevent",t)}function Dc(t,e,n){yc.dispatchEvent(new Cc(yc,t,e,n))}function Ec(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}function Hc(){}function Ic(t){var e;return(e=t.a)||(e={},Jc(t)&&(e[0]=!0,e[1]=!0),e=t.a=e),e}function Kc(){}function Mc(){A.call(this,"d")}function Nc(){A.call(this,"c")}function Pc(){}function Qc(t){return(t=Jc(t))?new ActiveXObject(t):new XMLHttpRequest}function Jc(t){if(!t.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.b=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.b}function L(t,e,n,r){this.i=t,this.b=e,this.c=n,this.T=r||1,this.L=new bc(this),this.R=Rc,t=Na?125:void 0,this.S=new Xb(t),this.j=null,this.f=!1,this.l=this.g=this.h=this.J=this.D=this.U=this.s=null,this.u=[],this.a=null,this.G=0,this.m=this.o=null,this.C=-1,this.B=!1,this.N=0,this.I=null,this.v=this.X=this.K=!1}function Sc(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Vc(t,e,n){t.J=1,t.h=Wc(M(e)),t.l=n,t.K=!0,Xc(t,null)}function Yc(t,e,n,r){t.J=1,t.h=Wc(M(e)),t.l=null,t.K=n,Xc(t,r)}function Xc(e,n){e.D=t(),Zc(e),e.g=M(e.h),$c(e.g,"t",e.T),e.G=0,e.a=e.i.ca(e.i.ia()?n:null),0<e.N&&(e.I=new $b(r(e.Sa,e,e.a),e.N)),dc(e.L,e.a,"readystatechange",e.nb),n=e.j?Fa(e.j):{},e.l?(e.o||(e.o="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.fa(e.g,e.o,e.l,n)):(e.o="GET",e.a.fa(e.g,e.o,null,n)),Ac(1),tc(e.b,e.o,e.g,e.c,e.T,e.l)}function ad(t){var e=N(t.a),n=t.a.Ga(),r=t.a.W();if(!(3>e||3==e&&!Na&&!t.a.V())){t.B||4!=e||7==n||Ac(8==n||0>=r?3:2),bd(t);var i=t.a.W();t.C=i,(n=t.a.V())||H(t.b,function(){return"No response text for uri "+t.g+" status "+i}),t.f=200==i,uc(t.b,t.o,t.g,t.c,t.T,e,i),t.f?((r=cd(t))&&(G(t.b,t.c,r,"Initial handshake response via X-HTTP-Initial-Response"),t.v=!0,dd(t,r)),t.K?(ed(t,e,n),Na&&t.f&&3==e&&fd(t)):(G(t.b,t.c,n,null),dd(t,n)),4==e&&gd(t),t.f&&!t.B&&(4==e?t.i.ta(t):(t.f=!1,Zc(t)))):(400==i&&0<n.indexOf("Unknown SID")?(t.m=3,K(12),D(t.b.a,"XMLHTTP Unknown SID ("+t.c+")")):(t.m=0,K(13),D(t.b.a,"XMLHTTP Bad status "+i+" ("+t.c+")")),gd(t),hd(t))}}function cd(t){return!t.X||t.v?null:t.a&&(t=id(t.a,"X-HTTP-Initial-Response"))&&!xa(t)?t:null}function ed(t,e,n){for(var r=!0;!t.B&&t.G<n.length;){var i=jd(t,n);if(i==Uc){4==e&&(t.m=4,K(14),r=!1),G(t.b,t.c,null,"[Incomplete Response]");break}if(i==Tc){t.m=4,K(15),G(t.b,t.c,n,"[Invalid Chunk]"),r=!1;break}G(t.b,t.c,i,null),dd(t,i)}4==e&&0==n.length&&(t.m=1,K(16),r=!1),t.f=t.f&&r,r||(G(t.b,t.c,n,"[Invalid Chunked Response]"),gd(t),hd(t))}function fd(t){dc(t.L,t.S,"tick",t.mb),t.S.start()}function jd(t,e){var n=t.G,r=e.indexOf("\n",n);return-1==r?Uc:(n=Number(e.substring(n,r)),isNaN(n)?Tc:(r+=1)+n>e.length?Uc:(e=e.substr(r,n),t.G=r+n,e))}function Zc(e){e.U=t()+e.R,kd(e,e.R)}function kd(t,e){if(null!=t.s)throw Error("WatchDog timer not null");t.s=Ec(r(t.lb,t),e)}function bd(t){t.s&&(k.clearTimeout(t.s),t.s=null)}function hd(t){t.i.La()||t.B||t.i.ta(t)}function gd(t){bd(t);var e=t.I;e&&"function"==typeof e.$&&e.$(),t.I=null,Yb(t.S),ec(t.L),t.a&&(e=t.a,t.a=null,e.abort(),e.$())}function dd(t,e){try{t.i.Oa(t,e),Ac(4)}catch(e){xc(t.b,e,"Error in httprequest callback")}}function ld(t){if(t.A&&"function"==typeof t.A)return t.A();if(l(t))return t.split("");if(ca(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Da(t)}function md(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ca(t)||l(t))ra(t,e,void 0);else{if(t.M&&"function"==typeof t.M)var n=t.M();else if(t.A&&"function"==typeof t.A)n=void 0;else if(ca(t)||l(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else n=Ea(t);r=ld(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function O(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof O)for(n=t.M(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function od(t){t.b={},t.a.length=0,t.c=0}function pd(t,e){return!!P(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&nd(t),!0)}function nd(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];P(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],P(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function rd(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Q(t,e){this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1;var n;t instanceof Q?(this.h=void 0!==e?e:t.h,sd(this,t.f),this.j=t.j,td(this,t.b),ud(this,t.i),this.a=t.a,vd(this,wd(t.c)),this.g=t.g):t&&(n=String(t).match(qd))?(this.h=!!e,sd(this,n[1]||"",!0),this.j=xd(n[2]||""),td(this,n[3]||"",!0),ud(this,n[4]),this.a=xd(n[5]||"",!0),vd(this,n[6]||"",!0),this.g=xd(n[7]||"")):(this.h=!!e,this.c=new yd(null,this.h))}function M(t){return new Q(t)}function sd(t,e,n){t.f=n?xd(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function td(t,e,n){t.b=n?xd(e,!0):e}function ud(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function vd(t,e,n){e instanceof yd?(t.c=e,Ed(t.c,t.h)):(n||(e=zd(e,Fd)),t.c=new yd(e,t.h))}function R(t,e,n){t.c.set(e,n)}function $c(t,e,n){p(n)||(n=[String(n)]),Gd(t.c,e,n)}function Wc(e){return R(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function Hd(t){return t instanceof Q?M(t):new Q(t,void 0)}function Id(t,e,n,r){var i=new Q(null,void 0);return t&&sd(i,t),e&&td(i,e),n&&ud(i,n),r&&(i.a=r),i}function xd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function zd(t,e,n){return l(t)?(t=encodeURI(t).replace(e,Jd),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Jd(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function yd(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function S(t){t.a||(t.a=new O,t.b=0,t.c&&rd(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Ld(t,e){S(t),e=Kd(t,e),P(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,pd(t.a,e))}function Md(t,e){return S(t),e=Kd(t,e),P(t.a.b,e)}function Gd(t,e,n){Ld(t,e),0<n.length&&(t.c=null,t.a.set(Kd(t,e),wa(n)),t.b+=n.length)}function wd(t){var e=new yd;return e.c=t.c,t.a&&(e.a=new O(t.a),e.b=t.b),e}function Kd(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Ed(t,e){e&&!t.f&&(S(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Ld(this,e),Gd(this,n,t))},t)),t.f=e}function Nd(){this.a=t()}function Pd(){Od||(Od=new Nd)}function Qd(){Od||(Od=new Nd)}function Rd(t,e){this.a=t,this.b=e,this.c=this.i=null,this.h=!1,this.m=null,this.f=-1,this.l=this.g=null}function Sd(t){H(t.b,"TestConnection: starting stage 2");var e=t.a.I.a;if(null!=e)H(t.b,function(){return"Buffered"}),K(4),e?(K(10),Td(t.a,t,!1)):(K(11),Td(t.a,t,!0));else{t.c=new L(t,t.b,void 0,void 0),t.c.j=t.i;var n=Ud(t.a,t.g,t.m);K(4),$c(n,"TYPE","xmlhttp");var r=t.a.j,i=t.a.K;r&&i&&R(n,r,i),Yc(t.c,n,!1,t.g)}}function Wd(){this.a=this.b=null}function Xd(){this.a=new O}function Yd(t){var e=void 0===t?"undefined":_typeof(t);return"object"==e&&t||"function"==e?"o"+(t[q]||(t[q]=++fa)):e.charAt(0)+t}function Zd(t,e){this.a=t,this.b=e}function $d(t){this.g=t||ae,k.PerformanceNavigationTiming?(t=k.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(k.oa&&k.oa.Ma&&k.oa.Ma()&&k.oa.Ma().Jb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Xd),this.b=null,this.c=[]}function be(t,e){t.a||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(t.f=t.g,t.a=new Xd,t.b&&(ce(t,t.b),t.b=null))}function de(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function ee(t,e){return t.b?t=t.b==e:t.a?(e=Yd(e),t=P(t.a.a.b,e)):t=!1,t}function ce(t,e){t.a?t.a.add(e):t.b=e}function fe(t,e){if(t.b&&t.b==e)t.b=null;else{var n;(n=t.a)&&(n=Yd(e),n=P(t.a.a.b,n)),n&&pd(t.a.a,Yd(e))}}function ge(t){if(null!=t.b)return t.c.concat(t.b.u);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return ra(t.a.A(),function(t){e=e.concat(t.u)}),e}return wa(t.c)}function he(t,e){t.c=t.c.concat(e)}function ie(){}function je(){this.a=new ie}function ke(t,e,n){var r=n||"";try{md(t,function(t,n){var i=t;ea(t)&&(i=Db(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function le(t,e){var n=new sc;H(n,"TestLoadImage: loading "+t);var r=new Image;r.onload=ja(me,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ja(me,n,r,"TestLoadImage: error",!1,e),r.onabort=ja(me,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ja(me,n,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function me(t,e,n,r,i){try{H(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){xc(t,e)}}function T(t){B.call(this),this.headers=new O,this.s=t||null,this.c=!1,this.D=this.a=null,this.K=this.B="",this.j=0,this.g="",this.h=this.I=this.u=this.G=!1,this.l=0,this.C=null,this.L=ne,this.v=this.o=!1}function se(t){return z&&Va(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function ta(t){return"content-type"==t.toLowerCase()}function qe(t,e){t.c=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.j=5,te(t),ue(t)}function te(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ve(t){if(t.c&&void 0!==goog)if(t.D[1]&&4==N(t)&&2==t.W())E(t.b,U(t,"Local request error detected and ignored"));else if(t.u&&4==N(t))Zb(t.Na,0,t);else if(t.dispatchEvent("readystatechange"),4==N(t)){E(t.b,U(t,"Request complete")),t.c=!1;try{var e=t.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.B).match(qd)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!oe.test(o?o.toLowerCase():"")}r=i}r?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.j=6,t.g=t.Ha()+" ["+t.W()+"]",te(t))}finally{ue(t)}}}function ue(t,e){if(t.a){re(t);var n=t.a,r=t.D[0]?aa:null;t.a=null,t.D=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ic,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function re(t){t.a&&t.v&&(t.a.ontimeout=null),t.C&&(k.clearTimeout(t.C),t.C=null)}function N(t){return t.a?t.a.readyState:0}function id(t,e){return t.a?t.a.getResponseHeader(e):null}function U(t,e){return e+" ["+t.K+" "+t.B+" "+t.W()+"]"}function we(t){var e="";return Ca(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function xe(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=we(n),l(t)){if(e=encodeURIComponent(String(e)),n=null!=n?"="+encodeURIComponent(String(n)):"",e+=n){if(n=t.indexOf("#"),0>n&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)],n=t[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return R(t,e,n),t}function ye(t){this.ya=0,this.g=[],this.a=new sc,this.I=new Wd,this.X=this.ua=this.D=this.ja=this.b=this.K=this.j=this.U=this.h=this.L=this.i=null,this.Za=this.R=0,this.Xa=!!n("internalChannelParams.failFast",t),this.ka=this.C=this.s=this.l=this.m=this.f=null,this.u=this.xa=this.N=-1,this.T=this.B=this.v=0,this.Wa=n("internalChannelParams.baseRetryDelayMs",t)||5e3,this.$a=n("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Ya=n("internalChannelParams.forwardChannelMaxRetries",t)||2,this.wa=n("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ta=t&&t.Kb||void 0,this.G=void 0,this.S=t&&t.supportsCrossDomainXhr||!1,this.J="",this.c=new $d(t&&t.concurrentRequestLimit),this.la=new je,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.va=t&&t.fastHandshake||!1)&&!this.o&&(D(this.a.a,"Force backgroundChannelTest when fastHandshake is enabled."),this.o=!0),t&&t.Fa&&this.a.Fa()}function ze(e){if(H(e.a,"disconnect()"),Ae(e),3==e.F){var n=e.R++,r=M(e.D);R(r,"SID",e.J),R(r,"RID",n),R(r,"TYPE","terminate"),Be(e,r),n=new L(e,e.a,n,void 0),n.J=2,n.h=Wc(M(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(n.h.toString(),"")),!r&&k.Image&&((new Image).src=n.h,r=!0),r||(n.a=n.i.ca(null),n.a.fa(n.h)),n.D=t(),Zc(n)}Ce(e)}function Ae(t){t.C&&(t.C.abort(),t.C=null),t.b&&(t.b.cancel(),t.b=null),t.l&&(k.clearTimeout(t.l),t.l=null),De(t),t.c.cancel(),t.m&&(k.clearTimeout(t.m),t.m=null)}function Ee(t,e){1e3==t.g.length&&J(t.a,function(){return"Already have 1000 queued maps upon queueing "+Db(e)}),t.g.push(new Zd(t.Za++,e)),3==t.F&&Fe(t)}function Fe(t){de(t.c)||t.m||(t.m=Ec(r(t.Qa,t),0),t.v=0)}function Ge(t,e){var n=t.c;return(n.b?1:n.a?n.a.a.c:0)>=t.c.f-(t.m?1:0)?(J(t.a,"Unexpected retry request is scheduled."),!1):t.m?(H(t.a,"Use the retry request that is already scheduled."),t.g=e.u.concat(t.g),!0):!(1==t.F||2==t.F||t.v>=(t.Xa?0:t.Ya))&&(H(t.a,"Going to retry POST"),t.m=Ec(r(t.Qa,t,e),He(t,t.v)),t.v++,!0)}function Je(t,e){var n;n=e?e.c:t.R++;var r=M(t.D);R(r,"SID",t.J),R(r,"RID",n),R(r,"AID",t.N),Be(t,r),t.h&&t.i&&xe(r,t.h,t.i),n=new L(t,t.a,n,t.v+1),null===t.h&&(n.j=t.i),e&&(t.g=e.u.concat(t.g)),e=Ie(t,n),n.setTimeout(Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random())),ce(t.c,n),Vc(n,r,e)}function Be(t,e){t.f&&md({},function(t,n){R(e,n,t)})}function Ie(t,e){var n=Math.min(t.g.length,1e3),i=t.f?r(t.f.ab,t.f,t):null;t:for(var o=t.g,a=-1;;){var s=["count="+n];-1==a?0<n?(a=o[0].a,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var u=!0,c=0;c<n;c++){var h=o[c].a,l=o[c].b;if(0>(h-=a))a=Math.max(0,o[c].a-100),u=!1;else try{ke(l,s,"req"+h+"_")}catch(t){i&&i(l)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.u=t,i}function Ke(t){if(!t.b&&!t.l){t.T=1;var e=t.Pa;Tb||Ub(),Wb||(Tb(),Wb=!0),Pb.add(e,t),t.B=0}}function Le(t){return t.b||t.l?(J(t.a,"Request already in progress"),!1):!(3<=t.B)&&(H(t.a,"Going to retry GET"),t.T++,t.l=Ec(r(t.Pa,t),He(t,t.B)),t.B++,!0)}function Td(t,e,n){H(t.a,"Test Connection Finished");var r=e.l;r&&be(t.c,r),t.ka=n,t.u=e.f,H(t.a,"connectChannel_()"),t.D=Me(t,t.ja),Fe(t)}function Vd(t,e){H(t.a,"Test Connection Failed"),t.u=e.f,V(t,2)}function De(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function He(t,e){var n=t.Wa+Math.floor(Math.random()*t.$a);return t.qa()||(H(t.a,"Inactive channel"),n*=2),n*e}function V(t,e){if(F(t.a,"Error code "+e),2==e){var n=null;t.f&&(n=null);var i=r(t.pb,t);n||(n=new Q("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||sd(n,"https"),Wc(n)),le(n.toString(),i)}else K(2);H(t.a,"HttpChannel: error - "+e),t.F=0,t.f&&t.f.Ba(e),Ce(t),Ae(t)}function Ce(t){if(t.F=0,t.u=-1,t.f){var e=ge(t.c);0==e.length&&0==t.g.length||(H(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.g.length}),t.c.c.length=0,wa(t.g),t.g.length=0),t.f.Aa()}}function Me(t,e){return e=Ne(t,null,e),H(t.a,"GetForwardChannelUri: "+e),e}function Ud(t,e,n){return e=Ne(t,t.ia()?e:null,n),H(t.a,"GetBackChannelUri: "+e),e}function Ne(t,e,n){var r=Hd(n);if(""!=r.b)e&&td(r,e+"."+r.b),ud(r,r.i);else{var i,o=k.location;i=e?e+"."+o.hostname:o.hostname,r=Id(o.protocol,i,o.port,n)}return t.U&&Ca(t.U,function(t,e){R(r,e,t)}),e=t.j,n=t.K,e&&n&&R(r,e,n),R(r,"VER",t.na),Be(t,r),r}function Oe(){}function Pe(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else{var i;(i=""==e)||(i=e.length-1,i=0<=i&&e.indexOf("/",i)==i),e+=i?r:"/"+r}}return e}function Qe(){if(z&&!(10<=Number(Wa)))throw Error("Environmental error: no available transport.")}function W(t,e){B.call(this),this.a=new ye(e),this.b=t,this.o=e&&e.testUrl?e.testUrl:Pe(this.b,"test"),this.c=qc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ea&&(t?t["X-WebChannel-Client-Profile"]=e.Ea:t={"X-WebChannel-Client-Profile":e.Ea}),this.a.L=t,(t=e&&e.httpHeadersOverwriteParam)&&!xa(t)&&(this.a.h=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.j=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!xa(e)&&(this.a.j=e,null!==(t=this.g)&&e in t&&(t=this.g,e in t&&delete t[e],D(this.c,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new Re(this)}function Se(t){Mc.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Te(){Nc.call(this),this.status=1}function Re(t){this.a=t}function Ve(){this.b=[],this.a=[]}function We(t){return 0==t.b.length&&(t.b=t.a,t.b.reverse(),t.a=[]),t.b.pop()}function Xe(t){return t.b.length+t.a.length}function Ye(t,e){if(w.call(this),this.h=t||0,this.c=e||10,this.h>this.c)throw Error(Ze);this.a=new Ve,this.b=new Xd,this.g=null,this.aa()}function af(t){if("function"==typeof t.$)t.$();else for(var e in t)t[e]=null}function $e(t){return Xe(t.a)+t.b.a.c}function bf(t,e){this.a=t,this.b=e}function cf(t){if(this.a=[],t)t:{if(t instanceof cf){var e=t.M();if(t=t.A(),0>=this.a.length){for(var n=this.a,r=0;r<e.length;r++)n.push(new bf(e[r],t[r]));break t}}else e=Ea(t),t=Da(t);for(r=0;r<e.length;r++)df(this,e[r],t[r])}}function df(t,e,n){var r=t.a;for(r.push(new bf(e,n)),e=r.length-1,t=t.a,n=t[e];0<e&&(r=e-1>>1,t[r].a>n.a);)t[e]=t[r],e=r;t[e]=n}function ef(){cf.call(this)}function Y(t,e){this.f=new ef,Ye.call(this,t,e)}function Z(t,e,n,r){this.l=t,this.j=!!r,Y.call(this,e,n)}var g,goog=goog||{},k=this,q="closure_uid_"+(1e9*Math.random()>>>0),fa=0,t=Date.now||function(){return+new Date};u(ka,Error),ka.prototype.name="CustomError",u(la,ka),la.prototype.name="AssertionError";var na=0,pa={};w.prototype.i=!1,w.prototype.$=function(){if(!this.i&&(this.i=!0,this.w(),0!=na)){var t=this[q]||(this[q]=++fa);if(0!=na&&this.m&&0<this.m.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pa[t]}},w.prototype.w=function(){if(this.m)for(;this.m.length;)this.m.shift()()};var qa=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(l(t))return l(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ra=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=l(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},ya=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},x;t:{var Aa=k.navigator;if(Aa){var Ba=Aa.userAgent;if(Ba){x=Ba;break t}}x=""}var Ga="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ia[" "]=aa;var La=y("Opera"),z=y("Trident")||y("MSIE"),Ma=y("Edge"),Na=Ma||z,Oa=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Pa=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Ra;t:{var Sa="",Ta=function(){var t=x;return Oa?/rv:([^\);]+)(\)|;)/.exec(t):Ma?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Pa?/WebKit\/(\S+)/.exec(t):La?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ta&&(Sa=Ta?Ta[1]:""),z){var Ua=Qa();if(null!=Ua&&Ua>parseFloat(Sa)){Ra=String(Ua);break t}}Ra=Sa}var Ka={},Wa,Xa=k.document;Wa=Xa&&z?Qa()||("CSS1Compat"==Xa.compatMode?parseInt(Ra,10):5):void 0;var Ya=Object.freeze||function(t){return t},Za=!z||9<=Number(Wa),$a=z&&!Va("9"),ab=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return k.addEventListener("test",aa,e),k.removeEventListener("test",aa,e),t}();A.prototype.b=function(){this.Ra=!1},u(bb,A);var cb=Ya({2:"touch",3:"pen",4:"mouse"});bb.prototype.b=function(){bb.H.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$a)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var db="closure_listenable_"+(1e6*Math.random()|0),eb=0;hb.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ib(t,e,r,i);return-1<a?(e=t[a],n||(e.ba=!1)):(e=new fb(e,this.src,o,!!r,i),e.ba=n,t.push(e)),e};var kb="closure_lm_"+(1e6*Math.random()|0),lb={},mb=0,zb="__closure_events_fn_"+(1e9*Math.random()>>>0);u(B,w),B.prototype[db]=!0,g=B.prototype,g.addEventListener=function(t,e,n,r){nb(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){vb(this,t,e,n,r)},g.dispatchEvent=function(t){var e,n=this.J;if(n)for(e=[];n;n=n.J)e.push(n);n=this.N;var r=t.type||t;if(l(t))t=new A(t,n);else if(t instanceof A)t.target=t.target||n;else{var i=t;t=new A(r,n),Ha(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ab(a,r,!0,t)&&i}if(a=t.a=n,i=Ab(a,r,!0,t)&&i,i=Ab(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.a=e[o],i=Ab(a,r,!1,t)&&i;return i},g.w=function(){if(B.H.w.call(this),this.f){var t,e=this.f,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,gb(r[i]);delete e.a[t],e.b--}}this.J=null},g.Ia=function(t,e,n,r){return this.f.add(String(t),e,!1,n,r)},g.Ja=function(t,e,n,r){return this.f.add(String(t),e,!0,n,r)};var Hb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ib=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;Jb.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Nb=new Jb(function(){return new Lb},function(t){t.reset()});Kb.prototype.add=function(t,e){var n=Nb.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lb.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lb.prototype.reset=function(){this.next=this.b=this.a=null};var Rb,Tb,Wb=!1,Pb=new Kb;u(Xb,B),g=Xb.prototype,g.ea=!1,g.O=null,g.qb=function(){if(this.ea){var e=t()-this.g;0<e&&e<.8*this.b?this.O=this.a.setTimeout(this.c,this.b-e):(this.O&&(this.a.clearTimeout(this.O),this.O=null),this.dispatchEvent("tick"),this.ea&&(this.O=this.a.setTimeout(this.c,this.b),this.g=t()))}},g.start=function(){this.ea=!0,this.O||(this.O=this.a.setTimeout(this.c,this.b),this.g=t())},g.w=function(){Xb.H.w.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ha=!1,g.Y=null,g.cb=function(t){this.a=arguments,this.Y?this.ha=!0:ac(this)},g.w=function(){$b.H.w.call(this),this.Y&&(k.clearTimeout(this.Y),this.Y=null,this.ha=!1,this.a=[])},g.kb=function(){this.Y=null,this.ha&&(this.ha=!1,ac(this))},u(bc,w);var cc=[];bc.prototype.w=function(){bc.H.w.call(this),ec(this)},bc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fc.prototype.a=null;var gc=0;fc.prototype.reset=function(e,n,r,i,o){"number"==typeof o||gc++,i||t(),delete this.a},C.prototype.toString=function(){return this.name};var ic=new C("SEVERE",1e3),jc=new C("WARNING",900),kc=new C("INFO",800),lc=new C("CONFIG",700),mc=new C("FINE",500);hc.prototype.log=function(t,e,n){if(t.value>=nc(this).value)for(da(e)&&(e=e()),t=new fc(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var oc={},pc=null;sc.prototype.Fa=function(){this.b=!1};var yc=new B;u(zc,A),u(Bc,A),u(Cc,A);var Fc={NO_ERROR:0,rb:1,yb:2,xb:3,ub:4,wb:5,zb:6,Ua:7,TIMEOUT:8,Cb:9},Gc={tb:"complete",Gb:"success",Va:"error",Ua:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",vb:"downloadprogress",Hb:"uploadprogress"};Hc.prototype.a=null;var Lc={OPEN:"a",sb:"b",Va:"c",Bb:"d"};u(Mc,A),u(Nc,A);var Oc;u(Pc,Hc),Oc=new Pc;var Rc=45e3,Tc={},Uc={};g=L.prototype,g.setTimeout=function(t){this.R=t},g.nb=function(t){t=t.target;var e=this.I;e&&3==N(t)?(H(this.b,"Throttling readystatechange."),e.cb()):this.Sa(t)},g.Sa=function(t){try{t==this.a?ad(this):D(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){if(H(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.V()){var e=this;xc(this.b,t,function(){return"ResponseText: "+e.a.V()})}else xc(this.b,t,"No response text")}},g.mb=function(){if(this.a){var t=N(this.a),e=this.a.V();this.G<e.length&&(bd(this),ed(this,t,e),this.f&&4!=t&&Zc(this))}},g.cancel=function(){this.B=!0,gd(this)},g.lb=function(){this.s=null;var e=t();0<=e-this.U?(this.f&&J(this.b,"Received watchdog timeout even though request loaded successfully"),wc(this.b,this.g),2!=this.J&&(Ac(3),K(17)),gd(this),this.m=2,hd(this)):(D(this.b.a,"WatchDog timer called too early"),kd(this,this.U-e))},g=O.prototype,g.A=function(){nd(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},g.M=function(){return nd(this),this.a.concat()},g.get=function(t,e){return P(this.b,t)?this.b[t]:e},g.set=function(t,e){P(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},g.forEach=function(t,e){for(var n=this.M(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var qd=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Q.prototype.toString=function(){var t=[],e=this.f;e&&t.push(zd(e,Ad,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(zd(e,Ad,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(zd(n,"/"==n.charAt(0)?Bd:Cd,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",zd(n,Dd)),t.join("")},Q.prototype.resolve=function(t){var e=M(this),n=!!t.f;n?sd(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?td(e,t.b):n=null!=t.i;var r=t.a;if(n)ud(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?vd(e,wd(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Ad=/[#\/\?@]/g,Cd=/[#\?:]/g,Bd=/[#\?]/g,Fd=/[#\?@]/g,Dd=/#/g;g=yd.prototype,g.add=function(t,e){S(this),this.c=null,t=Kd(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},g.forEach=function(t,e){S(this),this.a.forEach(function(n,r){ra(n,function(n){t.call(e,n,r,this)},this)},this)},g.M=function(){S(this);for(var t=this.a.A(),e=this.a.M(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},g.A=function(t){S(this);var e=[];if(l(t))Md(this,t)&&(e=va(e,this.a.get(Kd(this,t))));else{t=this.a.A();for(var n=0;n<t.length;n++)e=va(e,t[n])}return e},g.set=function(t,e){return S(this),this.c=null,t=Kd(this,t),Md(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},g.get=function(t,e){return t=t?this.A(t):[],0<t.length?String(t[0]):e},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.M(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.A(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Od=null;Nd.prototype.set=function(t){this.a=t},Nd.prototype.reset=function(){this.set(t())},Nd.prototype.get=function(){return this.a},u(Qd,Pd),g=Rd.prototype,g.P=null,g.ca=function(t){return this.a.ca(t)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.La=function(){return!1},g.Oa=function(t,e){if(this.f=t.C,0==this.P){if(H(this.b,"TestConnection: Got data for stage 1"),!this.a.o&&(t=t.a)){var n=id(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&((t=id(t,"X-HTTP-Session-Id"))?this.a.K=t:D(this.b.a,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(e){try{var r=this.a.la.a.parse(e)}catch(t){return xc(this.b,t),void Vd(this.a,this)}this.g=r[0]}else H(this.b,"TestConnection: Null responseText"),Vd(this.a,this)}else 1==this.P&&(this.h?K(6):"11111"==e?(K(5),this.h=!0,(!z||10<=Number(Wa))&&(this.f=200,this.c.cancel(),H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0))):(K(7),this.h=!1))},g.ta=function(){this.f=this.c.C,this.c.f?0==this.P?(this.P=1,H(this.b,"TestConnection: request complete for initial check"),Sd(this)):1==this.P&&(H(this.b,"TestConnection: request complete for stage 2"),this.h?(H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0)):(H(this.b,"Test connection failed; not using streaming"),K(10),Td(this.a,this,!1))):(H(this.b,"TestConnection: request failed, in state "+this.P),0==this.P?K(8):1==this.P&&K(9),Vd(this.a,this))},g.ia=function(){return this.a.ia()},g.qa=function(){return this.a.qa()},Xd.prototype.add=function(t){this.a.set(Yd(t),t)},Xd.prototype.A=function(){return this.a.A()};var ae=10;$d.prototype.cancel=function(){this.c=ge(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ra(this.a.A(),function(t){t.cancel()}),od(this.a.a))},ie.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},ie.prototype.parse=function(t){return k.JSON.parse(t,void 0)},u(T,B);var ne="";T.prototype.b=qc("goog.net.XhrIo");var oe=/^https?$/i,pe=["POST","PUT"];g=T.prototype,g.fa=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.g="",this.j=0,this.K=e,this.G=!1,this.c=!0,this.a=Qc(this.s?this.s:Oc),this.D=Ic(this.s?this.s:Oc),this.a.onreadystatechange=r(this.Na,this);try{E(this.b,U(this,"Opening Xhr")),this.I=!0,this.a.open(e,String(t),!0),this.I=!1}catch(t){return E(this.b,U(this,"Error opening Xhr: "+t.message)),void qe(this,t)}t=n||"";var o=new O(this.headers);i&&md(i,function(t,e){o.set(e,t)}),i=sa(o.M()),n=k.FormData&&t instanceof k.FormData,!(0<=qa(pe,e))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.L&&(this.a.responseType=this.L),"withCredentials"in this.a&&this.a.withCredentials!==this.o&&(this.a.withCredentials=this.o);try{re(this),0<this.l&&(this.v=se(this.a),E(this.b,U(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ka,this)):this.C=Zb(this.Ka,this.l,this)),E(this.b,U(this,"Sending request")),this.u=!0,this.a.send(t),this.u=!1}catch(t){E(this.b,U(this,"Send error: "+t.message)),qe(this,t)}},g.Ka=function(){void 0!==goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,E(this.b,U(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(t){this.a&&this.c&&(E(this.b,U(this,"Aborting")),this.c=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ue(this))},g.w=function(){this.a&&(this.c&&(this.c=!1,this.h=!0,this.a.abort(),this.h=!1),ue(this,!0)),T.H.w.call(this)},g.Na=function(){this.i||(this.I||this.u||this.h?ve(this):this.jb())},g.jb=function(){ve(this)},g.W=function(){try{return 2<N(this)?this.a.status:-1}catch(t){return-1}},g.Ha=function(){try{return 2<N(this)?this.a.statusText:""}catch(t){return E(this.b,"Can not get status: "+t.message),""}},g.V=function(){try{return this.a?this.a.responseText:""}catch(t){return E(this.b,"Can not get responseText: "+t.message),""}},g.eb=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));t:{if(t=e,k.JSON)try{var n=k.JSON.parse(t);break t}catch(t){}n=Cb(t)}return n}},g.Ga=function(){return this.j},g.hb=function(){return l(this.g)?this.g:String(this.g)},g=ye.prototype,g.na=8,g.F=1,g.La=function(){return 0==this.F},g.Qa=function(t){if(this.m=null,H(this.a,"startForwardChannel_"),1==this.F)if(t)J(this.a,"Not supposed to retry the open");else{H(this.a,"open_()"),this.R=Math.floor(1e5*Math.random()),t=this.R++;var e=new L(this,this.a,t,void 0),n=this.i;this.L&&(n?(n=Fa(n),Ha(n,this.L)):n=this.L),null===this.h&&(e.j=n);var r=Ie(this,e),i=M(this.D);R(i,"RID",t),R(i,"CVER",22),this.o&&this.j&&R(i,"X-HTTP-Session-Id",this.j),Be(this,i),this.h&&n&&xe(i,this.h,n),ce(this.c,e),this.va?(R(i,"$req",r),R(i,"SID","null"),e.X=!0,Vc(e,i,null)):Vc(e,i,r),this.F=2}else 3==this.F&&(t?Je(this,t):0==this.g.length?H(this.a,"startForwardChannel_ returned: nothing to send"):de(this.c)?J(this.a,"startForwardChannel_ returned: connection already in progress"):(Je(this),H(this.a,"startForwardChannel_ finished, sent request")))},g.Pa=function(){this.l=null,H(this.a,"Creating new HttpRequest"),this.b=new L(this,this.a,"rpc",this.T),null===this.h&&(this.b.j=this.i),this.b.N=0;var t=M(this.ua);R(t,"RID","rpc"),R(t,"SID",this.J),R(t,"CI",this.ka?"0":"1"),R(t,"AID",this.N),Be(this,t),R(t,"TYPE","xmlhttp"),this.h&&this.i&&xe(t,this.h,this.i),this.G&&this.b.setTimeout(this.G),Yc(this.b,t,!0,this.X),H(this.a,"New Request created")},g.Oa=function(t,e){if(0!=this.F&&(this.b==t||ee(this.c,t)))if(this.u=t.C,!t.v&&ee(this.c,t)&&3==this.F){try{var n=this.la.a.parse(e)}catch(t){n=null}if(p(n)&&3==n.length)if(e=n,0==e[0])t:if(H(this.a,"Server claims our backchannel is missing."),this.l)H(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.D+3e3<t.D))break t;De(this),this.b.cancel(),this.b=null}else D(this.a.a,"We do not have a BackChannel established");Le(this),K(18)}else this.xa=e[1],0<(t=this.xa-this.N)&&(e=e[2],H(this.a,e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),37500>e&&this.ka&&0==this.B&&!this.s&&(this.s=Ec(r(this.ib,this),6e3)));else H(this.a,"Bad POST response data returned"),V(this,11)}else if((t.v||this.b==t)&&De(this),!xa(e))for(e=n=this.la.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.N=i[0],i=i[1],2==this.F)if("c"==i[0]){this.J=i[1],this.X=i[2];var o=i[3];null!=o&&(this.na=o,F(this.a,"VER="+this.na)),o=i[4],null!=o&&(this.ya=o,F(this.a,"SVER="+this.ya)),i=i[5],null!=i&&"number"==typeof i&&0<i&&(this.G=i*=1.5,F(this.a,"backChannelRequestTimeoutMs_="+i)),this.o&&(i=t.a)&&((o=id(i,"X-Client-Wire-Protocol"))&&be(this.c,o),this.j&&((i=id(i,"X-HTTP-Session-Id"))?(this.K=i,R(this.D,this.j,i)):D(this.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.F=3,this.f&&this.f.Da(),i=t,this.ua=Ud(this,this.X,this.ja),i.v?(H(this.a,"Upgrade the handshake request to a backchannel."),fe(this.c,i),(o=this.G)&&i.setTimeout(o),i.s&&(bd(i),Zc(i)),this.b=i):Ke(this)}else"stop"!=i[0]&&"close"!=i[0]||V(this,7);else 3==this.F&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?V(this,7):ze(this):"noop"!=i[0]&&this.f&&this.f.Ca(i),this.B=0)}},g.ib=function(){null!=this.s&&(this.s=null,this.b.cancel(),this.b=null,Le(this),K(19))},g.ta=function(e){H(this.a,"Request complete");var n=null;if(this.b==e){De(this),this.b=null;var r=2}else{if(!ee(this.c,e))return;n=e.u,fe(this.c,e),r=1}if(this.u=e.C,0!=this.F)if(e.f)1==r?(Dc(e.l?e.l.length:0,t()-e.D,this.v),Fe(this)):Ke(this);else{var i=e.m;if(3==i||0==i&&0<this.u)H(this.a,"Not retrying due to error type");else{var o=this;if(H(this.a,function(){return"Maybe retrying, last error: "+Sc(i,o.u)}),1==r&&Ge(this,e)||2==r&&Le(this))return;H(this.a,"Exceeded max number of retries")}switch(n&&0<n.length&&he(this.c,n),H(this.a,"Error: HTTP request failed"),i){case 1:V(this,5);break;case 4:V(this,10);break;case 3:V(this,6);break;default:V(this,2)}}},g.pb=function(t){t?(F(this.a,"Successfully pinged google.com"),K(2)):(F(this.a,"Failed to ping google.com"),K(1))},g.ca=function(t){if(t&&!this.S)throw Error("Can't create secondary domain capable XhrIo object.");return t=new T(this.Ta),t.o=this.S,t},g.qa=function(){return!!this.f&&!0},g.ia=function(){return this.S},new Qd,g=Oe.prototype,g.Da=function(){},g.Ca=function(){},g.Ba=function(){},g.Aa=function(){},g.ab=function(){},Qe.prototype.a=function(t,e){return new W(t,e)},u(W,B),g=W.prototype,g.addEventListener=function(t,e,n,r){W.H.addEventListener.call(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){W.H.removeEventListener.call(this,t,e,n,r)},g.fb=function(){this.a.f=this.h,this.l&&(this.a.S=!0);var t=this.a,e=this.o,n=this.b,r=this.g||void 0;H(t.a,"connect()"),K(0),t.ja=n,t.U=r||{},t.o&&(H(t.a,"connect() bypassed channel-test."),t.I.b=[],t.I.a=!1),H(t.a,"connectTest_()"),t.C=new Rd(t,t.a),null===t.h&&(t.C.i=t.i),n=e,t.h&&t.i&&(n=xe(e,t.h,t.i)),t=t.C,t.m=n,e=Me(t.a,t.m),K(3),n=t.a.I.b,null!=n?(t.g=n[0],t.P=1,Sd(t)):($c(e,"MODE","init"),!t.a.o&&t.a.j&&$c(e,"X-HTTP-Session-Id",t.a.j),t.c=new L(t,t.b,void 0,void 0),t.c.j=t.i,Yc(t.c,e,!1,null),t.P=0)},g.close=function(){ze(this.a)},g.gb=function(t){if(l(t)){var e={};e.__data__=t,Ee(this.a,e)}else this.j?(e={},e.__data__=Db(t),Ee(this.a,e)):Ee(this.a,t)},g.w=function(){this.a.f=null,delete this.h,ze(this.a),delete this.a,W.H.w.call(this)},u(Se,Mc),u(Te,Nc),u(Re,Oe),Re.prototype.Da=function(){rc(this.a.c,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Re.prototype.Ca=function(t){this.a.dispatchEvent(new Se(t))},Re.prototype.Ba=function(t){rc(this.a.c,"WebChannel aborted on "+this.a.b+" due to channel error: "+t),this.a.dispatchEvent(new Te(t))},Re.prototype.Aa=function(){rc(this.a.c,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Ue=ja(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Qe);Ve.prototype.A=function(){for(var t=[],e=this.b.length-1;0<=e;--e)t.push(this.b[e]);var n=this.a.length;for(e=0;e<n;++e)t.push(this.a[e]);return t},u(Ye,w);var Ze="[goog.structs.Pool] Min can not be greater than max";g=Ye.prototype,g.da=function(){var e=t();if(!(null!=this.g&&0>e-this.g)){for(var n;0<Xe(this.a)&&(n=We(this.a),!this.sa(n));)this.aa();return!n&&$e(this)<this.c&&(n=this.pa()),n&&(this.g=e,this.b.add(n)),n}},g.ob=function(t){return!!pd(this.b.a,Yd(t))&&(this.ma(t),!0)},g.ma=function(t){pd(this.b.a,Yd(t)),this.sa(t)&&$e(this)<this.c?this.a.a.push(t):af(t)},g.aa=function(){for(var t=this.a;$e(this)<this.h;){var e=this.pa();t.a.push(e)}for(;$e(this)>this.c&&0<Xe(this.a);)af(We(t))},g.pa=function(){return{}},g.sa=function(t){return"function"!=typeof t.bb||t.bb()},g.w=function(){if(Ye.H.w.call(this),0<this.b.a.c)throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var t=this.a;0!=t.b.length||0!=t.a.length;)af(We(t));delete this.a},cf.prototype.A=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].b);return e},cf.prototype.M=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].a);return e},u(ef,cf),u(Y,Ye),g=Y.prototype,g.da=function(t,e){if(!t)return Y.H.da.call(this);df(this.f,void 0!==e?e:100,t),this.ra()},g.ra=function(){for(var t=this.f;0<t.a.length;){var e=this.da();if(!e)break;var n=t,r=n.a,i=r.length,o=r[0];if(0>=i)o=void 0;else{if(1==i)ua(r);else{r[0]=r.pop(),r=0,n=n.a,i=n.length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(s=u<i&&n[u].a<n[s].a?u:s,n[s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[e])}},g.ma=function(t){Y.H.ma.call(this,t),this.ra()},g.aa=function(){Y.H.aa.call(this),this.ra()},g.w=function(){Y.H.w.call(this),k.clearTimeout(void 0),ua(this.f.a),this.f=null},u(Z,Y),Z.prototype.pa=function(){var t=new T,e=this.l;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.j&&(t.o=!0),t},Z.prototype.sa=function(t){return!t.i&&!t.a},Qe.prototype.createWebChannel=Qe.prototype.a,W.prototype.send=W.prototype.gb,W.prototype.open=W.prototype.fb,W.prototype.close=W.prototype.close,Fc.NO_ERROR=0,Fc.TIMEOUT=8,Fc.HTTP_ERROR=6,Gc.COMPLETE="complete",Kc.EventType=Lc,Lc.OPEN="a",Lc.CLOSE="b",Lc.ERROR="c",Lc.MESSAGE="d",B.prototype.listen=B.prototype.Ia,Z.prototype.getObject=Z.prototype.da,Z.prototype.releaseObject=Z.prototype.ob,T.prototype.listenOnce=T.prototype.Ja,T.prototype.getLastError=T.prototype.hb,T.prototype.getLastErrorCode=T.prototype.Ga,T.prototype.getStatus=T.prototype.W,T.prototype.getStatusText=T.prototype.Ha,T.prototype.getResponseJson=T.prototype.eb,T.prototype.getResponseText=T.prototype.V,T.prototype.getResponseText=T.prototype.V,T.prototype.send=T.prototype.fa,module.exports={createWebChannelTransport:Ue,ErrorCode:Fc,EventType:Gc,WebChannel:Kc,XhrIoPool:Z}}).call(void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(exports,__webpack_require__(1))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={apiKey:"AIzaSyDVSzEVPSt_q5iQJ6t0G4vStZFmfyTAWp4",authDomain:"dentsudemo-9ce77.firebaseapp.com",databaseURL:"https://dentsudemo-9ce77.firebaseio.com",projectId:"dentsudemo-9ce77",storageBucket:"dentsudemo-9ce77.appspot.com",messagingSenderId:"824781445648"};e.default=r},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){}]);